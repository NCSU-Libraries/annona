(function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s="5a74")})({"044b":function(e,t){function i(e){return!!e.constructor&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function n(e){return"function"===typeof e.readFloatLE&&"function"===typeof e.slice&&i(e.slice(0,0))}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(i(e)||n(e)||!!e._isBuffer)}},"0a06":function(e,t,i){"use strict";var n=i("2444"),o=i("c532"),r=i("f6b4"),s=i("5270");function a(e){this.defaults=e,this.interceptors={request:new r,response:new r}}a.prototype.request=function(e){"string"===typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),e=o.merge(n,{method:"get"},this.defaults,e),e.method=e.method.toLowerCase();var t=[s,void 0],i=Promise.resolve(e);this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});while(t.length)i=i.then(t.shift(),t.shift());return i},o.forEach(["delete","get","head","options"],function(e){a.prototype[e]=function(t,i){return this.request(o.merge(i||{},{method:e,url:t}))}}),o.forEach(["post","put","patch"],function(e){a.prototype[e]=function(t,i,n){return this.request(o.merge(n||{},{method:e,url:t,data:i}))}}),e.exports=a},"0df6":function(e,t,i){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},"0e29":function(e,t,i){"use strict";i.r(t);var n=i("3967"),o=i.n(n);for(var r in n)"default"!==r&&function(e){i.d(t,e,function(){return n[e]})}(r);t["default"]=o.a},"1d2b":function(e,t,i){"use strict";e.exports=function(e,t){return function(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];return e.apply(t,i)}}},2350:function(e,t){function i(e,t){var i=e[1]||"",o=e[3];if(!o)return i;if(t&&"function"===typeof btoa){var r=n(o),s=o.sources.map(function(e){return"/*# sourceURL="+o.sourceRoot+e+" */"});return[i].concat(s).concat([r]).join("\n")}return[i].join("\n")}function n(e){var t=btoa(unescape(encodeURIComponent(JSON.stringify(e)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,"+t;return"/*# "+i+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=i(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,i){"string"===typeof e&&(e=[[null,e,""]]);for(var n={},o=0;o<this.length;o++){var r=this[o][0];"number"===typeof r&&(n[r]=!0)}for(o=0;o<e.length;o++){var s=e[o];"number"===typeof s[0]&&n[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),t.push(s))}},t}},2444:function(e,t,i){"use strict";(function(t){var n=i("c532"),o=i("c8af"),r={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function a(){var e;return"undefined"!==typeof XMLHttpRequest?e=i("b50d"):"undefined"!==typeof t&&(e=i("b50d")),e}var l={adapter:a(),transformRequest:[function(e,t){return o(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(s(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"===typeof e)try{e=JSON.parse(e)}catch(t){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],function(e){l.headers[e]={}}),n.forEach(["post","put","patch"],function(e){l.headers[e]=n.merge(r)}),e.exports=l}).call(this,i("4362"))},"289e":function(e,t){
/*! (C) Andrea Giammarchi - @WebReflection - ISC Style License */
!function(e,t){"use strict";function i(){var e=C.splice(0,C.length);for(Ye=0;e.length;)e.shift().call(null,e.shift())}function n(e,t){for(var i=0,n=e.length;i<n;i++)f(e[i],t)}function o(e){for(var t,i=0,n=e.length;i<n;i++)t=e[i],H(t,re[s(t)])}function r(e){return function(t){Ae(t)&&(f(t,e),se.length&&n(t.querySelectorAll(se),e))}}function s(e){var t=Ve.call(e,"is"),i=e.nodeName.toUpperCase(),n=le.call(oe,t?te+t.toUpperCase():ee+i);return t&&-1<n&&!a(i,t)?-1:n}function a(e,t){return-1<se.indexOf(e+'[is="'+t+'"]')}function l(e){var t=e.currentTarget,i=e.attrChange,n=e.attrName,o=e.target,r=e[X]||2,s=e[K]||3;!nt||o&&o!==t||!t[U]||"style"===n||e.prevValue===e.newValue&&(""!==e.newValue||i!==r&&i!==s)||t[U](n,i===r?null:e.prevValue,i===s?null:e.newValue)}function c(e){var t=r(e);return function(e){C.push(t,e.target),Ye&&clearTimeout(Ye),Ye=setTimeout(i,1)}}function h(e){it&&(it=!1,e.currentTarget.removeEventListener(J,h)),se.length&&n((e.target||_).querySelectorAll(se),e.detail===j?j:N),De&&m()}function u(e,t){var i=this;$e.call(i,e,t),R.call(i,{target:i})}function d(e,t,i){var n=t.apply(e,i),r=s(n);return-1<r&&H(n,re[r]),i.pop()&&se.length&&o(n.querySelectorAll(se)),n}function p(e,t){Me(e,t),M?M.observe(e,Xe):(tt&&(e.setAttribute=u,e[A]=k(e),e[z](Q,R)),e[z](Y,l)),e[G]&&nt&&(e.created=!0,e[G](),e.created=!1)}function m(){for(var e,t=0,i=ze.length;t<i;t++)e=ze[t],ae.contains(e)||(i--,ze.splice(t--,1),f(e,j))}function g(e){throw new Error("A "+e+" type is already registered")}function f(e,t){var i,n,o=s(e);-1<o&&(L(e,re[o]),o=0,t!==N||e[N]?t!==j||e[j]||(e[N]=!1,e[j]=!0,n="disconnected",o=1):(e[j]=!1,e[N]=!0,n="connected",o=1,De&&le.call(ze,e)<0&&ze.push(e)),o&&(i=e[t+F]||e[n+F])&&i.call(e))}function v(){}function y(e,t,i){var n=i&&i[V]||"",o=t.prototype,r=ke(o),s=t.observedAttributes||pe,a={prototype:r};Be(r,G,{value:function(){if(be)be=!1;else if(!this[we]){this[we]=!0,new t(this),o[G]&&o[G].call(this);var e=Pe[Re.get(t)];(!xe||e.create.length>1)&&x(this)}}}),Be(r,U,{value:function(e){-1<le.call(s,e)&&o[U]&&o[U].apply(this,arguments)}}),o[$]&&Be(r,W,{value:o[$]}),o[q]&&Be(r,Z,{value:o[q]}),n&&(a[V]=n),e=e.toUpperCase(),Pe[e]={constructor:t,create:n?[n,Oe(e)]:[e]},Re.set(t,e),_[B](e.toLowerCase(),a),S(e),Ce[e].r()}function w(e){var t=Pe[e.toUpperCase()];return t&&t.constructor}function T(e){return"string"==typeof e?e:e&&e.is||""}function x(e){for(var t,i=e[U],n=i?e.attributes:pe,o=n.length;o--;)t=n[o],i.call(e,t.name||t.nodeName,null,t.value||t.nodeValue)}function S(e){return e=e.toUpperCase(),e in Ce||(Ce[e]={},Ce[e].p=new _e(function(t){Ce[e].r=t})),Ce[e].p}function E(){Te&&delete e.customElements,de(e,"customElements",{configurable:!0,value:new v}),de(e,"CustomElementRegistry",{configurable:!0,value:v});for(var t=P.get(/^HTML[A-Z]*[a-z]/),i=t.length;i--;function(t){var i=e[t];if(i){e[t]=function(e){var t,n;return e||(e=this),e[we]||(be=!0,t=Pe[Re.get(e.constructor)],n=xe&&1===t.create.length,e=n?Reflect.construct(i,pe,t.constructor):_.createElement.apply(_,t.create),e[we]=!0,be=!1,n||x(e)),e},e[t].prototype=i.prototype;try{i.prototype.constructor=e[t]}catch(n){!0,de(i,we,{value:e[t]})}}}(t[i]));_.createElement=function(e,t){var i=T(t);return i?Ze.call(this,e,Oe(i)):Ze.call(this,e)},Je||(et=!0,_[B](""))}var _=e.document,b=e.Object,P=function(e){var t,i,n,o,r=/^[A-Z]+[a-z]/,s=function(e){var t,i=[];for(t in l)e.test(t)&&i.push(t);return i},a=function(e,t){(t=t.toLowerCase())in l||(l[e]=(l[e]||[]).concat(t),l[t]=l[t.toUpperCase()]=e)},l=(b.create||b)(null),c={};for(i in e)for(o in e[i])for(n=e[i][o],l[o]=n,t=0;t<n.length;t++)l[n[t].toLowerCase()]=l[n[t].toUpperCase()]=o;return c.get=function(e){return"string"==typeof e?l[e]||(r.test(e)?[]:""):s(e)},c.set=function(e,t){return r.test(e)?a(e,t):a(t,e),c},c}({collections:{HTMLAllCollection:["all"],HTMLCollection:["forms"],HTMLFormControlsCollection:["elements"],HTMLOptionsCollection:["options"]},elements:{Element:["element"],HTMLAnchorElement:["a"],HTMLAppletElement:["applet"],HTMLAreaElement:["area"],HTMLAttachmentElement:["attachment"],HTMLAudioElement:["audio"],HTMLBRElement:["br"],HTMLBaseElement:["base"],HTMLBodyElement:["body"],HTMLButtonElement:["button"],HTMLCanvasElement:["canvas"],HTMLContentElement:["content"],HTMLDListElement:["dl"],HTMLDataElement:["data"],HTMLDataListElement:["datalist"],HTMLDetailsElement:["details"],HTMLDialogElement:["dialog"],HTMLDirectoryElement:["dir"],HTMLDivElement:["div"],HTMLDocument:["document"],HTMLElement:["element","abbr","address","article","aside","b","bdi","bdo","cite","code","command","dd","dfn","dt","em","figcaption","figure","footer","header","i","kbd","mark","nav","noscript","rp","rt","ruby","s","samp","section","small","strong","sub","summary","sup","u","var","wbr"],HTMLEmbedElement:["embed"],HTMLFieldSetElement:["fieldset"],HTMLFontElement:["font"],HTMLFormElement:["form"],HTMLFrameElement:["frame"],HTMLFrameSetElement:["frameset"],HTMLHRElement:["hr"],HTMLHeadElement:["head"],HTMLHeadingElement:["h1","h2","h3","h4","h5","h6"],HTMLHtmlElement:["html"],HTMLIFrameElement:["iframe"],HTMLImageElement:["img"],HTMLInputElement:["input"],HTMLKeygenElement:["keygen"],HTMLLIElement:["li"],HTMLLabelElement:["label"],HTMLLegendElement:["legend"],HTMLLinkElement:["link"],HTMLMapElement:["map"],HTMLMarqueeElement:["marquee"],HTMLMediaElement:["media"],HTMLMenuElement:["menu"],HTMLMenuItemElement:["menuitem"],HTMLMetaElement:["meta"],HTMLMeterElement:["meter"],HTMLModElement:["del","ins"],HTMLOListElement:["ol"],HTMLObjectElement:["object"],HTMLOptGroupElement:["optgroup"],HTMLOptionElement:["option"],HTMLOutputElement:["output"],HTMLParagraphElement:["p"],HTMLParamElement:["param"],HTMLPictureElement:["picture"],HTMLPreElement:["pre"],HTMLProgressElement:["progress"],HTMLQuoteElement:["blockquote","q","quote"],HTMLScriptElement:["script"],HTMLSelectElement:["select"],HTMLShadowElement:["shadow"],HTMLSlotElement:["slot"],HTMLSourceElement:["source"],HTMLSpanElement:["span"],HTMLStyleElement:["style"],HTMLTableCaptionElement:["caption"],HTMLTableCellElement:["td","th"],HTMLTableColElement:["col","colgroup"],HTMLTableElement:["table"],HTMLTableRowElement:["tr"],HTMLTableSectionElement:["thead","tbody","tfoot"],HTMLTemplateElement:["template"],HTMLTextAreaElement:["textarea"],HTMLTimeElement:["time"],HTMLTitleElement:["title"],HTMLTrackElement:["track"],HTMLUListElement:["ul"],HTMLUnknownElement:["unknown","vhgroupv","vkeygen"],HTMLVideoElement:["video"]},nodes:{Attr:["node"],Audio:["audio"],CDATASection:["node"],CharacterData:["node"],Comment:["#comment"],Document:["#document"],DocumentFragment:["#document-fragment"],DocumentType:["node"],HTMLDocument:["#document"],Image:["img"],Option:["option"],ProcessingInstruction:["node"],ShadowRoot:["#shadow-root"],Text:["#text"],XMLDocument:["xml"]}});"object"!=typeof t&&(t={type:t||"auto"});var C,R,O,k,M,I,L,H,D,B="registerElement",A="__"+B+(1e5*e.Math.random()>>0),z="addEventListener",N="attached",F="Callback",j="detached",V="extends",U="attributeChanged"+F,W=N+F,$="connected"+F,q="disconnected"+F,G="created"+F,Z=j+F,X="ADDITION",K="REMOVAL",Y="DOMAttrModified",J="DOMContentLoaded",Q="DOMSubtreeModified",ee="<",te="=",ie=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,ne=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],oe=[],re=[],se="",ae=_.documentElement,le=oe.indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},ce=b.prototype,he=ce.hasOwnProperty,ue=ce.isPrototypeOf,de=b.defineProperty,pe=[],me=b.getOwnPropertyDescriptor,ge=b.getOwnPropertyNames,fe=b.getPrototypeOf,ve=b.setPrototypeOf,ye=!!b.__proto__,we="__dreCEv1",Te=e.customElements,xe=!/^force/.test(t.type)&&!!(Te&&Te.define&&Te.get&&Te.whenDefined),Se=b.create||b,Ee=e.Map||function(){var e,t=[],i=[];return{get:function(e){return i[le.call(t,e)]},set:function(n,o){e=le.call(t,n),e<0?i[t.push(n)-1]=o:i[e]=o}}},_e=e.Promise||function(e){function t(e){for(n=!0;i.length;)i.shift()(e)}var i=[],n=!1,o={catch:function(){return o},then:function(e){return i.push(e),n&&setTimeout(t,1),o}};return e(t),o},be=!1,Pe=Se(null),Ce=Se(null),Re=new Ee,Oe=function(e){return e.toLowerCase()},ke=b.create||function e(t){return t?(e.prototype=t,new e):this},Me=ve||(ye?function(e,t){return e.__proto__=t,e}:ge&&me?function(){function e(e,t){for(var i,n=ge(t),o=0,r=n.length;o<r;o++)i=n[o],he.call(e,i)||de(e,i,me(t,i))}return function(t,i){do{e(t,i)}while((i=fe(i))&&!ue.call(i,t));return t}}():function(e,t){for(var i in t)e[i]=t[i];return e}),Ie=e.MutationObserver||e.WebKitMutationObserver,Le=e.HTMLAnchorElement,He=(e.HTMLElement||e.Element||e.Node).prototype,De=!ue.call(He,ae),Be=De?function(e,t,i){return e[t]=i.value,e}:de,Ae=De?function(e){return 1===e.nodeType}:function(e){return ue.call(He,e)},ze=De&&[],Ne=He.attachShadow,Fe=He.cloneNode,je=He.dispatchEvent,Ve=He.getAttribute,Ue=He.hasAttribute,We=He.removeAttribute,$e=He.setAttribute,qe=_.createElement,Ge=_.importNode,Ze=qe,Xe=Ie&&{attributes:!0,characterData:!0,attributeOldValue:!0},Ke=Ie||function(e){tt=!1,ae.removeEventListener(Y,Ke)},Ye=0,Je=B in _&&!/^force-all/.test(t.type),Qe=!0,et=!1,tt=!0,it=!0,nt=!0;if(Ie&&(D=_.createElement("div"),D.innerHTML="<div><div></div></div>",new Ie(function(e,t){if(e[0]&&"childList"==e[0].type&&!e[0].removedNodes[0].childNodes.length){D=me(He,"innerHTML");var i=D&&D.set;i&&de(He,"innerHTML",{set:function(e){for(;this.lastChild;)this.removeChild(this.lastChild);i.call(this,e)}})}t.disconnect(),D=null}).observe(D,{childList:!0,subtree:!0}),D.innerHTML=""),Je||(ve||ye?(L=function(e,t){ue.call(t,e)||p(e,t)},H=p):(L=function(e,t){e[A]||(e[A]=b(!0),p(e,t))},H=L),De?(tt=!1,function(){var e=me(He,z),t=e.value,i=function(e){var t=new CustomEvent(Y,{bubbles:!0});t.attrName=e,t.prevValue=Ve.call(this,e),t.newValue=null,t[K]=t.attrChange=2,We.call(this,e),je.call(this,t)},n=function(e,t){var i=Ue.call(this,e),n=i&&Ve.call(this,e),o=new CustomEvent(Y,{bubbles:!0});$e.call(this,e,t),o.attrName=e,o.prevValue=i?n:null,o.newValue=t,i?o.MODIFICATION=o.attrChange=1:o[X]=o.attrChange=0,je.call(this,o)},o=function(e){var t,i=e.currentTarget,n=i[A],o=e.propertyName;n.hasOwnProperty(o)&&(n=n[o],t=new CustomEvent(Y,{bubbles:!0}),t.attrName=n.name,t.prevValue=n.value||null,t.newValue=n.value=i[o]||null,null==t.prevValue?t[X]=t.attrChange=0:t.MODIFICATION=t.attrChange=1,je.call(i,t))};e.value=function(e,r,s){e===Y&&this[U]&&this.setAttribute!==n&&(this[A]={className:{name:"class",value:this.className}},this.setAttribute=n,this.removeAttribute=i,t.call(this,"propertychange",o)),t.call(this,e,r,s)},de(He,z,e)}()):Ie||(ae[z](Y,Ke),ae.setAttribute(A,1),ae.removeAttribute(A),tt&&(R=function(e){var t,i,n,o=this;if(o===e.target){for(n in t=o[A],o[A]=i=k(o),i){if(!(n in t))return O(0,o,n,t[n],i[n],X);if(i[n]!==t[n])return O(1,o,n,t[n],i[n],"MODIFICATION")}for(n in t)if(!(n in i))return O(2,o,n,t[n],i[n],K)}},O=function(e,t,i,n,o,r){var s={attrChange:e,currentTarget:t,attrName:i,prevValue:n,newValue:o};s[r]=e,l(s)},k=function(e){for(var t,i,n={},o=e.attributes,r=0,s=o.length;r<s;r++)t=o[r],"setAttribute"!==(i=t.name)&&(n[i]=t.value);return n})),_[B]=function(e,t){if(i=e.toUpperCase(),Qe&&(Qe=!1,Ie?(M=function(e,t){function i(e,t){for(var i=0,n=e.length;i<n;t(e[i++]));}return new Ie(function(n){for(var o,r,s,a=0,l=n.length;a<l;a++)o=n[a],"childList"===o.type?(i(o.addedNodes,e),i(o.removedNodes,t)):(r=o.target,nt&&r[U]&&"style"!==o.attributeName&&(s=Ve.call(r,o.attributeName))!==o.oldValue&&r[U](o.attributeName,o.oldValue,s))})}(r(N),r(j)),I=function(e){return M.observe(e,{childList:!0,subtree:!0}),e},I(_),Ne&&(He.attachShadow=function(){return I(Ne.apply(this,arguments))})):(C=[],_[z]("DOMNodeInserted",c(N)),_[z]("DOMNodeRemoved",c(j))),_[z](J,h),_[z]("readystatechange",h),_.importNode=function(e,t){switch(e.nodeType){case 1:return d(_,Ge,[e,!!t]);case 11:for(var i=_.createDocumentFragment(),n=e.childNodes,o=n.length,r=0;r<o;r++)i.appendChild(_.importNode(n[r],!!t));return i;default:return Fe.call(e,!!t)}},He.cloneNode=function(e){return d(this,Fe,[!!e])}),et)return et=!1;if(-2<le.call(oe,te+i)+le.call(oe,ee+i)&&g(e),!ie.test(i)||-1<le.call(ne,i))throw new Error("The type "+e+" is invalid");var i,o,s=function(){return l?_.createElement(u,i):_.createElement(u)},a=t||ce,l=he.call(a,V),u=l?t[V].toUpperCase():i;return l&&-1<le.call(oe,ee+u)&&g(u),o=oe.push((l?te:ee)+i)-1,se=se.concat(se.length?",":"",l?u+'[is="'+e.toLowerCase()+'"]':u),s.prototype=re[o]=he.call(a,"prototype")?a.prototype:ke(He),se.length&&n(_.querySelectorAll(se),N),s},_.createElement=Ze=function(e,t){var i=T(t),n=i?qe.call(_,e,Oe(i)):qe.call(_,e),o=""+e,r=le.call(oe,(i?te:ee)+(i||o).toUpperCase()),s=-1<r;return i&&(n.setAttribute("is",i=i.toLowerCase()),s&&(s=a(o.toUpperCase(),i))),nt=!_.createElement.innerHTMLHelper,s&&H(n,re[r]),n}),v.prototype={constructor:v,define:xe?function(e,t,i){if(i)y(e,t,i);else{var n=e.toUpperCase();Pe[n]={constructor:t,create:[n]},Re.set(t,n),Te.define(e,t)}}:y,get:xe?function(e){return Te.get(e)||w(e)}:w,whenDefined:xe?function(e){return _e.race([Te.whenDefined(e),S(e)])}:S},!Te||/^force/.test(t.type))E();else if(!t.noBuiltIn)try{!function(t,i,n){var o=new RegExp("^<a\\s+is=('|\")"+n+"\\1></a>$");if(i[V]="a",t.prototype=ke(Le.prototype),t.prototype.constructor=t,e.customElements.define(n,t,i),!o.test(_.createElement("a",{is:n}).outerHTML)||!o.test((new t).outerHTML))throw i}(function e(){return Reflect.construct(Le,[],e)},{},"document-register-element-a")}catch(ot){E()}if(!t.noBuiltIn)try{if(qe.call(_,"a","a").outerHTML.indexOf("is")<0)throw{}}catch(rt){Oe=function(e){return{is:e.toLowerCase()}}}}(window)},"2d83":function(e,t,i){"use strict";var n=i("387f");e.exports=function(e,t,i,o,r){var s=new Error(e);return n(s,t,i,o,r)}},"2e67":function(e,t,i){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},"30b5":function(e,t,i){"use strict";var n=i("c532");function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,i){if(!t)return e;var r;if(i)r=i(t);else if(n.isURLSearchParams(t))r=t.toString();else{var s=[];n.forEach(t,function(e,t){null!==e&&"undefined"!==typeof e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),s.push(o(t)+"="+o(e))}))}),r=s.join("&")}return r&&(e+=(-1===e.indexOf("?")?"?":"&")+r),e}},"35d6":function(e,t,i){"use strict";function n(e,t){for(var i=[],n={},o=0;o<t.length;o++){var r=t[o],s=r[0],a=r[1],l=r[2],c=r[3],h={id:e+":"+o,css:a,media:l,sourceMap:c};n[s]?n[s].parts.push(h):i.push(n[s]={id:s,parts:[h]})}return i}function o(e,t,i){var o=n(e,t);r(o,i)}function r(e,t){const i=t._injectedStyles||(t._injectedStyles={});for(var n=0;n<e.length;n++){var o=e[n],r=i[o.id];if(!r){for(var s=0;s<o.parts.length;s++)a(o.parts[s],t);i[o.id]=!0}}}function s(e){var t=document.createElement("style");return t.type="text/css",e.appendChild(t),t}function a(e,t){var i=s(t),n=e.css,o=e.media,r=e.sourceMap;if(o&&i.setAttribute("media",o),r&&(n+="\n/*# sourceURL="+r.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),i.styleSheet)i.styleSheet.cssText=n;else{while(i.firstChild)i.removeChild(i.firstChild);i.appendChild(document.createTextNode(n))}}i.r(t),i.d(t,"default",function(){return o})},"387f":function(e,t,i){"use strict";e.exports=function(e,t,i,n,o){return e.config=t,i&&(e.code=i),e.request=n,e.response=o,e}},3934:function(e,t,i){"use strict";var n=i("c532");e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");function o(e){var n=e;return t&&(i.setAttribute("href",n),n=i.href),i.setAttribute("href",n),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}return e=o(window.location.href),function(t){var i=n.isString(t)?o(t):t;return i.protocol===e.protocol&&i.host===e.host}}():function(){return function(){return!0}}()},3967:function(e,t,i){var n=i("d3a9");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var o=i("35d6").default;e.exports.__inject__=function(e){o("2d39efe1",n,e)}},4362:function(e,t,i){t.nextTick=function(e){setTimeout(e,0)},t.platform=t.arch=t.execPath=t.title="browser",t.pid=1,t.browser=!0,t.env={},t.argv=[],t.binding=function(e){throw new Error("No such module. (Possibly not yet loaded)")},function(){var e,n="/";t.cwd=function(){return n},t.chdir=function(t){e||(e=i("df7c")),n=e.resolve(t,n)}}(),t.exit=t.kill=t.umask=t.dlopen=t.uptime=t.memoryUsage=t.uvCounters=function(){},t.features={}},"467f":function(e,t,i){"use strict";var n=i("2d83");e.exports=function(e,t,i){var o=i.config.validateStatus;i.status&&o&&!o(i.status)?t(n("Request failed with status code "+i.status,i.config,null,i.request,i)):e(i)}},5270:function(e,t,i){"use strict";var n=i("c532"),o=i("c401"),r=i("2e67"),s=i("2444"),a=i("d925"),l=i("e683");function c(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){c(e),e.baseURL&&!a(e.url)&&(e.url=l(e.baseURL,e.url)),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]});var t=e.adapter||s.adapter;return t(e).then(function(t){return c(e),t.data=o(t.data,t.headers,e.transformResponse),t},function(t){return r(t)||(c(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},"5a74":function(e,t,i){"use strict";var n;(i.r(t),"undefined"!==typeof window)&&((n=window.document.currentScript)&&(n=n.src.match(/(.+\/)[^\/]+\.js(\?.*)?$/))&&(i.p=n[1]));var o=i("8bbf"),r=i.n(o);const s=/-(\w)/g,a=e=>{return e.replace(s,(e,t)=>t?t.toUpperCase():"")},l=/\B([A-Z])/g,c=e=>{return e.replace(l,"-$1").toLowerCase()};function h(e){const t={};return e.forEach(e=>{t[e]=void 0}),t}function u(e,t,i){e[t]=[].concat(e[t]||[]),e[t].unshift(i)}function d(e,t){if(e){const i=e.$options[t]||[];i.forEach(t=>{t.call(e)})}}function p(e,t){return new CustomEvent(e,{bubbles:!1,cancelable:!1,detail:t})}const m=e=>/function Boolean/.test(String(e)),g=e=>/function Number/.test(String(e));function f(e,t,{type:i}={}){if(m(i))return"true"===e||"false"===e?"true"===e:""===e||e===t||null!=e;if(g(i)){const t=parseFloat(e,10);return isNaN(t)?e:t}return e}function v(e,t){const i=[];for(let n=0,o=t.length;n<o;n++)i.push(y(e,t[n]));return i}function y(e,t){if(3===t.nodeType)return t.data.trim()?t.data:null;if(1===t.nodeType){const i={attrs:w(t),domProps:{innerHTML:t.innerHTML}};return i.attrs.slot&&(i.slot=i.attrs.slot,delete i.attrs.slot),e(t.tagName,i)}return null}function w(e){const t={};for(let i=0,n=e.attributes.length;i<n;i++){const n=e.attributes[i];t[n.nodeName]=n.nodeValue}return t}function T(e,t){const i="function"===typeof t&&!t.cid;let n,o,r,s=!1;function l(e){if(s)return;const t="function"===typeof e?e.options:e,i=Array.isArray(t.props)?t.props:Object.keys(t.props||{});n=i.map(c),o=i.map(a);const l=Array.isArray(t.props)?{}:t.props||{};r=o.reduce((e,t,n)=>{return e[t]=l[i[n]],e},{}),u(t,"beforeCreate",function(){const e=this.$emit;this.$emit=((t,...i)=>{return this.$root.$options.customElement.dispatchEvent(p(t,i)),e.call(this,t,...i)})}),u(t,"created",function(){o.forEach(e=>{this.$root.props[e]=this[e]})}),o.forEach(e=>{Object.defineProperty(g.prototype,e,{get(){return this._wrapper.props[e]},set(t){this._wrapper.props[e]=t},enumerable:!1,configurable:!0})}),s=!0}function m(e,t){const i=a(t),n=e.hasAttribute(t)?e.getAttribute(t):void 0;e._wrapper.props[i]=f(n,t,r[i])}class g extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"});const i=this._wrapper=new e({name:"shadow-root",customElement:this,shadowRoot:this.shadowRoot,data(){return{props:{},slotChildren:[]}},render(e){return e(t,{ref:"inner",props:this.props},this.slotChildren)}}),n=new MutationObserver(e=>{let t=!1;for(let i=0;i<e.length;i++){const n=e[i];s&&"attributes"===n.type&&n.target===this?m(this,n.attributeName):t=!0}t&&(i.slotChildren=Object.freeze(v(i.$createElement,this.childNodes)))});n.observe(this,{childList:!0,subtree:!0,characterData:!0,attributes:!0})}get vueComponent(){return this._wrapper.$refs.inner}connectedCallback(){const e=this._wrapper;if(e._isMounted)d(this.vueComponent,"activated");else{const i=()=>{e.props=h(o),n.forEach(e=>{m(this,e)})};s?i():t().then(e=>{(e.__esModule||"Module"===e[Symbol.toStringTag])&&(e=e.default),l(e),i()}),e.slotChildren=Object.freeze(v(e.$createElement,this.childNodes)),e.$mount(),this.shadowRoot.appendChild(e.$el)}}disconnectedCallback(){d(this.vueComponent,"deactivated")}}return i||l(t),g}var x=T;i("2350"),i("35d6");function S(e,t,i,n,o,r,s,a){var l,c="function"===typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=i,c._compiled=!0),n&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),s?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},c._ssrRegister=l):o&&(l=a?function(){o.call(this,this.$root.$options.shadowRoot)}:o),l)if(c.functional){c._injectStyles=l;var h=c.render;c.render=function(e,t){return l.call(t),h(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:e,options:c}}
/**
  * vue-custom-element v3.2.6
  * (c) 2018 Karol Fabja≈Ñczuk
  * @license MIT
  */function E(e,t){return e.__proto__=t,e}Object.setPrototypeOf=Object.setPrototypeOf||E;E.bind(Object);function _(){return"undefined"!==typeof Symbol&&"undefined"!==typeof Reflect&&"undefined"!==typeof Proxy&&!Object.isSealed(Proxy)}var b=_(),P=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function O(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function k(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("undefined"!==typeof customElements){if(b){var i=function(e){function i(e){var t;C(this,i);var n=R(this,(i.__proto__||Object.getPrototypeOf(i)).call(this)),r=e?HTMLElement.call(e):n;return o.call(r),t=r,R(n,t)}return O(i,e),P(i,null,[{key:"observedAttributes",get:function(){return t.observedAttributes||[]}}]),i}(k);return i.prototype.connectedCallback=r,i.prototype.disconnectedCallback=s,i.prototype.attributeChangedCallback=a,l(e,i),i}var n=function(e){var t=e?HTMLElement.call(e):this;return o.call(t),t};return n.observedAttributes=t.observedAttributes||[],n.prototype=Object.create(HTMLElement.prototype,{constructor:{configurable:!0,writable:!0,value:n}}),n.prototype.connectedCallback=r,n.prototype.disconnectedCallback=s,n.prototype.attributeChangedCallback=a,l(e,n),n}function o(){!0===t.shadow&&HTMLElement.prototype.attachShadow&&this.attachShadow({mode:"open"}),"function"===typeof t.constructorCallback&&t.constructorCallback.call(this)}function r(){"function"===typeof t.connectedCallback&&t.connectedCallback.call(this)}function s(){"function"===typeof t.disconnectedCallback&&t.disconnectedCallback.call(this)}function a(e,i,n){"function"===typeof t.attributeChangedCallback&&t.attributeChangedCallback.call(this,e,i,n)}function l(e,t){var i=customElements.get(e);return"undefined"!==typeof i?i:customElements.define(e,t)}}Object.setPrototypeOf(k.prototype,HTMLElement.prototype),Object.setPrototypeOf(k,HTMLElement);var I=/-(\w)/g,L=function(e){return e.replace(I,function(e,t){return t?t.toUpperCase():""})},H=/([^-])([A-Z])/g,D=function(e){return e.replace(H,"$1-$2").replace(H,"$1-$2").toLowerCase()};function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e.length-t,n=new Array(i);while(i--)n[i]=e[i+t];return n}var A="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function z(e,t){var i=e,n=["true","false"].indexOf(e)>-1,o=parseFloat(i,10),r=!isNaN(o)&&isFinite(i)&&"string"===typeof i&&!i.match(/^0+[^.]\d*$/g);return t&&t!==Boolean&&("undefined"===typeof i?"undefined":A(i))!==t?i=t(e):n||t===Boolean?i=""===i||"true"===i:r&&(i=o),i}function N(e,t){if(e&&e.length)e.forEach(function(e){var i=L(e);-1===t.camelCase.indexOf(i)&&t.camelCase.push(i)});else if(e&&"object"===("undefined"===typeof e?"undefined":A(e)))for(var i in e){var n=L(i);-1===t.camelCase.indexOf(n)&&t.camelCase.push(n),e[n]&&e[n].type&&(t.types[i]=[].concat(e[n].type)[0])}}function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={camelCase:[],hyphenate:[],types:{}};if(e.mixins&&e.mixins.forEach(function(e){N(e.props,t)}),e.extends&&e.extends.props){var i=e.extends.props;N(i,t)}return N(e.props,t),t.camelCase.forEach(function(e){t.hyphenate.push(D(e))}),t}function j(e,t){t.camelCase.forEach(function(i,n){Object.defineProperty(e,i,{get:function(){return this.__vue_custom_element__[i]},set:function(e){if("object"!==("undefined"===typeof e?"undefined":A(e))&&"function"!==typeof e||!this.__vue_custom_element__){var i=t.types[t.camelCase[n]];this.setAttribute(t.hyphenate[n],z(e,i))}else{var o=t.camelCase[n];this.__vue_custom_element__[o]=e}}})})}function V(e,t,i){var n=t.propsData||{};return i.hyphenate.forEach(function(t,o){var r=i.camelCase[o],s=e.attributes[t]||e[r],a=null;i.types[r]&&(a=i.types[r]),s instanceof Attr?n[r]=z(s.value,a):"undefined"!==typeof s&&(n[r]=s)}),n}function U(e){var t={};return B(e.attributes).forEach(function(e){t["vue-slot"===e.nodeName?"slot":e.nodeName]=e.nodeValue}),t}function W(e){if(e.childNodes.length)return e.childNodes;if(e.content&&e.content.childNodes&&e.content.childNodes.length)return e.content.childNodes;var t=document.createElement("div");return t.innerHTML=e.innerHTML,t.childNodes}function $(e,t,i){var n=W(t),o=B(n).map(function(t){return"#text"===t.nodeName?t.nodeValue:e(t.tagName,{attrs:U(t),domProps:{innerHTML:t.innerHTML}})});return i.slot=t.id,e("template",i,o)}function q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],i=[];return B(e).forEach(function(e){if("#text"===e.nodeName)e.nodeValue.trim()&&i.push(t("span",e.nodeValue));else if("#comment"!==e.nodeName){var n=U(e),o={attrs:n,domProps:{innerHTML:""===e.innerHTML?e.innerText:e.innerHTML}};n.slot&&(o.slot=n.slot,n.slot=void 0);var r="TEMPLATE"===e.tagName?$(t,e,o):t(e.tagName,o);i.push(r)}}),i}function G(e,t){var i={bubbles:!1,cancelable:!1,detail:t},n=void 0;return"function"===typeof window.CustomEvent?n=new CustomEvent(e,i):(n=document.createEvent("CustomEvent"),n.initCustomEvent(e,i.bubbles,i.cancelable,i.detail)),n}function Z(e,t){for(var i=arguments.length,n=Array(i>2?i-2:0),o=2;o<i;o++)n[o-2]=arguments[o];var r=G(t,[].concat(n));e.dispatchEvent(r)}function X(e,t,i,n,o){if(!e.__vue_custom_element__){var r=function(){this.$emit=function(){for(var t,i=arguments.length,n=Array(i),o=0;o<i;o++)n[o]=arguments[o];Z.apply(void 0,[e].concat(n)),this.__proto__&&(t=this.__proto__.$emit).call.apply(t,[this].concat(n))}},s=t.util.extend({},i),a=V(e,s,n),l=t.version&&parseInt(t.version.split(".")[0],10)||0;if(s.beforeCreate=[].concat(s.beforeCreate||[],r),s._compiled){var c={};s._Ctor&&(c=Object.values(s._Ctor)[0].options),c.beforeCreate=s.beforeCreate}var h=void 0;if(l>=2){var u=e.cloneNode(!0).childNodes;h={propsData:a,props:n.camelCase,computed:{reactiveProps:function(){var e=this,t={};return n.camelCase.forEach(function(i){"undefined"!==typeof e[i]&&(t[i]=e[i])}),t}},render:function(e){var t={props:this.reactiveProps};return e(s,t,q(u,e))}}}else if(1===l)h=s,h.propsData=a;else{h=s;var d={};Object.keys(a).forEach(function(e){d[e]={default:a[e]}}),h.props=d}var p=l>=2?"<div></div>":("<div>"+e.innerHTML+"</div>").replace(/vue-slot=/g,"slot=");if(o.shadow&&e.shadowRoot?(e.shadowRoot.innerHTML=p,h.el=e.shadowRoot.children[0]):(e.innerHTML=p,h.el=e.children[0]),j(e,n),"function"===typeof o.beforeCreateVueInstance&&(h=o.beforeCreateVueInstance(h)||h),e.__vue_custom_element__=new t(h),e.__vue_custom_element_props__=n,e.getVueInstance=function(){return e.__vue_custom_element__.$children[0]},o.shadow&&o.shadowCss&&e.shadowRoot){var m=document.createElement("style");m.type="text/css",m.appendChild(document.createTextNode(o.shadowCss)),e.shadowRoot.appendChild(m)}e.removeAttribute("vce-cloak"),e.setAttribute("vce-ready",""),Z(e,"vce-ready")}}function K(e){e.customElement=function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o="function"===typeof i,r=o&&{props:n.props||[]},s=F(o?r:i),a=M(t,{constructorCallback:function(){"function"===typeof n.constructorCallback&&n.constructorCallback.call(this)},connectedCallback:function(){var r=this,a=o&&i(),l=a&&a.then&&"function"===typeof a.then;if("function"===typeof n.connectedCallback&&n.connectedCallback.call(this),o&&!l)throw new Error("Async component "+t+" do not returns Promise");this.__detached__||(l?a.then(function(t){var i=F(t);X(r,e,t,i,n),"function"===typeof n.vueInstanceCreatedCallback&&n.vueInstanceCreatedCallback.call(r)}):(X(this,e,i,s,n),"function"===typeof n.vueInstanceCreatedCallback&&n.vueInstanceCreatedCallback.call(this))),this.__detached__=!1},disconnectedCallback:function(){var e=this;this.__detached__=!0,"function"===typeof n.disconnectedCallback&&n.disconnectedCallback.call(this),setTimeout(function(){e.__detached__&&e.__vue_custom_element__&&(e.__vue_custom_element__.$destroy(!0),delete e.__vue_custom_element__,delete e.__vue_custom_element_props__)},n.destroyTimeout||3e3)},attributeChangedCallback:function(e,t,i){if(this.__vue_custom_element__&&"undefined"!==typeof i){var o=L(e);"function"===typeof n.attributeChangedCallback&&n.attributeChangedCallback.call(this,e,t,i);var r=this.__vue_custom_element_props__.types[o];this.__vue_custom_element__[o]=z(i,r)}},observedAttributes:s.hyphenate,shadow:!!n.shadow&&!!HTMLElement.prototype.attachShadow});return a}}"undefined"!==typeof window&&window.Vue&&(window.Vue.use(K),K.installed&&(K.installed=!1));var Y=K,J=function(){var e=this,t=e.$createElement,i=e._self._c||t;return 0!=e.rendered?i("div",{staticClass:"iiifannotation"},e._l(e.annotation_items,function(t){return i("div",[e._l(t.image,function(e){return i("span",[i("img",{attrs:{src:e,alt:t.altText,id:"annoimage"}})])}),i("img",{staticStyle:{display:"none"},attrs:{src:t.fullImage,id:"fullimage",alt:e.manifest["label"]}}),i("figcaption",{directives:[{name:"show",rawName:"v-show",value:void 0!=t.label&&0!=e.settings.view_larger,expression:"item.label != undefined && settings.view_larger != false"}],domProps:{innerHTML:e._s(t.label)}}),i("div",{directives:[{name:"show",rawName:"v-show",value:""!=t.ocr&&0!=e.settings.view_ocr,expression:"item.ocr != '' && settings.view_ocr != false"}],staticClass:"text",attrs:{id:e.ocr},domProps:{innerHTML:e._s(t.ocr)}}),i("p",{directives:[{name:"show",rawName:"v-show",value:""!=t.dataset["dataset_format"],expression:"item.dataset['dataset_format'] != ''"}]},[i("b",[i("a",{attrs:{href:t.dataset.dataset_url}},[e._v("Download dataset ("+e._s(t.dataset.dataset_format)+")")])])]),i("div",{domProps:{innerHTML:e._s(t.chars)}}),i("div",{domProps:{innerHTML:e._s(t.tags)}}),i("button",{directives:[{name:"show",rawName:"v-show",value:""!=t.fullImage&&0!=e.settings.view_larger,expression:"item.fullImage != '' && settings.view_larger != false"}],staticClass:"togglebutton",on:{click:function(t){e.toggle(t)}}},[e._v("View Full Image")]),i("div",{directives:[{name:"show",rawName:"v-show",value:0!=e.settings.view_full_object&&""!=e.full_object,expression:"settings.view_full_object != false && full_object != ''"}],attrs:{id:"link_to_object"}},[e._v("\n    Full object: "),i("a",{attrs:{href:e.full_object,target:"_blank"}},[e._v(e._s(e.manifest["label"]))])]),i("div")],2)})):i("div",[e._v('\n"'+e._s(e.annotationlist)+e._s(e.annotationurl)+'" did not render. Please ensure your annotation link is correct.'),i("br"),e._v('\nMake sure the annotation contains a link to a working manifest. If it does not add manifest url to tag using the "manifesturl" property.'),i("br"),e._v("\nAlso ensure you did not sure the wrong property for your annotation (annotationlist for lists of annotations and annotationurl for single annotations)\n")])},Q=[],ee=i("bc3a"),te=i.n(ee),ie=(i("289e"),{name:"iiifannotation",props:["annotationurl","annotationlist","manifesturl","imagesize"],data:function(){return{anno:"",manifest:"",settings:{},manifestlink:"",annotation_items:[],rendered:!1}},created:function(){var e=this;null!=document.getElementById("config")&&(this.settings=JSON.parse(document.getElementById("config").innerHTML));var t=this.annotationlist?this.annotationlist:this.annotationurl;te.a.get(t).then(function(t){if(void 0==e.annotationlist){e.anno=[].concat(t.data);var i=e.anno[0]["target"]?e.anno[0]["target"]:e.on_structure(e.anno[0]),n=Object.keys(i).indexOf("dcterms:isPartOf")>-1?i["dcterms:isPartOf"]:i["within"];e.manifestlink=n["id"]?n["id"]:n["@id"]}else if(e.anno=t.data.resources?t.data.resources:t.data,void 0==e.manifesturl){var o=e.on_structure(e.anno[0]);n=t.data["dcterms:isPartOf"]?t.data["dcterms:isPartOf"]:o.within?o.within:t.data["within"]["within"];e.manifestlink=n["id"]?n["id"]:n["@id"]}else e.manifestlink=e.manifesturl}).catch(function(e){console.log(e)}).then(function(t){te.a.get(e.manifestlink).then(function(t){e.manifest=t.data;for(var i=0;i<e.anno.length;i++){var n={image:[]};n["label"]=e.label(e.anno[i]),n["ocr"]=decodeURIComponent(escape(e.ocr(e.anno[i])));var o=e.on_structure(e.anno[i]),r=void 0!=e.anno[i].target?e.anno[i].target:o.full?o.full:o;r=[].concat(r);for(var s=0;s<r.length;s++){for(var a=r[s],l=0;l<e.manifest.sequences[0].canvases.length;l++){var c=e.manifest.sequences[0].canvases[l];if(c["@id"].replace("https","http")==e.canvasRegion(a)["canvasId"].replace("https","http"))var h=c}if("undefined"!=typeof e.on_structure(e.anno[i]).selector){o=e.on_structure(e.anno[i]);var u=o.selector.value?o.selector.value:o.selector.default.value;u=u.split("=")[1]}var d=void 0!=u?u:e.canvasRegion(a)["canvasRegion"],p=h.images[0].resource.service["@id"]?h.images[0].resource.service["@id"]:h.images[0].resource["@id"];if(e.imagesize)var m=e.imagesize;else if(u)m="full";else m="1200,";n["image"].push(p+"/"+d+"/"+m+"/0/default.jpg"),n["fullImage"]=e.fullImage(h,d)}n["chars"]=e.chars(e.anno[i])["textual_body"],n["tags"]=e.chars(e.anno[i])["tags"],n["dataset"]=e.dataset(e.anno[i]),n["altText"]=""!=n["ocr"]?n["ocr"]:void 0!=n["label"]?n["label"]:'Image section of "'+e.manifest["label"]+'"',e.annotation_items.push(n)}""!=e.manifestlink&&(e.rendered=!0)}).catch(function(e){console.log(e)})})},methods:{toggle:function(e){var t=e.target.parentElement,i=t.querySelector("#fullimage"),n=void 0!=e.srcElement?e.srcElement:e.target;"none"==i.style.display?(i.style.display="inline-block",n.innerHTML="Hide Full Image"):(i.style.display="none",n.innerHTML="View Full Image")},on_structure:function(e){return"undefined"==typeof e["on"]?"undefined":"undefined"!=typeof e["on"][0]&&"string"!=typeof e["on"][0]?e["on"][0]:e["on"]},label:function(e){var t=e.label?e.label:e.resource.label;return t},ocr:function(e){var t=e.body?e.body:e.resource,i=t["chars"]&&"cnt:ContentAsText"==t["@type"]?t["chars"]:"";return unescape(encodeURIComponent(i))},canvasRegion:function(e){if("string"!=typeof e&&(e=e["id"]?e["id"]:e["@id"]),e.indexOf("#xywh")>-1){var t=e.split("#")[1].split("=")[1];e=e.split("#")[0]}else t="full";return{canvasId:e,canvasRegion:t}},fullImage:function(e,t){var i=e.images[0].resource.service["@id"]?e.images[0].resource.service["@id"]:e.images[0].resource["@id"],n="full"!=t?i+"/full/1200,/0/default.jpg":"";return n},chars:function(e){var t=e.body?e.body:e.resource,i="",n="";t=[].concat(t);for(var o=0;o<t.length;o++){var r=t[o];if("TextualBody"==r["type"]||"dctypes:Text"==r["@type"]){var s=r["purpose"]?r["purpose"]:"dctypes:text",a=r["value"]?r["value"]:r["chars"];"tagging"==s?n+='<div class="'+s+'">'+a+"</div>":i+='<div class="'+s+'">'+a+"</div>"}else if("oa:Tag"==r["@type"]){a=r["value"]?r["value"]:r["chars"];n+='<div class="tagging">'+a+"</div>"}}return{textual_body:i,tags:n}},dataset:function(e){var t=e.body?e.body:e.resource,i=t["format"]&&"dctypes:Dataset"==t["@type"]?t["format"]:"",n=t["@id"]&&"dctypes:Dataset"==t["@type"]?t["@id"]:"";return{dataset_format:i,dataset_url:n}}},computed:{full_object:function(){var e,t=Object.keys(this.manifest);return e=t.indexOf("related")>-1?"string"==typeof this.manifest.related?this.manifest.related:this.manifest.related["@id"]:t.indexOf("seeAlso")>-1?this.manifest.seeAlso["@id"]:"",e}}}),ne=ie;function oe(e){var t=i("928a");t.__inject__&&t.__inject__(e)}var re=S(ne,J,Q,!1,oe,null,null,!0);re.options.__file="iiifannotation.vue";var se=re.exports,ae=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{position:"relative"},attrs:{id:"storyboard_viewer"}},[i("div",{staticStyle:{position:"relative"}},[i("div",{staticClass:"seadragonbox",staticStyle:{position:"relative"},attrs:{id:e.seadragonid}},[i("link",{attrs:{rel:"stylesheet",href:"https://use.fontawesome.com/releases/v5.5.0/css/all.css",integrity:"sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU",crossorigin:"anonymous"}}),i("span",{attrs:{id:"header_toolbar"}},[i("span",{staticStyle:{float:"right",margin:"10px 0 0 20px"}},[i("button",{staticClass:"nextButton",on:{click:function(t){e.createOverlay()}}},[i("i",{staticClass:"fas fa-toggle-on"})]),i("button",{staticClass:"nextButton",on:{click:function(t){e.full_screen()}}},[i("i",{staticClass:"fas fa-expand-arrows-alt"})]),i("button",{staticClass:"nextButton",on:{click:function(t){e.zoom("in")}}},[i("i",{staticClass:"fas fa-search-plus"})]),i("button",{staticClass:"nextButton",on:{click:function(t){e.zoom("out")}}},[i("i",{staticClass:"fas fa-search-minus"})]),i("button",{staticClass:"nextButton",on:{click:function(t){e.zoom("home")}}},[i("i",{staticClass:"fas fa-home"})]),i("button",{staticClass:"nextButton",class:{inactive:e.prev_inactive},on:{click:function(t){e.next("prev")}}},[i("i",{staticClass:"fa fa-arrow-left"})]),i("button",{staticClass:"nextButton",class:{inactive:e.next_inactive},on:{click:function(t){e.next("next")}}},[i("i",{staticClass:"fa fa-arrow-right"})])]),i("div",{staticClass:"window",attrs:{id:"fullscreen_annotation"},domProps:{innerHTML:e._s(e.currentanno)}})])]),i("div",{staticClass:"annotation",class:[e.currentanno?"active":"inactive"],attrs:{id:"annotation"}},[i("i",{staticClass:"fas fa-times close_button",on:{click:function(t){e.close(t)}}}),i("div",{attrs:{id:"annotation_text"},domProps:{innerHTML:e._s(e.currentanno)}})])])])},le=[],ce=i("aa78"),he=i.n(ce),ue={name:"storyboard",props:["annotationlist","manifesturl"],data:function(){return{zoomsections:[],seadragontile:"",position:-1,seadragonid:"",annotations:[],currentanno:"",prev_inactive:!0,next_inactive:!1,toolbar_id:"",first:!0,isfullscreen:!1,anno_elem:""}},created:function(){var e=this;this.seadragonid=this.annotationlist.split("/").pop().replace("-list","").replace(".json",""),te.a.get(this.annotationlist).then(function(t){var i=t.data.resources?t.data.resources:t.data,n=e.on_structure(i[0]);if(void 0==e.manifesturl)var o=t.data["dcterms:isPartOf"]?t.data["dcterms:isPartOf"]:n.within?n.within:t.data["within"]["within"],r=o["id"]?o["id"]:o["@id"];else r=e.manifesturl;var s=void 0!=i[0].target?i[0].target:n.full?n.full:n,a=s.split("#x")[0];te.a.get(r).then(function(i){for(var n=i.data.sequences[0].canvases,o=0;o<n.length;o++)if(n[o]["@id"]==a){var r=n[o].images[0].resource;e.seadragontile=r.service["@id"].split("full")[0]+"/info.json"}var s=t.data.resources;for(o=0;o<s.length;o++){var l=s[o].resource!=Array?s[o].resource:s[o].resource[0];if("undefined"!=typeof e.on_structure(s[o]).selector)var c=e.on_structure(s[o]),h=c.selector.value?c.selector.value:c.selector.default.value;var u=h||s[o].on,d="";if(void 0!=l[0]&&void 0==l[0].length)for(var p=0;p<l.length;p++)d+="<div class="+l[p]["@type"].replace("oa:","").toLowerCase()+">\n            "+l[p].chars+"</div>";else d=l.chars;e.annotations.push(d),e.zoomsections.push(u.split("=").pop())}e.createViewer()})})},methods:{createViewer:function(){this.viewer=he()({id:""+this.seadragonid,type:"image",nextButton:"next",previousButton:"previous",tileSources:""+this.seadragontile,toolbar:""+this.toolbar_id,showNavigator:!1,showNavigationControl:!1});var e=this.seadragonid;this.viewer.addHandler("full-screen",function(t){if(t.fullScreen){var i=document.getElementById(e).getElementsByClassName("window");i[0].classList.add("fullscreen"),i[0].classList.remove("window")}else{i=document.getElementsByClassName("fullscreen");i[0].classList.add("window"),i[0].classList.remove("fullscreen"),this.isfullscreen=!1}});var t=document.getElementById(""+this.seadragonid).getBoundingClientRect().left,i="calc("+t+"px + 20px)";this.anno_elem=document.getElementById(""+this.seadragonid).offsetParent.getElementsByClassName("annotation")[0],this.anno_elem.style.left=i,this.toolbar_id=this.seadragonid+"toolbarDiv"},full_screen:function(){0==this.viewer.isFullPage()?(this.viewer.setFullScreen(!0),this.isfullscreen=!0):(this.viewer.setFullScreen(!1),this.isfullscreen=!1)},close:function(e){e.target.parentElement.classList.add("inactive"),e.target.parentElement.classList.remove("active")},on_structure:function(e){return"undefined"==typeof e["on"]?"undefined":"undefined"!=typeof e["on"][0]&&"string"!=typeof e["on"][0]?e["on"][0]:e["on"]},zoom:function(e){var t=this.viewer.viewport.getZoom(),i=parseInt(this.viewer.viewport.getMinZoom()),n=parseInt(this.viewer.viewport.getMaxZoom()),o=.8;if("in"==e&&n!=parseInt(t))o=t+o;else if("out"==e&&i!=parseInt(t))o=t-o;else{if("home"!=e)return 0;o=this.viewer.viewport.getHomeZoom()}this.viewer.viewport.zoomTo(o)},createOverlay:function(){if(1==this.first){for(var e=0;e<this.zoomsections.length;e++){var t=this.zoomsections[e].split(","),i=this.viewer.world.getItemAt(0).imageToViewportRectangle(parseInt(t[0]),parseInt(t[1]),parseInt(t[2]),parseInt(t[3])),n=document.createElement("div");n.id="box",n.className="box",this.viewer.addOverlay({element:n,location:i}),this.addTracking(n,i,e,this)}this.first=!1}else{var o=document.getElementsByClassName("box");if("none"!=o[0].style.display)var r="none";else r="block";for(var s=0;s<o.length;s++)o[s].style.display=r}},addTracking:function(e,t,i,n){new he.a.MouseTracker({element:e,clickHandler:function(e){n.position=i,n.next()}}).setTracking(!0)},goToPoint:function(e){this.viewer.viewport.fitBoundsWithConstraints(e).ensureVisible()},next:function(e){if("prev"==e?this.position-=1:"next"==e?this.position+=1:this.position=this.position,void 0==this.zoomsections[this.position])this.viewer.viewport.fitVertically(),this.currentanno="";else{var t=this.zoomsections[this.position].split(",");this.currentanno=this.annotations[this.position];var i=this.viewer.world.getItemAt(0).imageToViewportRectangle(parseInt(t[0]),parseInt(t[1]),parseInt(t[2]),parseInt(t[3]));this.viewer.viewport.fitBoundsWithConstraints(i).ensureVisible()}this.position==this.zoomsections.length?(this.next_inactive=!0,this.position-=1):this.next_inactive=!1,-1==this.position?this.prev_inactive=!0:this.prev_inactive=!1,this.position!=this.zoomsections.length&&-1!=this.position&&(this.anno_elem.classList.remove("inactive"),this.anno_elem.classList.add("active"))}}},de=ue;function pe(e){var t=i("0e29");t.__inject__&&t.__inject__(e)}var me=S(de,ae,le,!1,pe,null,null,!0);me.options.__file="storyboard.vue";var ge=me.exports;r.a.use(Y),r.a.customElement("iiif-annotation",se),r.a.customElement("iiif-storyboard",ge),window.customElements.define("iiif-annotation",x(r.a,void 0))},"692f":function(e,t,i){var n=i("ce1e");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var o=i("35d6").default;e.exports.__inject__=function(e){o("779283c1",n,e)}},"7a77":function(e,t,i){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},"7aac":function(e,t,i){"use strict";var n=i("c532");e.exports=n.isStandardBrowserEnv()?function(){return{write:function(e,t,i,o,r,s){var a=[];a.push(e+"="+encodeURIComponent(t)),n.isNumber(i)&&a.push("expires="+new Date(i).toGMTString()),n.isString(o)&&a.push("path="+o),n.isString(r)&&a.push("domain="+r),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},"8bbf":function(e,t){e.exports=Vue},"8df4":function(e,t,i){"use strict";var n=i("7a77");function o(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var i=this;e(function(e){i.reason||(i.reason=new n(e),t(i.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e,t=new o(function(t){e=t});return{token:t,cancel:e}},e.exports=o},"928a":function(e,t,i){"use strict";i.r(t);var n=i("692f"),o=i.n(n);for(var r in n)"default"!==r&&function(e){i.d(t,e,function(){return n[e]})}(r);t["default"]=o.a},"9fa6":function(e,t,i){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function o(){this.message="String contains an invalid character"}function r(e){for(var t,i,r=String(e),s="",a=0,l=n;r.charAt(0|a)||(l="=",a%1);s+=l.charAt(63&t>>8-a%1*8)){if(i=r.charCodeAt(a+=.75),i>255)throw new o;t=t<<8|i}return s}o.prototype=new Error,o.prototype.code=5,o.prototype.name="InvalidCharacterError",e.exports=r},aa78:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;//! openseadragon 2.4.0
//! Built on 2018-07-20
//! Git commit: v2.4.0-0-446af4d
//! http://openseadragon.github.io
//! License: http://openseadragon.github.io/license/
function OpenSeadragon(e){return new OpenSeadragon.Viewer(e)}(function(e){e.version={versionStr:"2.4.0",major:parseInt("2",10),minor:parseInt("4",10),revision:parseInt("0",10)};var t={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},i=Object.prototype.toString,n=Object.prototype.hasOwnProperty;e.isFunction=function(t){return"function"===e.type(t)},e.isArray=Array.isArray||function(t){return"array"===e.type(t)},e.isWindow=function(e){return e&&"object"===typeof e&&"setInterval"in e},e.type=function(e){return null===e||void 0===e?String(e):t[i.call(e)]||"object"},e.isPlainObject=function(t){if(!t||"object"!==OpenSeadragon.type(t)||t.nodeType||e.isWindow(t))return!1;if(t.constructor&&!n.call(t,"constructor")&&!n.call(t.constructor.prototype,"isPrototypeOf"))return!1;var i;for(var o in t)i=o;return void 0===i||n.call(t,i)},e.isEmptyObject=function(e){for(var t in e)return!1;return!0},e.freezeObject=function(t){return Object.freeze?e.freezeObject=Object.freeze:e.freezeObject=function(e){return e},e.freezeObject(t)},e.supportsCanvas=function(){var t=document.createElement("canvas");return!(!e.isFunction(t.getContext)||!t.getContext("2d"))}(),e.isCanvasTainted=function(e){var t=!1;try{e.getContext("2d").getImageData(0,0,1,1)}catch(i){t=!0}return t},e.pixelDensityRatio=function(){if(e.supportsCanvas){var t=document.createElement("canvas").getContext("2d"),i=window.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return Math.max(i,1)/n}return 1}()})(OpenSeadragon),function($){$.extend=function(){var e,t,i,n,o,r,s=arguments[0]||{},a=arguments.length,l=!1,c=1;for("boolean"===typeof s&&(l=s,s=arguments[1]||{},c=2),"object"===typeof s||OpenSeadragon.isFunction(s)||(s={}),a===c&&(s=this,--c);c<a;c++)if(e=arguments[c],null!==e||void 0!==e)for(t in e)i=s[t],n=e[t],s!==n&&(l&&n&&(OpenSeadragon.isPlainObject(n)||(o=OpenSeadragon.isArray(n)))?(o?(o=!1,r=i&&OpenSeadragon.isArray(i)?i:[]):r=i&&OpenSeadragon.isPlainObject(i)?i:{},s[t]=OpenSeadragon.extend(l,r,n)):void 0!==n&&(s[t]=n));return s};var isIOSDevice=function(){if("object"!==typeof navigator)return!1;var e=navigator.userAgent;return"string"===typeof e&&(-1!==e.indexOf("iPhone")||-1!==e.indexOf("iPad")||-1!==e.indexOf("iPod"))};$.extend($,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:isIOSDevice(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,placeholderFillStyle:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"]},SIGNAL:"----seadragon----",delegate:function(e,t){return function(){var i=arguments;return void 0===i&&(i=[]),t.apply(e,i)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},getElement:function(e){return"string"==typeof e&&(e=document.getElementById(e)),e},getElementPosition:function(e){var t,i,n=new $.Point;e=$.getElement(e),t="fixed"==$.getElementStyle(e).position,i=getOffsetParent(e,t);while(i)n.x+=e.offsetLeft,n.y+=e.offsetTop,t&&(n=n.plus($.getPageScroll())),e=i,t="fixed"==$.getElementStyle(e).position,i=getOffsetParent(e,t);return n},getElementOffset:function(e){e=$.getElement(e);var t,i,n=e&&e.ownerDocument,o={top:0,left:0};return n?(t=n.documentElement,"undefined"!==typeof e.getBoundingClientRect&&(o=e.getBoundingClientRect()),i=n==n.window?n:9===n.nodeType&&(n.defaultView||n.parentWindow),new $.Point(o.left+(i.pageXOffset||t.scrollLeft)-(t.clientLeft||0),o.top+(i.pageYOffset||t.scrollTop)-(t.clientTop||0))):new $.Point},getElementSize:function(e){return e=$.getElement(e),new $.Point(e.clientWidth,e.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(e){return e=$.getElement(e),e.currentStyle}:function(e){return e=$.getElement(e),window.getComputedStyle(e,"")},getCssPropertyWithVendorPrefix:function(e){var t={};return $.getCssPropertyWithVendorPrefix=function(e){if(void 0!==t[e])return t[e];var i=document.createElement("div").style,n=null;if(void 0!==i[e])n=e;else for(var o=["Webkit","Moz","MS","O","webkit","moz","ms","o"],r=$.capitalizeFirstLetter(e),s=0;s<o.length;s++){var a=o[s]+r;if(void 0!==i[a]){n=a;break}}return t[e]=n,n},$.getCssPropertyWithVendorPrefix(e)},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},positiveModulo:function(e,t){var i=e%t;return i<0&&(i+=t),i},pointInElement:function(e,t){e=$.getElement(e);var i=$.getElementOffset(e),n=$.getElementSize(e);return t.x>=i.x&&t.x<i.x+n.x&&t.y<i.y+n.y&&t.y>=i.y},getEvent:function(e){return $.getEvent=e?function(e){return e}:function(){return window.event},$.getEvent(e)},getMousePosition:function(e){if("number"==typeof e.pageX)$.getMousePosition=function(e){var t=new $.Point;return e=$.getEvent(e),t.x=e.pageX,t.y=e.pageY,t};else{if("number"!=typeof e.clientX)throw new Error("Unknown event mouse position, no known technique.");$.getMousePosition=function(e){var t=new $.Point;return e=$.getEvent(e),t.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,t.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop,t}}return $.getMousePosition(e)},getPageScroll:function(){var e=document.documentElement||{},t=document.body||{};if("number"==typeof window.pageXOffset)$.getPageScroll=function(){return new $.Point(window.pageXOffset,window.pageYOffset)};else if(t.scrollLeft||t.scrollTop)$.getPageScroll=function(){return new $.Point(document.body.scrollLeft,document.body.scrollTop)};else{if(!e.scrollLeft&&!e.scrollTop)return new $.Point(0,0);$.getPageScroll=function(){return new $.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)}}return $.getPageScroll()},setPageScroll:function(e){if("undefined"!==typeof window.scrollTo)$.setPageScroll=function(e){window.scrollTo(e.x,e.y)};else{var t=$.getPageScroll();if(t.x===e.x&&t.y===e.y)return;document.body.scrollLeft=e.x,document.body.scrollTop=e.y;var i=$.getPageScroll();if(i.x!==t.x&&i.y!==t.y)return void($.setPageScroll=function(e){document.body.scrollLeft=e.x,document.body.scrollTop=e.y});if(document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y,i=$.getPageScroll(),i.x!==t.x&&i.y!==t.y)return void($.setPageScroll=function(e){document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y});$.setPageScroll=function(e){}}return $.setPageScroll(e)},getWindowSize:function(){var e=document.documentElement||{},t=document.body||{};if("number"==typeof window.innerWidth)$.getWindowSize=function(){return new $.Point(window.innerWidth,window.innerHeight)};else if(e.clientWidth||e.clientHeight)$.getWindowSize=function(){return new $.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else{if(!t.clientWidth&&!t.clientHeight)throw new Error("Unknown window size, no known technique.");$.getWindowSize=function(){return new $.Point(document.body.clientWidth,document.body.clientHeight)}}return $.getWindowSize()},makeCenteredNode:function(e){e=$.getElement(e);var t=[$.makeNeutralElement("div"),$.makeNeutralElement("div"),$.makeNeutralElement("div")];return $.extend(t[0].style,{display:"table",height:"100%",width:"100%"}),$.extend(t[1].style,{display:"table-row"}),$.extend(t[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),t[0].appendChild(t[1]),t[1].appendChild(t[2]),t[2].appendChild(e),t[0]},makeNeutralElement:function(e){var t=document.createElement(e),i=t.style;return i.background="transparent none",i.border="none",i.margin="0px",i.padding="0px",i.position="static",t},now:function(){return Date.now?$.now=Date.now:$.now=function(){return(new Date).getTime()},$.now()},makeTransparentImage:function(e){return $.makeTransparentImage=function(e){var t=$.makeNeutralElement("img");return t.src=e,t},$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<7&&($.makeTransparentImage=function(e){var t=$.makeNeutralElement("img"),i=null;return i=$.makeNeutralElement("span"),i.style.display="inline-block",t.onload=function(){i.style.width=i.style.width||t.width+"px",i.style.height=i.style.height||t.height+"px",t.onload=null,t=null},t.src=e,i.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"', sizingMethod='scale')",i}),$.makeTransparentImage(e)},setElementOpacity:function(e,t,i){var n,o;e=$.getElement(e),i&&!$.Browser.alpha&&(t=Math.round(t)),$.Browser.opacity?e.style.opacity=t<1?t:"":t<1?(n=Math.round(100*t),o="alpha(opacity="+n+")",e.style.filter=o):e.style.filter=""},setElementTouchActionNone:function(e){e=$.getElement(e),"undefined"!==typeof e.style.touchAction?e.style.touchAction="none":"undefined"!==typeof e.style.msTouchAction&&(e.style.msTouchAction="none")},addClass:function(e,t){e=$.getElement(e),e.className?-1===(" "+e.className+" ").indexOf(" "+t+" ")&&(e.className+=" "+t):e.className=t},indexOf:function(e,t,i){return Array.prototype.indexOf?this.indexOf=function(e,t,i){return e.indexOf(t,i)}:this.indexOf=function(e,t,i){var n,o,r=i||0;if(!e)throw new TypeError;if(o=e.length,0===o||r>=o)return-1;for(r<0&&(r=o-Math.abs(r)),n=r;n<o;n++)if(e[n]===t)return n;return-1},this.indexOf(e,t,i)},removeClass:function(e,t){var i,n,o=[];for(e=$.getElement(e),i=e.className.split(/\s+/),n=0;n<i.length;n++)i[n]&&i[n]!==t&&o.push(i[n]);e.className=o.join(" ")},addEvent:function(){if(window.addEventListener)return function(e,t,i,n){e=$.getElement(e),e.addEventListener(t,i,n)};if(window.attachEvent)return function(e,t,i,n){e=$.getElement(e),e.attachEvent("on"+t,i)};throw new Error("No known event model.")}(),removeEvent:function(){if(window.removeEventListener)return function(e,t,i,n){e=$.getElement(e),e.removeEventListener(t,i,n)};if(window.detachEvent)return function(e,t,i,n){e=$.getElement(e),e.detachEvent("on"+t,i)};throw new Error("No known event model.")}(),cancelEvent:function(e){e=$.getEvent(e),e.preventDefault?$.cancelEvent=function(e){e.preventDefault()}:$.cancelEvent=function(e){e=$.getEvent(e),e.cancel=!0,e.returnValue=!1},$.cancelEvent(e)},stopEvent:function(e){e=$.getEvent(e),e.stopPropagation?$.stopEvent=function(e){e.stopPropagation()}:$.stopEvent=function(e){e=$.getEvent(e),e.cancelBubble=!0},$.stopEvent(e)},createCallback:function(e,t){var i,n=[];for(i=2;i<arguments.length;i++)n.push(arguments[i]);return function(){var i,o=n.concat([]);for(i=0;i<arguments.length;i++)o.push(arguments[i]);return t.apply(e,o)}},getUrlParameter:function(e){var t=URLPARAMS[e];return t||null},getUrlProtocol:function(e){var t=e.match(/^([a-z]+:)\/\//i);return null===t?window.location.protocol:t[1].toLowerCase()},createAjaxRequest:function(e){var t;try{t=!!new ActiveXObject("Microsoft.XMLHTTP")}catch(i){t=!1}if(t)window.XMLHttpRequest?$.createAjaxRequest=function(e){return e?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:$.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else{if(!window.XMLHttpRequest)throw new Error("Browser doesn't support XMLHttpRequest.");$.createAjaxRequest=function(){return new XMLHttpRequest}}return $.createAjaxRequest(e)},makeAjaxRequest:function(e,t,i){var n,o,r;$.isPlainObject(e)&&(t=e.success,i=e.error,n=e.withCredentials,o=e.headers,r=e.responseType||null,e=e.url);var s=$.getUrlProtocol(e),a=$.createAjaxRequest("file:"===s);if(!$.isFunction(t))throw new Error("makeAjaxRequest requires a success callback");a.onreadystatechange=function(){4==a.readyState&&(a.onreadystatechange=function(){},a.status>=200&&a.status<300||0===a.status&&"http:"!==s&&"https:"!==s?t(a):($.console.log("AJAX request returned %d: %s",a.status,e),$.isFunction(i)&&i(a)))};try{if(a.open("GET",e,!0),r&&(a.responseType=r),o)for(var l in o)o.hasOwnProperty(l)&&o[l]&&a.setRequestHeader(l,o[l]);n&&(a.withCredentials=!0),a.send(null)}catch(d){var c=d.message,h=$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<10;if(h&&"undefined"!=typeof d.number&&-2147024891==d.number&&(c+="\nSee http://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx#xdomain"),$.console.log("%s while making AJAX request: %s",d.name,c),a.onreadystatechange=function(){},window.XDomainRequest){var u=new XDomainRequest;if(u){u.onload=function(e){$.isFunction(t)&&t({responseText:u.responseText,status:200,statusText:"OK"})},u.onerror=function(e){$.isFunction(i)&&i({responseText:u.responseText,status:444,statusText:"An error happened. Due to an XDomainRequest deficiency we can not extract any information about this error. Upgrade your browser."})};try{u.open("GET",e),u.send()}catch(p){$.isFunction(i)&&i(a,d)}}}else $.isFunction(i)&&i(a,d)}return a},jsonp:function(e){var t,i=e.url,n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,o=e.callbackName||"openseadragon"+$.now(),r=window[o],s="$1"+o+"$2",a=e.param||"callback",l=e.callback;i=i.replace(/(\=)\?(&|$)|\?\?/i,s),i+=(/\?/.test(i)?"&":"?")+a+"="+o,window[o]=function(e){if(r)window[o]=r;else try{delete window[o]}catch(t){}l&&$.isFunction(l)&&l(e)},t=document.createElement("script"),void 0===e.async&&!1===e.async||(t.async="async"),e.scriptCharset&&(t.charset=e.scriptCharset),t.src=i,t.onload=t.onreadystatechange=function(e,i){(i||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,n&&t.parentNode&&n.removeChild(t),t=void 0)},n.insertBefore(t,n.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(e){if(window.DOMParser)$.parseXml=function(e){var t,i=null;return t=new DOMParser,i=t.parseFromString(e,"text/xml"),i};else{if(!window.ActiveXObject)throw new Error("Browser doesn't support XML DOM.");$.parseXml=function(e){var t=null;return t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(e),t}}return $.parseXml(e)},parseJSON:function(string){return window.JSON&&window.JSON.parse?$.parseJSON=window.JSON.parse:$.parseJSON=function(string){return eval("("+string+")")},$.parseJSON(string)},imageFormatSupported:function(e){return e=e||"",!!FILEFORMATS[e.toLowerCase()]}}),$.Browser={vendor:$.BROWSERS.UNKNOWN,version:0,alpha:!0};var FILEFORMATS={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},URLPARAMS={};(function(){var e,t=navigator.appVersion,i=navigator.userAgent;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(i.substring(i.indexOf("MSIE")+5,i.indexOf(";",i.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(i.indexOf("Firefox")>=0?($.Browser.vendor=$.BROWSERS.FIREFOX,$.Browser.version=parseFloat(i.substring(i.indexOf("Firefox")+8))):i.indexOf("Safari")>=0?($.Browser.vendor=i.indexOf("Chrome")>=0?$.BROWSERS.CHROME:$.BROWSERS.SAFARI,$.Browser.version=parseFloat(i.substring(i.substring(0,i.indexOf("Safari")).lastIndexOf("/")+1,i.indexOf("Safari")))):(e=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!==e.exec(i)&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":$.Browser.vendor=$.BROWSERS.OPERA,$.Browser.version=parseFloat(t);break}var n,o,r,s=window.location.search.substring(1),a=s.split("&");for(r=0;r<a.length;r++)n=a[r],o=n.indexOf("="),o>0&&(URLPARAMS[n.substring(0,o)]=decodeURIComponent(n.substring(o+1)));$.Browser.alpha=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9||$.Browser.vendor==$.BROWSERS.CHROME&&$.Browser.version<2),$.Browser.opacity=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9)})();var nullfunction=function(e){};function getOffsetParent(e,t){return t&&e!=document.body?document.body:e.offsetParent}$.console=window.console||{log:nullfunction,debug:nullfunction,info:nullfunction,warn:nullfunction,error:nullfunction,assert:nullfunction},function(e){var t=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame,i=e.cancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelAnimationFrame||e.msCancelAnimationFrame;if(t&&i)$.requestAnimationFrame=function(){return t.apply(e,arguments)},$.cancelAnimationFrame=function(){return i.apply(e,arguments)};else{var n,o=[],r=[],s=0;$.requestAnimationFrame=function(e){return o.push([++s,e]),n||(n=setInterval(function(){if(o.length){var e=$.now(),t=r;r=o,o=t;while(r.length)r.shift()[1](e)}else clearInterval(n),n=void 0},20)),s},$.cancelAnimationFrame=function(e){var t,i;for(t=0,i=o.length;t<i;t+=1)if(o[t][0]===e)return void o.splice(t,1);for(t=0,i=r.length;t<i;t+=1)if(r[t][0]===e)return void r.splice(t,1)}}}(window)}(OpenSeadragon),function(e,t){__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_FACTORY__=t,__WEBPACK_AMD_DEFINE_RESULT__="function"===typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__,void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(0,function(){return OpenSeadragon}),function(e){var t={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.fullscreenElement},t.requestFullScreen=function(e){return e.requestFullscreen()},t.exitFullScreen=function(){document.exitFullscreen()},t.fullScreenEventName="fullscreenchange",t.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.msFullscreenElement},t.requestFullScreen=function(e){return e.msRequestFullscreen()},t.exitFullScreen=function(){document.msExitFullscreen()},t.fullScreenEventName="MSFullscreenChange",t.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.webkitFullscreenElement},t.requestFullScreen=function(e){return e.webkitRequestFullscreen()},t.exitFullScreen=function(){document.webkitExitFullscreen()},t.fullScreenEventName="webkitfullscreenchange",t.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},t.requestFullScreen=function(e){return e.webkitRequestFullScreen()},t.exitFullScreen=function(){document.webkitCancelFullScreen()},t.fullScreenEventName="webkitfullscreenchange",t.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.mozFullScreenElement},t.requestFullScreen=function(e){return e.mozRequestFullScreen()},t.exitFullScreen=function(){document.mozCancelFullScreen()},t.fullScreenEventName="mozfullscreenchange",t.fullScreenErrorEventName="mozfullscreenerror"),t.isFullScreen=function(){return null!==t.getFullScreenElement()},t.cancelFullScreen=function(){e.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),t.exitFullScreen()},e.extend(e,t)}(OpenSeadragon),function(e){e.EventSource=function(){this.events={}},e.EventSource.prototype={addOnceHandler:function(e,t,i,n){var o=this;n=n||1;var r=0,s=function(i){r++,r===n&&o.removeHandler(e,s),t(i)};this.addHandler(e,s,i)},addHandler:function(t,i,n){var o=this.events[t];o||(this.events[t]=o=[]),i&&e.isFunction(i)&&(o[o.length]={handler:i,userData:n||null})},removeHandler:function(t,i){var n,o=this.events[t],r=[];if(o&&e.isArray(o)){for(n=0;n<o.length;n++)o[n].handler!==i&&r.push(o[n]);this.events[t]=r}},removeAllHandlers:function(e){if(e)this.events[e]=[];else for(var t in this.events)this.events[t]=[]},getHandler:function(e){var t=this.events[e];return t&&t.length?(t=1===t.length?[t[0]]:Array.apply(null,t),function(e,i){var n,o=t.length;for(n=0;n<o;n++)t[n]&&(i.eventSource=e,i.userData=t[n].userData,t[n].handler(i))}):null},raiseEvent:function(e,t){var i=this.getHandler(e);i&&(t||(t={}),i(this,t))}}}(OpenSeadragon),function(e){var t=[],i={};function n(t){var n,o=i[t.hash],r=o.activePointersLists.length;for(n=0;n<r;n++)o.activePointersLists[n].captureCount>0&&(e.removeEvent(e.MouseTracker.captureElement,"mousemove",o.mousemovecaptured,!0),e.removeEvent(e.MouseTracker.captureElement,"mouseup",o.mouseupcaptured,!0),e.removeEvent(e.MouseTracker.captureElement,e.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",o.pointermovecaptured,!0),e.removeEvent(e.MouseTracker.captureElement,e.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",o.pointerupcaptured,!0),e.removeEvent(e.MouseTracker.captureElement,"touchmove",o.touchmovecaptured,!0),e.removeEvent(e.MouseTracker.captureElement,"touchend",o.touchendcaptured,!0),o.activePointersLists[n].captureCount=0);for(n=0;n<r;n++)o.activePointersLists.pop()}function o(t){var o,r,s=i[t.hash];if(!s.tracking){for(r=0;r<e.MouseTracker.subscribeEvents.length;r++)o=e.MouseTracker.subscribeEvents[r],e.addEvent(t.element,o,s[o],!1);n(t),s.tracking=!0}}function r(t){var o,r,s=i[t.hash];if(s.tracking){for(r=0;r<e.MouseTracker.subscribeEvents.length;r++)o=e.MouseTracker.subscribeEvents[r],e.removeEvent(t.element,o,s[o],!1);n(t),s.tracking=!1}}function s(t,n){var o=i[t.hash];if("pointerevent"===n)return{upName:e.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",upHandler:o.pointerupcaptured,moveName:e.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",moveHandler:o.pointermovecaptured};if("mouse"===n)return{upName:"mouseup",upHandler:o.mouseupcaptured,moveName:"mousemove",moveHandler:o.mousemovecaptured};if("touch"===n)return{upName:"touchend",upHandler:o.touchendcaptured,moveName:"touchmove",moveHandler:o.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function a(t,i,n){var o,r=t.getActivePointersListByType(i);r.captureCount+=n||1,1===r.captureCount&&(e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?t.element.setCapture(!0):(o=s(t,e.MouseTracker.havePointerEvents?"pointerevent":i),ge&&fe(window.top)&&e.addEvent(window.top,o.upName,o.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,o.upName,o.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,o.moveName,o.moveHandler,!0)))}function l(t,i,n){var o,r=t.getActivePointersListByType(i);r.captureCount-=n||1,0===r.captureCount&&(e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?t.element.releaseCapture():(o=s(t,e.MouseTracker.havePointerEvents?"pointerevent":i),ge&&fe(window.top)&&e.removeEvent(window.top,o.upName,o.upHandler,!0),e.removeEvent(e.MouseTracker.captureElement,o.moveName,o.moveHandler,!0),e.removeEvent(e.MouseTracker.captureElement,o.upName,o.upHandler,!0)))}function c(t){var i;if(e.MouseTracker.unprefixedPointerEvents)i=t.pointerType;else switch(t.pointerType){case 2:i="touch";break;case 3:i="pen";break;case 4:i="mouse";break;default:i=""}return i}function h(t){return e.getMousePosition(t)}function u(e,t){return d(h(e),t)}function d(t,i){var n=e.getElementOffset(i);return t.minus(n)}function p(t,i){return new e.Point((t.x+i.x)/2,(t.y+i.y)/2)}function m(t,i){t.clickHandler&&e.cancelEvent(i)}function g(t,i){t.dblClickHandler&&e.cancelEvent(i)}function f(t,i){var n;t.keyDownHandler&&(i=e.getEvent(i),n=t.keyDownHandler({eventSource:t,keyCode:i.keyCode?i.keyCode:i.charCode,ctrl:i.ctrlKey,shift:i.shiftKey,alt:i.altKey,meta:i.metaKey,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),n||e.cancelEvent(i))}function v(t,i){var n;t.keyUpHandler&&(i=e.getEvent(i),n=t.keyUpHandler({eventSource:t,keyCode:i.keyCode?i.keyCode:i.charCode,ctrl:i.ctrlKey,shift:i.shiftKey,alt:i.altKey,meta:i.metaKey,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),n||e.cancelEvent(i))}function y(t,i){var n;t.keyHandler&&(i=e.getEvent(i),n=t.keyHandler({eventSource:t,keyCode:i.keyCode?i.keyCode:i.charCode,ctrl:i.ctrlKey,shift:i.shiftKey,alt:i.altKey,meta:i.metaKey,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),n||e.cancelEvent(i))}function w(t,i){var n;t.focusHandler&&(i=e.getEvent(i),n=t.focusHandler({eventSource:t,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),!1===n&&e.cancelEvent(i))}function T(t,i){var n;t.blurHandler&&(i=e.getEvent(i),n=t.blurHandler({eventSource:t,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),!1===n&&e.cancelEvent(i))}function x(e,t){E(e,t,t)}function S(t,i){i=e.getEvent(i);var n={target:i.target||i.srcElement,type:"wheel",shiftKey:i.shiftKey||!1,clientX:i.clientX,clientY:i.clientY,pageX:i.pageX?i.pageX:i.clientX,pageY:i.pageY?i.pageY:i.clientY,deltaMode:"MozMousePixelScroll"==i.type?0:1,deltaX:0,deltaZ:0};"mousewheel"==e.MouseTracker.wheelEventName?n.deltaY=-i.wheelDelta/e.DEFAULT_SETTINGS.pixelsPerWheelLine:n.deltaY=i.detail,E(t,n,i)}function E(t,i,n){var o,r=0;r=i.deltaY<0?1:-1,t.scrollHandler&&(o=t.scrollHandler({eventSource:t,pointerType:"mouse",position:u(i,t.element),scroll:r,shift:i.shiftKey,isTouchEvent:!1,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===o&&e.cancelEvent(n))}function _(e,t){if(e===t)return!1;while(t&&t!==e)t=t.parentNode;return t===e}function b(t,i){i=e.getEvent(i),C(t,i)}function P(t,i){i=e.getEvent(i),i.currentTarget===i.relatedTarget||_(i.currentTarget,i.relatedTarget)||C(t,i)}function C(t,i){var n={id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:h(i),currentTime:e.now()};le(t,i,[n])}function R(t,i){i=e.getEvent(i),k(t,i)}function O(t,i){i=e.getEvent(i),i.currentTarget===i.relatedTarget||_(i.currentTarget,i.relatedTarget)||k(t,i)}function k(t,i){var n={id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:h(i),currentTime:e.now()};ce(t,i,[n])}function M(t){return e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?1===t?0:2===t?2:4===t?1:-1:t}function I(t,i){var n;i=e.getEvent(i),n={id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:h(i),currentTime:e.now()},he(t,i,[n],M(i.button))&&(e.stopEvent(i),a(t,"mouse")),(t.clickHandler||t.dblClickHandler||t.pressHandler||t.dragHandler||t.dragEndHandler)&&e.cancelEvent(i)}function L(e,t){D(e,t)}function H(t,i){D(t,i),e.stopEvent(i)}function D(t,i){var n;i=e.getEvent(i),n={id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:h(i),currentTime:e.now()},ue(t,i,[n],M(i.button))&&l(t,"mouse")}function B(e,t){z(e,t)}function A(t,i){z(t,i),e.stopEvent(i)}function z(t,i){var n;i=e.getEvent(i),n={id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:h(i),currentTime:e.now()},de(t,i,[n])}function N(e,t,i){var n,o=i.getLength(),r=[];if("touch"===i.type||i.contacts>0){for(n=0;n<o;n++)r.push(i.getByIndex(n));r.length>0&&(ue(e,t,r,0),i.captureCount=1,l(e,i.type),ce(e,t,r))}}function F(i,n){var o,r,s,l,c=n.changedTouches.length,u=[],d=i.getActivePointersListByType("touch");for(o=e.now(),d.getLength()>n.touches.length-c&&(e.console.warn("Tracked touch contact count doesn't match event.touches.length. Removing all tracked touch pointers."),N(i,n,d)),r=0;r<c;r++)u.push({id:n.changedTouches[r].identifier,type:"touch",currentPos:h(n.changedTouches[r]),currentTime:o});for(le(i,n,u),r=0;r<t.length;r++)if(t[r]!==i&&t[r].isTracking()&&_(t[r].element,i.element)){for(l=[],s=0;s<c;s++)l.push({id:n.changedTouches[s].identifier,type:"touch",currentPos:h(n.changedTouches[s]),currentTime:o});le(t[r],n,l)}he(i,n,u,0)&&(e.stopEvent(n),a(i,"touch",c)),e.cancelEvent(n)}function j(e,t){U(e,t)}function V(t,i){U(t,i),e.stopEvent(i)}function U(i,n){var o,r,s,a,c=n.changedTouches.length,u=[];for(o=e.now(),r=0;r<c;r++)u.push({id:n.changedTouches[r].identifier,type:"touch",currentPos:h(n.changedTouches[r]),currentTime:o});for(ue(i,n,u,0)&&l(i,"touch",c),ce(i,n,u),r=0;r<t.length;r++)if(t[r]!==i&&t[r].isTracking()&&_(t[r].element,i.element)){for(a=[],s=0;s<c;s++)a.push({id:n.changedTouches[s].identifier,type:"touch",currentPos:h(n.changedTouches[s]),currentTime:o});ce(t[r],n,a)}e.cancelEvent(n)}function W(e,t){q(e,t)}function $(t,i){q(t,i),e.stopEvent(i)}function q(t,i){var n,o=i.changedTouches.length,r=[];for(n=0;n<o;n++)r.push({id:i.changedTouches[n].identifier,type:"touch",currentPos:h(i.changedTouches[n]),currentTime:e.now()});de(t,i,r),e.cancelEvent(i)}function G(e,t){var i=e.getActivePointersListByType("touch");N(e,t,i)}function Z(e,t){return t.stopPropagation(),t.preventDefault(),!1}function X(e,t){return t.stopPropagation(),t.preventDefault(),!1}function K(t,i){var n;i.currentTarget===i.relatedTarget||_(i.currentTarget,i.relatedTarget)||(n={id:i.pointerId,type:c(i),isPrimary:i.isPrimary,currentPos:h(i),currentTime:e.now()},le(t,i,[n]))}function Y(t,i){var n;i.currentTarget===i.relatedTarget||_(i.currentTarget,i.relatedTarget)||(n={id:i.pointerId,type:c(i),isPrimary:i.isPrimary,currentPos:h(i),currentTime:e.now()},ce(t,i,[n]))}function J(t,i){var n;n={id:i.pointerId,type:c(i),isPrimary:i.isPrimary,currentPos:h(i),currentTime:e.now()},he(t,i,[n],i.button)&&(e.stopEvent(i),a(t,n.type)),(t.clickHandler||t.dblClickHandler||t.pressHandler||t.dragHandler||t.dragEndHandler||t.pinchHandler)&&e.cancelEvent(i)}function Q(e,t){te(e,t)}function ee(t,i){var n=t.getActivePointersListByType(c(i));n.getById(i.pointerId)&&te(t,i),e.stopEvent(i)}function te(t,i){var n;n={id:i.pointerId,type:c(i),isPrimary:i.isPrimary,currentPos:h(i),currentTime:e.now()},ue(t,i,[n],i.button)&&l(t,n.type)}function ie(e,t){oe(e,t)}function ne(t,i){var n=t.getActivePointersListByType(c(i));n.getById(i.pointerId)&&oe(t,i),e.stopEvent(i)}function oe(t,i){var n;n={id:i.pointerId,type:c(i),isPrimary:i.isPrimary,currentPos:h(i),currentTime:e.now()},de(t,i,[n])}function re(e,t){var i;i={id:t.pointerId,type:c(t)},pe(e,t,[i])}function se(e,t){return t.hasOwnProperty("isPrimary")||(0===e.getLength()?t.isPrimary=!0:t.isPrimary=!1),t.speed=0,t.direction=0,t.contactPos=t.currentPos,t.contactTime=t.currentTime,t.lastPos=t.currentPos,t.lastTime=t.currentTime,e.add(t)}function ae(e,t){var i,n;return e.getById(t.id)?(i=e.removeById(t.id),t.hasOwnProperty("isPrimary")||(n=e.getPrimary(),n||(n=e.getByIndex(0),n&&(n.isPrimary=!0)))):i=e.getLength(),i}function le(t,i,n){var o,r,s,a,l=t.getActivePointersListByType(n[0].type),c=n.length;for(o=0;o<c;o++)r=n[o],s=l.getById(r.id),s?(s.insideElement=!0,s.lastPos=s.currentPos,s.lastTime=s.currentTime,s.currentPos=r.currentPos,s.currentTime=r.currentTime,r=s):(r.captured=!1,r.insideElementPressed=!1,r.insideElement=!0,se(l,r)),t.enterHandler&&(a=t.enterHandler({eventSource:t,pointerType:r.type,position:d(r.currentPos,t.element),buttons:l.buttons,pointers:t.getActivePointerCount(),insideElementPressed:r.insideElementPressed,buttonDownAny:0!==l.buttons,isTouchEvent:"touch"===r.type,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),!1===a&&e.cancelEvent(i))}function ce(t,i,n){var o,r,s,a,l=t.getActivePointersListByType(n[0].type),c=n.length;for(o=0;o<c;o++)r=n[o],s=l.getById(r.id),s&&(s.captured?(s.insideElement=!1,s.lastPos=s.currentPos,s.lastTime=s.currentTime,s.currentPos=r.currentPos,s.currentTime=r.currentTime):ae(l,s),r=s),t.exitHandler&&(a=t.exitHandler({eventSource:t,pointerType:r.type,position:d(r.currentPos,t.element),buttons:l.buttons,pointers:t.getActivePointerCount(),insideElementPressed:!!s&&s.insideElementPressed,buttonDownAny:0!==l.buttons,isTouchEvent:"touch"===r.type,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),!1===a&&e.cancelEvent(i))}function he(t,n,o,r){var s,a,l,c,h=i[t.hash],u=t.getActivePointersListByType(o[0].type),m=o.length;"undefined"!==typeof n.buttons?u.buttons=n.buttons:e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?0===r?u.buttons+=1:1===r?u.buttons+=4:2===r?u.buttons+=2:3===r?u.buttons+=8:4===r?u.buttons+=16:5===r&&(u.buttons+=32):0===r?u.buttons|=1:1===r?u.buttons|=4:2===r?u.buttons|=2:3===r?u.buttons|=8:4===r?u.buttons|=16:5===r&&(u.buttons|=32);var g=t.getActivePointersListsExceptType(o[0].type);for(a=0;a<g.length;a++)N(t,n,g[a]);if(0!==r)return t.nonPrimaryPressHandler&&(s=t.nonPrimaryPressHandler({eventSource:t,pointerType:o[0].type,position:d(o[0].currentPos,t.element),button:r,buttons:u.buttons,isTouchEvent:"touch"===o[0].type,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===s&&e.cancelEvent(n)),!1;for(a=0;a<m;a++)l=o[a],c=u.getById(l.id),c?(c.captured=!0,c.insideElementPressed=!0,c.insideElement=!0,c.contactPos=l.currentPos,c.contactTime=l.currentTime,c.lastPos=c.currentPos,c.lastTime=c.currentTime,c.currentPos=l.currentPos,c.currentTime=l.currentTime,l=c):(l.captured=!0,l.insideElementPressed=!0,l.insideElement=!0,se(u,l)),u.addContact(),(t.dragHandler||t.dragEndHandler||t.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.addPoint(t,l),1===u.contacts?t.pressHandler&&(s=t.pressHandler({eventSource:t,pointerType:l.type,position:d(l.contactPos,t.element),buttons:u.buttons,isTouchEvent:"touch"===l.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===s&&e.cancelEvent(n)):2===u.contacts&&t.pinchHandler&&"touch"===l.type&&(h.pinchGPoints=u.asArray(),h.lastPinchDist=h.currentPinchDist=h.pinchGPoints[0].currentPos.distanceTo(h.pinchGPoints[1].currentPos),h.lastPinchCenter=h.currentPinchCenter=p(h.pinchGPoints[0].currentPos,h.pinchGPoints[1].currentPos));return!0}function ue(t,n,o,r){var s,a,l,c,h,u,m,g=i[t.hash],f=t.getActivePointersListByType(o[0].type),v=o.length,y=!1,w=!1;if("undefined"!==typeof n.buttons?f.buttons=n.buttons:e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?0===r?f.buttons-=1:1===r?f.buttons-=4:2===r?f.buttons-=2:3===r?f.buttons-=8:4===r?f.buttons-=16:5===r&&(f.buttons-=32):0===r?f.buttons^=-2:1===r?f.buttons^=-5:2===r?f.buttons^=-3:3===r?f.buttons^=-9:4===r?f.buttons^=-17:5===r&&(f.buttons^=-33),0!==r){t.nonPrimaryReleaseHandler&&(s=t.nonPrimaryReleaseHandler({eventSource:t,pointerType:o[0].type,position:d(o[0].currentPos,t.element),button:r,buttons:f.buttons,isTouchEvent:"touch"===o[0].type,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===s&&e.cancelEvent(n));var T=t.getActivePointersListByType("mouse");return N(t,n,T),!1}for(c=0;c<v;c++)h=o[c],u=f.getById(h.id),u&&(u.captured&&(u.captured=!1,y=!0,w=!0),u.lastPos=u.currentPos,u.lastTime=u.currentTime,u.currentPos=h.currentPos,u.currentTime=h.currentTime,u.insideElement||ae(f,u),a=u.currentPos,l=u.currentTime,w?(f.removeContact(),(t.dragHandler||t.dragEndHandler||t.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.removePoint(t,u),0===f.contacts?(t.releaseHandler&&(s=t.releaseHandler({eventSource:t,pointerType:u.type,position:d(a,t.element),buttons:f.buttons,insideElementPressed:u.insideElementPressed,insideElementReleased:u.insideElement,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===s&&e.cancelEvent(n)),t.dragEndHandler&&!u.currentPos.equals(u.contactPos)&&(s=t.dragEndHandler({eventSource:t,pointerType:u.type,position:d(u.currentPos,t.element),speed:u.speed,direction:u.direction,shift:n.shiftKey,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===s&&e.cancelEvent(n)),(t.clickHandler||t.dblClickHandler)&&u.insideElement&&(m=l-u.contactTime<=t.clickTimeThreshold&&u.contactPos.distanceTo(a)<=t.clickDistThreshold,t.clickHandler&&(s=t.clickHandler({eventSource:t,pointerType:u.type,position:d(u.currentPos,t.element),quick:m,shift:n.shiftKey,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===s&&e.cancelEvent(n)),t.dblClickHandler&&m&&(f.clicks++,1===f.clicks?(g.lastClickPos=a,g.dblClickTimeOut=setTimeout(function(){f.clicks=0},t.dblClickTimeThreshold)):2===f.clicks&&(clearTimeout(g.dblClickTimeOut),f.clicks=0,g.lastClickPos.distanceTo(a)<=t.dblClickDistThreshold&&(s=t.dblClickHandler({eventSource:t,pointerType:u.type,position:d(u.currentPos,t.element),shift:n.shiftKey,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===s&&e.cancelEvent(n)),g.lastClickPos=null)))):2===f.contacts&&t.pinchHandler&&"touch"===u.type&&(g.pinchGPoints=f.asArray(),g.lastPinchDist=g.currentPinchDist=g.pinchGPoints[0].currentPos.distanceTo(g.pinchGPoints[1].currentPos),g.lastPinchCenter=g.currentPinchCenter=p(g.pinchGPoints[0].currentPos,g.pinchGPoints[1].currentPos))):t.releaseHandler&&(s=t.releaseHandler({eventSource:t,pointerType:u.type,position:d(a,t.element),buttons:f.buttons,insideElementPressed:u.insideElementPressed,insideElementReleased:u.insideElement,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===s&&e.cancelEvent(n)));return y}function de(t,n,o){var r,s,a,l,c,h,u=i[t.hash],m=t.getActivePointersListByType(o[0].type),g=o.length;for("undefined"!==typeof n.buttons&&(m.buttons=n.buttons),r=0;r<g;r++)s=o[r],a=m.getById(s.id),a?(s.hasOwnProperty("isPrimary")&&(a.isPrimary=s.isPrimary),a.lastPos=a.currentPos,a.lastTime=a.currentTime,a.currentPos=s.currentPos,a.currentTime=s.currentTime):(s.captured=!1,s.insideElementPressed=!1,s.insideElement=!0,se(m,s));t.stopHandler&&"mouse"===o[0].type&&(clearTimeout(t.stopTimeOut),t.stopTimeOut=setTimeout(function(){me(t,n,o[0].type)},t.stopDelay)),0===m.contacts?t.moveHandler&&(h=t.moveHandler({eventSource:t,pointerType:o[0].type,position:d(o[0].currentPos,t.element),buttons:m.buttons,isTouchEvent:"touch"===o[0].type,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===h&&e.cancelEvent(n)):1===m.contacts?(t.moveHandler&&(a=m.asArray()[0],h=t.moveHandler({eventSource:t,pointerType:a.type,position:d(a.currentPos,t.element),buttons:m.buttons,isTouchEvent:"touch"===a.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===h&&e.cancelEvent(n)),t.dragHandler&&(a=m.asArray()[0],c=a.currentPos.minus(a.lastPos),h=t.dragHandler({eventSource:t,pointerType:a.type,position:d(a.currentPos,t.element),buttons:m.buttons,delta:c,speed:a.speed,direction:a.direction,shift:n.shiftKey,isTouchEvent:"touch"===a.type,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===h&&e.cancelEvent(n))):2===m.contacts&&(t.moveHandler&&(l=m.asArray(),h=t.moveHandler({eventSource:t,pointerType:l[0].type,position:d(p(l[0].currentPos,l[1].currentPos),t.element),buttons:m.buttons,isTouchEvent:"touch"===l[0].type,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===h&&e.cancelEvent(n)),t.pinchHandler&&"touch"===o[0].type&&(c=u.pinchGPoints[0].currentPos.distanceTo(u.pinchGPoints[1].currentPos),c!=u.currentPinchDist&&(u.lastPinchDist=u.currentPinchDist,u.currentPinchDist=c,u.lastPinchCenter=u.currentPinchCenter,u.currentPinchCenter=p(u.pinchGPoints[0].currentPos,u.pinchGPoints[1].currentPos),h=t.pinchHandler({eventSource:t,pointerType:"touch",gesturePoints:u.pinchGPoints,lastCenter:d(u.lastPinchCenter,t.element),center:d(u.currentPinchCenter,t.element),lastDistance:u.lastPinchDist,distance:u.currentPinchDist,shift:n.shiftKey,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),!1===h&&e.cancelEvent(n))))}function pe(e,t,i){ue(e,t,i,0),ce(e,t,i)}function me(e,t,i){e.stopHandler&&e.stopHandler({eventSource:e,pointerType:i,position:u(t,e.element),buttons:e.getActivePointersListByType(i).buttons,isTouchEvent:"touch"===i,originalEvent:t,preventDefaultAction:!1,userData:e.userData})}e.MouseTracker=function(n){t.push(this);var o=arguments;e.isPlainObject(n)||(n={element:o[0],clickTimeThreshold:o[1],clickDistThreshold:o[2]}),this.hash=Math.random(),this.element=e.getElement(n.element),this.clickTimeThreshold=n.clickTimeThreshold||e.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=n.clickDistThreshold||e.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=n.dblClickTimeThreshold||e.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=n.dblClickDistThreshold||e.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=n.userData||null,this.stopDelay=n.stopDelay||50,this.enterHandler=n.enterHandler||null,this.exitHandler=n.exitHandler||null,this.pressHandler=n.pressHandler||null,this.nonPrimaryPressHandler=n.nonPrimaryPressHandler||null,this.releaseHandler=n.releaseHandler||null,this.nonPrimaryReleaseHandler=n.nonPrimaryReleaseHandler||null,this.moveHandler=n.moveHandler||null,this.scrollHandler=n.scrollHandler||null,this.clickHandler=n.clickHandler||null,this.dblClickHandler=n.dblClickHandler||null,this.dragHandler=n.dragHandler||null,this.dragEndHandler=n.dragEndHandler||null,this.pinchHandler=n.pinchHandler||null,this.stopHandler=n.stopHandler||null,this.keyDownHandler=n.keyDownHandler||null,this.keyUpHandler=n.keyUpHandler||null,this.keyHandler=n.keyHandler||null,this.focusHandler=n.focusHandler||null,this.blurHandler=n.blurHandler||null;var r=this;i[this.hash]={click:function(e){m(r,e)},dblclick:function(e){g(r,e)},keydown:function(e){f(r,e)},keyup:function(e){v(r,e)},keypress:function(e){y(r,e)},focus:function(e){w(r,e)},blur:function(e){T(r,e)},wheel:function(e){x(r,e)},mousewheel:function(e){S(r,e)},DOMMouseScroll:function(e){S(r,e)},MozMousePixelScroll:function(e){S(r,e)},mouseenter:function(e){b(r,e)},mouseleave:function(e){R(r,e)},mouseover:function(e){P(r,e)},mouseout:function(e){O(r,e)},mousedown:function(e){I(r,e)},mouseup:function(e){L(r,e)},mouseupcaptured:function(e){H(r,e)},mousemove:function(e){B(r,e)},mousemovecaptured:function(e){A(r,e)},touchstart:function(e){F(r,e)},touchend:function(e){j(r,e)},touchendcaptured:function(e){V(r,e)},touchmove:function(e){W(r,e)},touchmovecaptured:function(e){$(r,e)},touchcancel:function(e){G(r,e)},gesturestart:function(e){Z(r,e)},gesturechange:function(e){X(r,e)},pointerover:function(e){K(r,e)},MSPointerOver:function(e){K(r,e)},pointerout:function(e){Y(r,e)},MSPointerOut:function(e){Y(r,e)},pointerdown:function(e){J(r,e)},MSPointerDown:function(e){J(r,e)},pointerup:function(e){Q(r,e)},MSPointerUp:function(e){Q(r,e)},pointermove:function(e){ie(r,e)},MSPointerMove:function(e){ie(r,e)},pointercancel:function(e){re(r,e)},MSPointerCancel:function(e){re(r,e)},pointerupcaptured:function(e){ee(r,e)},pointermovecaptured:function(e){ne(r,e)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null},n.startDisabled||this.setTracking(!0)},e.MouseTracker.prototype={destroy:function(){var e;for(r(this),this.element=null,e=0;e<t.length;e++)if(t[e]===this){t.splice(e,1);break}i[this.hash]=null,delete i[this.hash]},isTracking:function(){return i[this.hash].tracking},setTracking:function(e){return e?o(this):r(this),this},getActivePointersListsExceptType:function(e){for(var t=i[this.hash],n=[],o=0;o<t.activePointersLists.length;++o)t.activePointersLists[o].type!==e&&n.push(t.activePointersLists[o]);return n},getActivePointersListByType:function(t){var n,o,r=i[this.hash],s=r.activePointersLists.length;for(n=0;n<s;n++)if(r.activePointersLists[n].type===t)return r.activePointersLists[n];return o=new e.MouseTracker.GesturePointList(t),r.activePointersLists.push(o),o},getActivePointerCount:function(){var e,t=i[this.hash],n=t.activePointersLists.length,o=0;for(e=0;e<n;e++)o+=t.activePointersLists[e].getLength();return o},enterHandler:function(){},exitHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},e.MouseTracker.resetAllMouseTrackers=function(){for(var e=0;e<t.length;e++)t[e].isTracking()&&(t[e].setTracking(!1),t[e].setTracking(!0))},e.MouseTracker.gesturePointVelocityTracker=function(){var t=[],i=0,n=0,o=function(e,t){return e.hash.toString()+t.type+t.id.toString()},r=function(){var i,o,r,s,a,l,c=t.length,h=e.now();for(s=h-n,n=h,i=0;i<c;i++)o=t[i],r=o.gPoint,r.direction=Math.atan2(r.currentPos.y-o.lastPos.y,r.currentPos.x-o.lastPos.x),a=o.lastPos.distanceTo(r.currentPos),o.lastPos=r.currentPos,l=1e3*a/(s+1),r.speed=.75*l+.25*r.speed},s=function(s,a){var l=o(s,a);t.push({guid:l,gPoint:a,lastPos:a.currentPos}),1===t.length&&(n=e.now(),i=window.setInterval(r,50))},a=function(e,n){var r,s=o(e,n),a=t.length;for(r=0;r<a;r++)if(t[r].guid===s){t.splice(r,1),a--,0===a&&window.clearInterval(i);break}};return{addPoint:s,removePoint:a}}(),e.MouseTracker.captureElement=document,e.MouseTracker.wheelEventName=e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e.MouseTracker.supportsMouseCapture=function(){var t=document.createElement("div");return e.isFunction(t.setCapture)&&e.isFunction(t.releaseCapture)}(),e.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur",e.MouseTracker.wheelEventName],"DOMMouseScroll"==e.MouseTracker.wheelEventName&&e.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent&&(window.navigator.pointerEnabled||e.Browser.vendor!==e.BROWSERS.IE)?(e.MouseTracker.havePointerEvents=!0,e.MouseTracker.subscribeEvents.push("pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),e.MouseTracker.unprefixedPointerEvents=!0,navigator.maxTouchPoints?e.MouseTracker.maxTouchPoints=navigator.maxTouchPoints:e.MouseTracker.maxTouchPoints=0,e.MouseTracker.haveMouseEnter=!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?(e.MouseTracker.havePointerEvents=!0,e.MouseTracker.subscribeEvents.push("MSPointerOver","MSPointerOut","MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"),e.MouseTracker.unprefixedPointerEvents=!1,navigator.msMaxTouchPoints?e.MouseTracker.maxTouchPoints=navigator.msMaxTouchPoints:e.MouseTracker.maxTouchPoints=0,e.MouseTracker.haveMouseEnter=!1):(e.MouseTracker.havePointerEvents=!1,e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?(e.MouseTracker.subscribeEvents.push("mouseenter","mouseleave"),e.MouseTracker.haveMouseEnter=!0):(e.MouseTracker.subscribeEvents.push("mouseover","mouseout"),e.MouseTracker.haveMouseEnter=!1),e.MouseTracker.subscribeEvents.push("mousedown","mouseup","mousemove"),"ontouchstart"in window&&e.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&e.MouseTracker.subscribeEvents.push("gesturestart","gesturechange"),e.MouseTracker.mousePointerId="legacy-mouse",e.MouseTracker.maxTouchPoints=10),e.MouseTracker.GesturePointList=function(e){this._gPoints=[],this.type=e,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},e.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(e){return this._gPoints.push(e)},removeById:function(e){var t,i=this._gPoints.length;for(t=0;t<i;t++)if(this._gPoints[t].id===e){this._gPoints.splice(t,1);break}return this._gPoints.length},getByIndex:function(e){return e<this._gPoints.length?this._gPoints[e]:null},getById:function(e){var t,i=this._gPoints.length;for(t=0;t<i;t++)if(this._gPoints[t].id===e)return this._gPoints[t];return null},getPrimary:function(e){var t,i=this._gPoints.length;for(t=0;t<i;t++)if(this._gPoints[t].isPrimary)return this._gPoints[t];return null},addContact:function(){++this.contacts,this.contacts>1&&("mouse"===this.type||"pen"===this.type)&&(this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};var ge=function(){try{return window.self!==window.top}catch(e){return!0}}();function fe(e){try{return e.addEventListener&&e.removeEventListener}catch(t){return!1}}}(OpenSeadragon),function(e){e.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},e.Control=function(t,i,n){var o=t.parentNode;"number"===typeof i&&(e.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),i={anchor:i}),i.attachToViewer="undefined"===typeof i.attachToViewer||i.attachToViewer,this.autoFade="undefined"===typeof i.autoFade||i.autoFade,this.element=t,this.anchor=i.anchor,this.container=n,this.anchor==e.ControlAnchor.ABSOLUTE?(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top="number"==typeof i.top?i.top+"px":i.top,this.wrapper.style.left="number"==typeof i.left?i.left+"px":i.left,this.wrapper.style.height="number"==typeof i.height?i.height+"px":i.height,this.wrapper.style.width="number"==typeof i.width?i.width+"px":i.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor==e.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),i.attachToViewer?this.anchor==e.ControlAnchor.TOP_RIGHT||this.anchor==e.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):o.appendChild(this.wrapper)},e.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.container.removeChild(this.wrapper)},isVisible:function(){return"none"!=this.wrapper.style.display},setVisible:function(t){this.wrapper.style.display=t?this.anchor==e.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(t){this.element[e.SIGNAL]&&e.Browser.vendor==e.BROWSERS.IE?e.setElementOpacity(this.element,t,!0):e.setElementOpacity(this.wrapper,t,!0)}}}(OpenSeadragon),function(e){function t(e,t){var i,n=e.controls;for(i=n.length-1;i>=0;i--)if(n[i].element==t)return i;return-1}e.ControlDock=function(t){var i,n,o=["topleft","topright","bottomright","bottomleft"];for(e.extend(!0,this,{id:"controldock-"+e.now()+"-"+Math.floor(1e6*Math.random()),container:e.makeNeutralElement("div"),controls:[]},t),this.container.onsubmit=function(){return!1},this.element&&(this.element=e.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),n=0;n<o.length;n++)i=o[n],this.controls[i]=e.makeNeutralElement("div"),this.controls[i].style.position="absolute",i.match("left")&&(this.controls[i].style.left="0px"),i.match("right")&&(this.controls[i].style.right="0px"),i.match("top")&&(this.controls[i].style.top="0px"),i.match("bottom")&&(this.controls[i].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},e.ControlDock.prototype={addControl:function(i,n){i=e.getElement(i);var o=null;if(!(t(this,i)>=0)){switch(n.anchor){case e.ControlAnchor.TOP_RIGHT:o=this.controls.topright,i.style.position="relative",i.style.paddingRight="0px",i.style.paddingTop="0px";break;case e.ControlAnchor.BOTTOM_RIGHT:o=this.controls.bottomright,i.style.position="relative",i.style.paddingRight="0px",i.style.paddingBottom="0px";break;case e.ControlAnchor.BOTTOM_LEFT:o=this.controls.bottomleft,i.style.position="relative",i.style.paddingLeft="0px",i.style.paddingBottom="0px";break;case e.ControlAnchor.TOP_LEFT:o=this.controls.topleft,i.style.position="relative",i.style.paddingLeft="0px",i.style.paddingTop="0px";break;case e.ControlAnchor.ABSOLUTE:o=this.container,i.style.margin="0px",i.style.padding="0px";break;default:case e.ControlAnchor.NONE:o=this.container,i.style.margin="0px",i.style.padding="0px";break}this.controls.push(new e.Control(i,n,o)),i.style.display="inline-block"}},removeControl:function(i){i=e.getElement(i);var n=t(this,i);return n>=0&&(this.controls[n].destroy(),this.controls.splice(n,1)),this},clearControls:function(){while(this.controls.length>0)this.controls.pop().destroy();return this},areControlsEnabled:function(){var e;for(e=this.controls.length-1;e>=0;e--)if(this.controls[e].isVisible())return!0;return!1},setControlsEnabled:function(e){var t;for(t=this.controls.length-1;t>=0;t--)this.controls[t].setVisible(e);return this}}}(OpenSeadragon),function(e){e.Placement=e.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(OpenSeadragon),function(e){var t={},i=1;function n(t){return t=e.getElement(t),new e.Point(0===t.clientWidth?1:t.clientWidth,0===t.clientHeight?1:t.clientHeight)}function o(t,i,n,o,r){var s=t;if("string"==e.type(i))if(i.match(/^\s*<.*>\s*$/))i=e.parseXml(i);else if(i.match(/^\s*[\{\[].*[\}\]]\s*$/))try{var a=e.parseJSON(i);i=a}catch(c){}function l(e,t){e.ready?o(e):(e.addHandler("ready",function(){o(e)}),e.addHandler("open-failed",function(e){r({message:e.message,source:t})}))}setTimeout(function(){if("string"==e.type(i))i=new e.TileSource({url:i,crossOriginPolicy:void 0!==n.crossOriginPolicy?n.crossOriginPolicy:t.crossOriginPolicy,ajaxWithCredentials:t.ajaxWithCredentials,ajaxHeaders:t.ajaxHeaders,useCanvas:t.useCanvas,success:function(e){o(e.tileSource)}}),i.addHandler("open-failed",function(e){r(e)});else if(e.isPlainObject(i)||i.nodeType)if(void 0!==i.crossOriginPolicy||void 0===n.crossOriginPolicy&&void 0===t.crossOriginPolicy||(i.crossOriginPolicy=void 0!==n.crossOriginPolicy?n.crossOriginPolicy:t.crossOriginPolicy),void 0===i.ajaxWithCredentials&&(i.ajaxWithCredentials=t.ajaxWithCredentials),void 0===i.useCanvas&&(i.useCanvas=t.useCanvas),e.isFunction(i.getTileUrl)){var a=new e.TileSource(i);a.getTileUrl=i.getTileUrl,o(a)}else{var c=e.TileSource.determineType(s,i);if(!c)return void r({message:"Unable to load TileSource",source:i});var h=c.prototype.configure.apply(s,[i]);l(new c(h),i)}else l(i,i)})}function r(t,i){if(i instanceof e.Overlay)return i;var n=null;if(i.element)n=e.getElement(i.element);else{var o=i.id?i.id:"openseadragon-overlay-"+Math.floor(1e7*Math.random());n=e.getElement(i.id),n||(n=document.createElement("a"),n.href="#/overlay/"+o),n.id=o,e.addClass(n,i.className?i.className:"openseadragon-overlay")}var r=i.location,s=i.width,a=i.height;if(!r){var l=i.x,c=i.y;if(void 0!==i.px){var h=t.viewport.imageToViewportRectangle(new e.Rect(i.px,i.py,s||0,a||0));l=h.x,c=h.y,s=void 0!==s?h.width:void 0,a=void 0!==a?h.height:void 0}r=new e.Point(l,c)}var u=i.placement;return u&&"string"===e.type(u)&&(u=e.Placement[i.placement.toUpperCase()]),new e.Overlay({element:n,location:r,placement:u,onDraw:i.onDraw,checkResize:i.checkResize,width:s,height:a,rotationMode:i.rotationMode})}function s(e,t){var i;for(i=e.length-1;i>=0;i--)if(e[i].element===t)return i;return-1}function a(t,i){return e.requestAnimationFrame(function(){i(t)})}function l(t){e.requestAnimationFrame(function(){h(t)})}function c(t){t.autoHideControls&&(t.controlsShouldFade=!0,t.controlsFadeBeginTime=e.now()+t.controlsFadeDelay,window.setTimeout(function(){l(t)},t.controlsFadeDelay))}function h(t){var i,n,o,r;if(t.controlsShouldFade){for(i=e.now(),n=i-t.controlsFadeBeginTime,o=1-n/t.controlsFadeLength,o=Math.min(1,o),o=Math.max(0,o),r=t.controls.length-1;r>=0;r--)t.controls[r].autoFade&&t.controls[r].setOpacity(o);o>0&&l(t)}}function u(e){var t;for(e.controlsShouldFade=!1,t=e.controls.length-1;t>=0;t--)e.controls[t].setOpacity(1)}function d(){u(this)}function p(){c(this)}function m(t){var i={originalEvent:t.originalEvent,preventDefaultAction:t.preventDefaultAction,preventVerticalPan:t.preventVerticalPan,preventHorizontalPan:t.preventHorizontalPan};if(this.raiseEvent("canvas-key",i),i.preventDefaultAction||t.ctrl||t.alt||t.meta)return!0;switch(t.keyCode){case 38:return i.preventVerticalPan||(t.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 40:return i.preventVerticalPan||(t.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 37:return i.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;case 39:return i.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;default:return!0}}function g(t){var i={originalEvent:t.originalEvent,preventDefaultAction:t.preventDefaultAction,preventVerticalPan:t.preventVerticalPan,preventHorizontalPan:t.preventHorizontalPan};if(this.raiseEvent("canvas-key",i),i.preventDefaultAction||t.ctrl||t.alt||t.meta)return!0;switch(t.keyCode){case 43:case 61:return this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),!1;case 45:return this.viewport.zoomBy(.9),this.viewport.applyConstraints(),!1;case 48:return this.viewport.goHome(),this.viewport.applyConstraints(),!1;case 119:case 87:return i.preventVerticalPan||(t.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-40))),this.viewport.applyConstraints()),!1;case 115:case 83:return i.preventVerticalPan||(t.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,40))),this.viewport.applyConstraints()),!1;case 97:return i.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-40,0))),this.viewport.applyConstraints()),!1;case 100:return i.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(40,0))),this.viewport.applyConstraints()),!1;case 114:return this.viewport.flipped?this.viewport.setRotation(this.viewport.degrees-90):this.viewport.setRotation(this.viewport.degrees+90),this.viewport.applyConstraints(),!1;case 82:return this.viewport.flipped?this.viewport.setRotation(this.viewport.degrees+90):this.viewport.setRotation(this.viewport.degrees-90),this.viewport.applyConstraints(),!1;case 102:return this.viewport.toggleFlip(),!1;default:return!0}}function f(e){var t,i=document.activeElement==this.canvas;i||this.canvas.focus(),this.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x);var n={tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.raiseEvent("canvas-click",n),!n.preventDefaultAction&&this.viewport&&e.quick&&(t=this.gestureSettingsByDeviceType(e.pointerType),t.clickToZoom&&(this.viewport.zoomBy(e.shift?1/this.zoomPerClick:this.zoomPerClick,t.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints()))}function v(e){var t,i={tracker:e.eventSource,position:e.position,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.raiseEvent("canvas-double-click",i),!i.preventDefaultAction&&this.viewport&&(t=this.gestureSettingsByDeviceType(e.pointerType),t.dblClickToZoom&&(this.viewport.zoomBy(e.shift?1/this.zoomPerClick:this.zoomPerClick,t.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints()))}function y(e){var t,i={tracker:e.eventSource,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};if(this.raiseEvent("canvas-drag",i),!i.preventDefaultAction&&this.viewport){if(t=this.gestureSettingsByDeviceType(e.pointerType),this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewport.flipped&&(e.delta.x=-e.delta.x),this.constrainDuringPan){var n=this.viewport.deltaPointsFromPixels(e.delta.negate());this.viewport.centerSpringX.target.value+=n.x,this.viewport.centerSpringY.target.value+=n.y;var o=this.viewport.getBounds(),r=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=n.x,this.viewport.centerSpringY.target.value-=n.y,o.x!=r.x&&(e.delta.x=0),o.y!=r.y&&(e.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta.negate()),t.flickEnabled&&!this.constrainDuringPan)}}function w(t){if(!t.preventDefaultAction&&this.viewport){var i=this.gestureSettingsByDeviceType(t.pointerType);if(i.flickEnabled&&t.speed>=i.flickMinSpeed){var n=0;this.panHorizontal&&(n=i.flickMomentum*t.speed*Math.cos(t.direction));var o=0;this.panVertical&&(o=i.flickMomentum*t.speed*Math.sin(t.direction));var r=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),s=this.viewport.pointFromPixel(new e.Point(r.x-n,r.y-o));this.viewport.panTo(s,!1)}this.viewport.applyConstraints()}this.raiseEvent("canvas-drag-end",{tracker:t.eventSource,position:t.position,speed:t.speed,direction:t.direction,shift:t.shift,originalEvent:t.originalEvent})}function T(e){this.raiseEvent("canvas-enter",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function x(t){window.location!=window.parent.location&&e.MouseTracker.resetAllMouseTrackers(),this.raiseEvent("canvas-exit",{tracker:t.eventSource,pointerType:t.pointerType,position:t.position,buttons:t.buttons,pointers:t.pointers,insideElementPressed:t.insideElementPressed,buttonDownAny:t.buttonDownAny,originalEvent:t.originalEvent})}function S(e){this.raiseEvent("canvas-press",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function E(e){this.raiseEvent("canvas-release",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function _(e){this.raiseEvent("canvas-nonprimary-press",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function b(e){this.raiseEvent("canvas-nonprimary-release",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function P(e){var t,i,n,o;if(!e.preventDefaultAction&&this.viewport&&(t=this.gestureSettingsByDeviceType(e.pointerType),t.pinchToZoom&&(i=this.viewport.pointFromPixel(e.center,!0),n=this.viewport.pointFromPixel(e.lastCenter,!0),o=n.minus(i),this.panHorizontal||(o.x=0),this.panVertical||(o.y=0),this.viewport.zoomBy(e.distance/e.lastDistance,i,!0),t.zoomToRefPoint&&this.viewport.panBy(o,!0),this.viewport.applyConstraints()),t.pinchRotate)){var r=Math.atan2(e.gesturePoints[0].currentPos.y-e.gesturePoints[1].currentPos.y,e.gesturePoints[0].currentPos.x-e.gesturePoints[1].currentPos.x),s=Math.atan2(e.gesturePoints[0].lastPos.y-e.gesturePoints[1].lastPos.y,e.gesturePoints[0].lastPos.x-e.gesturePoints[1].lastPos.x);this.viewport.setRotation(this.viewport.getRotation()+(r-s)*(180/Math.PI))}return this.raiseEvent("canvas-pinch",{tracker:e.eventSource,gesturePoints:e.gesturePoints,lastCenter:e.lastCenter,center:e.center,lastDistance:e.lastDistance,distance:e.distance,shift:e.shift,originalEvent:e.originalEvent}),!1}function C(t){var i,n,o,r;if(o=e.now(),r=o-this._lastScrollTime,r>this.minScrollDeltaTime){if(this._lastScrollTime=o,this.viewport.flipped&&(t.position.x=this.viewport.getContainerSize().x-t.position.x),!t.preventDefaultAction&&this.viewport&&(i=this.gestureSettingsByDeviceType(t.pointerType),i.scrollToZoom&&(n=Math.pow(this.zoomPerScroll,t.scroll),this.viewport.zoomBy(n,i.zoomToRefPoint?this.viewport.pointFromPixel(t.position,!0):null),this.viewport.applyConstraints())),this.raiseEvent("canvas-scroll",{tracker:t.eventSource,position:t.position,scroll:t.scroll,shift:t.shift,originalEvent:t.originalEvent}),i&&i.scrollToZoom)return!1}else if(i=this.gestureSettingsByDeviceType(t.pointerType),i&&i.scrollToZoom)return!1}function R(e){t[this.hash].mouseInside=!0,u(this),this.raiseEvent("container-enter",{tracker:e.eventSource,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function O(e){e.pointers<1&&(t[this.hash].mouseInside=!1,t[this.hash].animating||c(this)),this.raiseEvent("container-exit",{tracker:e.eventSource,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function k(e){M(e),e.isOpen()?e._updateRequestId=a(e,k):e._updateRequestId=!1}function M(e){if(!e._opening){if(e.autoResize){var i=n(e.container),o=t[e.hash].prevContainerSize;if(!i.equals(o)){var r=e.viewport;if(e.preserveImageSizeOnResize){var s=o.x/i.x,a=r.getZoom()*s,l=r.getCenter();r.resize(i,!1),r.zoomTo(a,null,!0),r.panTo(l,!0)}else{var h=r.getBounds();r.resize(i,!0),r.fitBoundsWithConstraints(h,!0)}t[e.hash].prevContainerSize=i,t[e.hash].forceRedraw=!0}}var d=e.viewport.update(),p=e.world.update()||d;d&&e.raiseEvent("viewport-change"),e.referenceStrip&&(p=e.referenceStrip.update(e.viewport)||p),!t[e.hash].animating&&p&&(e.raiseEvent("animation-start"),u(e)),(p||t[e.hash].forceRedraw||e.world.needsDraw())&&(I(e),e._drawOverlays(),e.navigator&&e.navigator.update(e.viewport),t[e.hash].forceRedraw=!1,p&&e.raiseEvent("animation")),t[e.hash].animating&&!p&&(e.raiseEvent("animation-finish"),t[e.hash].mouseInside||c(e)),t[e.hash].animating=p}}function I(e){e.imageLoader.clear(),e.drawer.clear(),e.world.draw(),e.raiseEvent("update-viewport",{})}function L(e,t){return e?e+t:t}function H(){t[this.hash].lastZoomTime=e.now(),t[this.hash].zoomFactor=this.zoomPerSecond,t[this.hash].zooming=!0,A(this)}function D(){t[this.hash].lastZoomTime=e.now(),t[this.hash].zoomFactor=1/this.zoomPerSecond,t[this.hash].zooming=!0,A(this)}function B(){t[this.hash].zooming=!1}function A(t){e.requestAnimationFrame(e.delegate(t,z))}function z(){var i,n,o;t[this.hash].zooming&&this.viewport&&(i=e.now(),n=i-t[this.hash].lastZoomTime,o=Math.pow(t[this.hash].zoomFactor,n/1e3),this.viewport.zoomBy(o),this.viewport.applyConstraints(),t[this.hash].lastZoomTime=i,A(this))}function N(){this.viewport&&(t[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function F(){this.viewport&&(t[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function j(){this.buttons.emulateEnter(),this.buttons.emulateExit()}function V(){this.viewport&&this.viewport.goHome()}function U(){this.isFullPage()&&!e.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttons&&this.buttons.emulateExit(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function W(){if(this.viewport){var t=this.viewport.getRotation();t=this.viewport.flipped?e.positiveModulo(t+90,360):e.positiveModulo(t-90,360),this.viewport.setRotation(t)}}function $(){if(this.viewport){var t=this.viewport.getRotation();t=this.viewport.flipped?e.positiveModulo(t-90,360):e.positiveModulo(t+90,360),this.viewport.setRotation(t)}}function q(){this.viewport.toggleFlip()}function G(){var e=this._sequenceIndex-1;this.navPrevNextWrap&&e<0&&(e+=this.tileSources.length),this.goToPage(e)}function Z(){var e=this._sequenceIndex+1;this.navPrevNextWrap&&e>=this.tileSources.length&&(e=0),this.goToPage(e)}e.Viewer=function(o){var r,s=arguments,l=this;if(e.isPlainObject(o)||(o={id:s[0],xmlPath:s.length>1?s[1]:void 0,prefixUrl:s.length>2?s[2]:void 0,controls:s.length>3?s[3]:void 0,overlays:s.length>4?s[4]:void 0}),o.config&&(e.extend(!0,o,o.config),delete o.config),e.extend(!0,this,{id:o.id,hash:o.hash||i++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},e.DEFAULT_SETTINGS,o),"undefined"===typeof this.hash)throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for("undefined"!==typeof t[this.hash]&&e.console.warn("Hash "+this.hash+" has already been used."),t[this.hash]={fsBoundsDelta:new e.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._lastScrollTime=e.now(),e.EventSource.call(this),this.addHandler("open-failed",function(t){var i=e.getString("Errors.OpenFailed",t.eventSource,t.message);l._showMessage(i)}),e.ControlDock.call(this,o),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=e.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",function(e){e.width="100%",e.height="100%",e.overflow="hidden",e.position="absolute",e.top="0px",e.left="0px"}(this.canvas.style),e.setElementTouchActionNone(this.canvas),""!==o.tabIndex&&(this.canvas.tabIndex=void 0===o.tabIndex?0:o.tabIndex),this.container.className="openseadragon-container",function(e){e.width="100%",e.height="100%",e.position="relative",e.overflow="hidden",e.left="0px",e.top="0px",e.textAlign="left"}(this.container.style),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new e.MouseTracker({element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,keyDownHandler:e.delegate(this,m),keyHandler:e.delegate(this,g),clickHandler:e.delegate(this,f),dblClickHandler:e.delegate(this,v),dragHandler:e.delegate(this,y),dragEndHandler:e.delegate(this,w),enterHandler:e.delegate(this,T),exitHandler:e.delegate(this,x),pressHandler:e.delegate(this,S),releaseHandler:e.delegate(this,E),nonPrimaryPressHandler:e.delegate(this,_),nonPrimaryReleaseHandler:e.delegate(this,b),scrollHandler:e.delegate(this,C),pinchHandler:e.delegate(this,P)}),this.outerTracker=new e.MouseTracker({element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:e.delegate(this,R),exitHandler:e.delegate(this,O)}),this.toolbar&&(this.toolbar=new e.ControlDock({element:this.toolbar})),this.bindStandardControls(),t[this.hash].prevContainerSize=n(this.container),this.world=new e.World({viewer:this}),this.world.addHandler("add-item",function(e){l.source=l.world.getItemAt(0).source,t[l.hash].forceRedraw=!0,l._updateRequestId||(l._updateRequestId=a(l,k))}),this.world.addHandler("remove-item",function(e){l.world.getItemCount()?l.source=l.world.getItemAt(0).source:l.source=null,t[l.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(e){l.viewport&&l.viewport._setContentBounds(l.world.getHomeBounds(),l.world.getContentFactor())}),this.world.addHandler("item-index-change",function(e){l.source=l.world.getItemAt(0).source}),this.viewport=new e.Viewport({containerSize:t[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new e.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:o.timeout}),this.tileCache=new e.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new e.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=e.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(r=this.buttons.buttons.indexOf(this.rotateLeft),this.buttons.buttons.splice(r,1),this.buttons.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(r=this.buttons.buttons.indexOf(this.rotateRight),this.buttons.buttons.splice(r,1),this.buttons.element.removeChild(this.rotateRight.element))),this.showNavigator&&(this.navigator=new e.Navigator({id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),r=0;r<this.customControls.length;r++)this.addControl(this.customControls[r].id,{anchor:this.customControls[r].anchor});e.requestAnimationFrame(function(){c(l)})},e.extend(e.Viewer.prototype,e.EventSource.prototype,e.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(t){return e.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(t)},openTileSource:function(t){return e.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(t)},open:function(t,i){var n=this;if(this.close(),t){if(this.sequenceMode&&e.isArray(t))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),"undefined"==typeof i||isNaN(i)||(this.initialPage=i),this.tileSources=t,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),void this._updateSequenceButtons(this._sequenceIndex);if(e.isArray(t)||(t=[t]),t.length){this._opening=!0;for(var o,s=t.length,a=0,l=0,c=function(){if(a+l===s)if(a){!n._firstOpen&&n.preserveViewport||(n.viewport.goHome(!0),n.viewport.update()),n._firstOpen=!1;var e=t[0];if(e.tileSource&&(e=e.tileSource),n.overlays&&!n.preserveOverlays)for(var i=0;i<n.overlays.length;i++)n.currentOverlays[i]=r(n,n.overlays[i]);n._drawOverlays(),n._opening=!1,n.raiseEvent("open",{source:e})}else n._opening=!1,n.raiseEvent("open-failed",o)},h=function(t){e.isPlainObject(t)&&t.tileSource||(t={tileSource:t}),void 0!==t.index&&(e.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete t.index),void 0===t.collectionImmediately&&(t.collectionImmediately=!0);var i=t.success;t.success=function(e){if(a++,t.tileSource.overlays)for(var o=0;o<t.tileSource.overlays.length;o++)n.addOverlay(t.tileSource.overlays[o]);i&&i(e),c()};var r=t.error;t.error=function(e){l++,o||(o=e),r&&r(e),c()},n.addTiledImage(t)},u=0;u<t.length;u++)h(t[u]);return this}}},close:function(){return t[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),t[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(t[this.hash]){if(this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),null!==this._updateRequestId&&(e.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.removeAllHandlers(),this.element)while(this.element.firstChild)this.element.removeChild(this.element.firstChild);this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),t[this.hash]=null,delete t[this.hash],this.canvas=null,this.container=null,this.element=null}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(e){return this.innerTracker.setTracking(e),this.outerTracker.setTracking(e),this.raiseEvent("mouse-enabled",{enabled:e}),this},areControlsEnabled:function(){var e,t=this.controls.length;for(e=0;e<this.controls.length;e++)t=t&&this.controls[e].isVisibile();return t},setControlsEnabled:function(e){return e?u(this):c(this),this.raiseEvent("controls-enabled",{enabled:e}),this},setDebugMode:function(e){for(var t=0;t<this.world.getItemCount();t++)this.world.getItemAt(t).debugMode=e;this.debugMode=e,this.forceRedraw()},isFullPage:function(){return t[this.hash].fullPage},setFullPage:function(i){var n,o,r=document.body,s=r.style,a=document.documentElement.style,l=this;if(i==this.isFullPage())return this;var c={fullPage:i,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",c),c.preventDefaultAction)return this;if(i){for(this.elementSize=e.getElementSize(this.element),this.pageScroll=e.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=s.margin,this.docMargin=a.margin,s.margin="0",a.margin="0",this.bodyPadding=s.padding,this.docPadding=a.padding,s.padding="0",a.padding="0",this.bodyWidth=s.width,this.docWidth=a.width,s.width="100%",a.width="100%",this.bodyHeight=s.height,this.docHeight=a.height,s.height="100%",a.height="100%",this.previousBody=[],t[this.hash].prevElementParent=this.element.parentNode,t[this.hash].prevNextSibling=this.element.nextSibling,t[this.hash].prevElementWidth=this.element.style.width,t[this.hash].prevElementHeight=this.element.style.height,n=r.childNodes.length,o=0;o<n;o++)this.previousBody.push(r.childNodes[0]),r.removeChild(r.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,r.appendChild(this.toolbar.element),e.addClass(this.toolbar.element,"fullpage")),e.addClass(this.element,"fullpage"),r.appendChild(this.element),this.element.style.height=e.getWindowSize().y+"px",this.element.style.width=e.getWindowSize().x+"px",this.toolbar&&this.toolbar.element&&(this.element.style.height=e.getElementSize(this.element).y-e.getElementSize(this.toolbar.element).y+"px"),t[this.hash].fullPage=!0,e.delegate(this,R)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,s.margin=this.bodyMargin,a.margin=this.docMargin,s.padding=this.bodyPadding,a.padding=this.docPadding,s.width=this.bodyWidth,a.width=this.docWidth,s.height=this.bodyHeight,a.height=this.docHeight,r.removeChild(this.element),n=this.previousBody.length,o=0;o<n;o++)r.appendChild(this.previousBody.shift());e.removeClass(this.element,"fullpage"),t[this.hash].prevElementParent.insertBefore(this.element,t[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(r.removeChild(this.toolbar.element),e.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=t[this.hash].prevElementWidth,this.element.style.height=t[this.hash].prevElementHeight;var h=0,u=function(){e.setPageScroll(l.pageScroll);var t=e.getPageScroll();h++,h<10&&(t.x!==l.pageScroll.x||t.y!==l.pageScroll.y)&&e.requestAnimationFrame(u)};e.requestAnimationFrame(u),t[this.hash].fullPage=!1,e.delegate(this,O)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:i}),this},setFullScreen:function(t){var i=this;if(!e.supportsFullScreen)return this.setFullPage(t);if(e.isFullScreen()===t)return this;var n={fullScreen:t,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",n),n.preventDefaultAction)return this;if(t){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var o=function(){var t=e.isFullScreen();t||(e.removeEvent(document,e.fullScreenEventName,o),e.removeEvent(document,e.fullScreenErrorEventName,o),i.setFullPage(!1),i.isFullPage()&&(i.element.style.width=i.fullPageStyleWidth,i.element.style.height=i.fullPageStyleHeight)),i.navigator&&i.viewport&&i.navigator.update(i.viewport),i.raiseEvent("full-screen",{fullScreen:t})};e.addEvent(document,e.fullScreenEventName,o),e.addEvent(document,e.fullScreenErrorEventName,o),e.requestFullScreen(document.body)}else e.exitFullScreen();return this},isVisible:function(){return"hidden"!=this.container.style.visibility},setVisible:function(e){return this.container.style.visibility=e?"":"hidden",this.raiseEvent("visible",{visible:e}),this},addTiledImage:function(t){e.console.assert(t,"[Viewer.addTiledImage] options is required"),e.console.assert(t.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),e.console.assert(!t.replace||t.index>-1&&t.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var i=this;t.replace&&(t.replaceItem=i.world.getItemAt(t.index)),this._hideMessage(),void 0===t.placeholderFillStyle&&(t.placeholderFillStyle=this.placeholderFillStyle),void 0===t.opacity&&(t.opacity=this.opacity),void 0===t.preload&&(t.preload=this.preload),void 0===t.compositeOperation&&(t.compositeOperation=this.compositeOperation),void 0===t.crossOriginPolicy&&(t.crossOriginPolicy=void 0!==t.tileSource.crossOriginPolicy?t.tileSource.crossOriginPolicy:this.crossOriginPolicy),void 0===t.ajaxWithCredentials&&(t.ajaxWithCredentials=this.ajaxWithCredentials),void 0===t.loadTilesWithAjax&&(t.loadTilesWithAjax=this.loadTilesWithAjax),void 0===t.ajaxHeaders||null===t.ajaxHeaders?t.ajaxHeaders=this.ajaxHeaders:e.isPlainObject(t.ajaxHeaders)&&e.isPlainObject(this.ajaxHeaders)&&(t.ajaxHeaders=e.extend({},this.ajaxHeaders,t.ajaxHeaders));var n={options:t};function r(e){for(var o=0;o<i._loadQueue.length;o++)if(i._loadQueue[o]===n){i._loadQueue.splice(o,1);break}0===i._loadQueue.length&&s(n),i.raiseEvent("add-item-failed",e),t.error&&t.error(e)}function s(e){i.collectionMode&&(i.world.arrange({immediately:e.options.collectionImmediately,rows:i.collectionRows,columns:i.collectionColumns,layout:i.collectionLayout,tileSize:i.collectionTileSize,tileMargin:i.collectionTileMargin}),i.world.setAutoRefigureSizes(!0))}function a(){var t,n,o;while(i._loadQueue.length){if(t=i._loadQueue[0],!t.tileSource)break;if(i._loadQueue.splice(0,1),t.options.replace){var r=i.world.getIndexOfItem(t.options.replaceItem);-1!=r&&(t.options.index=r),i.world.removeItem(t.options.replaceItem)}n=new e.TiledImage({viewer:i,source:t.tileSource,viewport:i.viewport,drawer:i.drawer,tileCache:i.tileCache,imageLoader:i.imageLoader,x:t.options.x,y:t.options.y,width:t.options.width,height:t.options.height,fitBounds:t.options.fitBounds,fitBoundsPlacement:t.options.fitBoundsPlacement,clip:t.options.clip,placeholderFillStyle:t.options.placeholderFillStyle,opacity:t.options.opacity,preload:t.options.preload,degrees:t.options.degrees,compositeOperation:t.options.compositeOperation,springStiffness:i.springStiffness,animationTime:i.animationTime,minZoomImageRatio:i.minZoomImageRatio,wrapHorizontal:i.wrapHorizontal,wrapVertical:i.wrapVertical,immediateRender:i.immediateRender,blendTime:i.blendTime,alwaysBlend:i.alwaysBlend,minPixelRatio:i.minPixelRatio,smoothTileEdgesMinZoom:i.smoothTileEdgesMinZoom,iOSDevice:i.iOSDevice,crossOriginPolicy:t.options.crossOriginPolicy,ajaxWithCredentials:t.options.ajaxWithCredentials,loadTilesWithAjax:t.options.loadTilesWithAjax,ajaxHeaders:t.options.ajaxHeaders,debugMode:i.debugMode}),i.collectionMode&&i.world.setAutoRefigureSizes(!1),i.world.addItem(n,{index:t.options.index}),0===i._loadQueue.length&&s(t),1!==i.world.getItemCount()||i.preserveViewport||i.viewport.goHome(!0),i.navigator&&(o=e.extend({},t.options,{replace:!1,originalTiledImage:n,tileSource:t.tileSource}),i.navigator.addTiledImage(o)),t.options.success&&t.options.success({item:n})}}e.isArray(t.tileSource)?setTimeout(function(){r({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:t.tileSource,options:t})}):(this._loadQueue.push(n),o(this,t.tileSource,t,function(e){n.tileSource=e,a()},function(e){e.options=t,r(e),a()}))},addSimpleImage:function(t){e.console.assert(t,"[Viewer.addSimpleImage] options is required"),e.console.assert(t.url,"[Viewer.addSimpleImage] options.url is required");var i=e.extend({},t,{tileSource:{type:"image",url:t.url}});delete i.url,this.addTiledImage(i)},addLayer:function(t){var i=this;e.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var n=e.extend({},t,{success:function(e){i.raiseEvent("add-layer",{options:t,drawer:e.item})},error:function(e){i.raiseEvent("add-layer-failed",e)}});return this.addTiledImage(n),this},getLayerAtLevel:function(t){return e.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(t)},getLevelOfLayer:function(t){return e.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(t)},getLayersCount:function(){return e.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(t,i){return e.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(t,i)},removeLayer:function(t){return e.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(t)},forceRedraw:function(){return t[this.hash].forceRedraw=!0,this},bindSequenceControls:function(){var t=e.delegate(this,d),i=e.delegate(this,p),n=e.delegate(this,Z),o=e.delegate(this,G),r=this.navImages,s=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(s=!1),this.previousButton=new e.Button({element:this.previousButton?e.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.PreviousPage"),srcRest:L(this.prefixUrl,r.previous.REST),srcGroup:L(this.prefixUrl,r.previous.GROUP),srcHover:L(this.prefixUrl,r.previous.HOVER),srcDown:L(this.prefixUrl,r.previous.DOWN),onRelease:o,onFocus:t,onBlur:i}),this.nextButton=new e.Button({element:this.nextButton?e.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.NextPage"),srcRest:L(this.prefixUrl,r.next.REST),srcGroup:L(this.prefixUrl,r.next.GROUP),srcHover:L(this.prefixUrl,r.next.HOVER),srcDown:L(this.prefixUrl,r.next.DOWN),onRelease:n,onFocus:t,onBlur:i}),this.navPrevNextWrap||this.previousButton.disable(),this.tileSources&&this.tileSources.length||this.nextButton.disable(),s&&(this.paging=new e.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:e.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||e.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var t=e.delegate(this,H),i=e.delegate(this,B),n=e.delegate(this,N),o=e.delegate(this,D),r=e.delegate(this,F),s=e.delegate(this,V),a=e.delegate(this,U),l=e.delegate(this,W),c=e.delegate(this,$),h=e.delegate(this,q),u=e.delegate(this,d),m=e.delegate(this,p),g=this.navImages,f=[],v=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(v=!1),this.showZoomControl&&(f.push(this.zoomInButton=new e.Button({element:this.zoomInButton?e.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomIn"),srcRest:L(this.prefixUrl,g.zoomIn.REST),srcGroup:L(this.prefixUrl,g.zoomIn.GROUP),srcHover:L(this.prefixUrl,g.zoomIn.HOVER),srcDown:L(this.prefixUrl,g.zoomIn.DOWN),onPress:t,onRelease:i,onClick:n,onEnter:t,onExit:i,onFocus:u,onBlur:m})),f.push(this.zoomOutButton=new e.Button({element:this.zoomOutButton?e.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomOut"),srcRest:L(this.prefixUrl,g.zoomOut.REST),srcGroup:L(this.prefixUrl,g.zoomOut.GROUP),srcHover:L(this.prefixUrl,g.zoomOut.HOVER),srcDown:L(this.prefixUrl,g.zoomOut.DOWN),onPress:o,onRelease:i,onClick:r,onEnter:o,onExit:i,onFocus:u,onBlur:m}))),this.showHomeControl&&f.push(this.homeButton=new e.Button({element:this.homeButton?e.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Home"),srcRest:L(this.prefixUrl,g.home.REST),srcGroup:L(this.prefixUrl,g.home.GROUP),srcHover:L(this.prefixUrl,g.home.HOVER),srcDown:L(this.prefixUrl,g.home.DOWN),onRelease:s,onFocus:u,onBlur:m})),this.showFullPageControl&&f.push(this.fullPageButton=new e.Button({element:this.fullPageButton?e.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.FullPage"),srcRest:L(this.prefixUrl,g.fullpage.REST),srcGroup:L(this.prefixUrl,g.fullpage.GROUP),srcHover:L(this.prefixUrl,g.fullpage.HOVER),srcDown:L(this.prefixUrl,g.fullpage.DOWN),onRelease:a,onFocus:u,onBlur:m})),this.showRotationControl&&(f.push(this.rotateLeftButton=new e.Button({element:this.rotateLeftButton?e.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateLeft"),srcRest:L(this.prefixUrl,g.rotateleft.REST),srcGroup:L(this.prefixUrl,g.rotateleft.GROUP),srcHover:L(this.prefixUrl,g.rotateleft.HOVER),srcDown:L(this.prefixUrl,g.rotateleft.DOWN),onRelease:l,onFocus:u,onBlur:m})),f.push(this.rotateRightButton=new e.Button({element:this.rotateRightButton?e.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateRight"),srcRest:L(this.prefixUrl,g.rotateright.REST),srcGroup:L(this.prefixUrl,g.rotateright.GROUP),srcHover:L(this.prefixUrl,g.rotateright.HOVER),srcDown:L(this.prefixUrl,g.rotateright.DOWN),onRelease:c,onFocus:u,onBlur:m}))),this.showFlipControl&&f.push(this.flipButton=new e.Button({element:this.flipButton?e.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Flip"),srcRest:L(this.prefixUrl,g.flip.REST),srcGroup:L(this.prefixUrl,g.flip.GROUP),srcHover:L(this.prefixUrl,g.flip.HOVER),srcDown:L(this.prefixUrl,g.flip.DOWN),onRelease:h,onFocus:u,onBlur:m})),v&&(this.buttons=new e.ButtonGroup({buttons:f,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttons.element,this.addHandler("open",e.delegate(this,j)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT}))),this},currentPage:function(){return this._sequenceIndex},goToPage:function(e){return this.tileSources&&e>=0&&e<this.tileSources.length&&(this._sequenceIndex=e,this._updateSequenceButtons(e),this.open(this.tileSources[e]),this.referenceStrip&&this.referenceStrip.setFocus(e),this.raiseEvent("page",{page:e})),this},addOverlay:function(t,i,n,o){var a;if(a=e.isPlainObject(t)?t:{element:t,location:i,placement:n,onDraw:o},t=e.getElement(a.element),s(this.currentOverlays,t)>=0)return this;var l=r(this,a);return this.currentOverlays.push(l),l.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:t,location:a.location,placement:a.placement}),this},updateOverlay:function(i,n,o){var r;return i=e.getElement(i),r=s(this.currentOverlays,i),r>=0&&(this.currentOverlays[r].update(n,o),t[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:i,location:n,placement:o})),this},removeOverlay:function(i){var n;return i=e.getElement(i),n=s(this.currentOverlays,i),n>=0&&(this.currentOverlays[n].destroy(),this.currentOverlays.splice(n,1),t[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:i})),this},clearOverlays:function(){while(this.currentOverlays.length>0)this.currentOverlays.pop().destroy();return t[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(t){var i;return t=e.getElement(t),i=s(this.currentOverlays,t),i>=0?this.currentOverlays[i]:null},_updateSequenceButtons:function(e){this.nextButton&&(this.tileSources&&this.tileSources.length-1!==e?this.nextButton.enable():this.navPrevNextWrap||this.nextButton.disable()),this.previousButton&&(e>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(t){this._hideMessage();var i=e.makeNeutralElement("div");i.appendChild(document.createTextNode(t)),this.messageDiv=e.makeCenteredNode(i),e.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var e=this.messageDiv;e&&(e.parentNode.removeChild(e),delete this.messageDiv)},gestureSettingsByDeviceType:function(e){switch(e){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var e,t=this.currentOverlays.length;for(e=0;e<t;e++)this.currentOverlays[e].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new e.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else e.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')}})}(OpenSeadragon),function(e){function t(e){var t={tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};if(this.viewer.raiseEvent("navigator-click",t),!t.preventDefaultAction&&e.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x);var i=this.viewport.pointFromPixel(e.position);this.panVertical?this.panHorizontal||(i.x=this.viewer.viewport.getCenter(!0).x):i.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(i),this.viewer.viewport.applyConstraints()}}function i(e){var t={tracker:e.eventSource,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.viewer.raiseEvent("navigator-drag",t),!t.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewer.viewport.flipped&&(e.delta.x=-e.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function n(e){e.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function o(e){return this.viewer.raiseEvent("navigator-scroll",{tracker:e.eventSource,position:e.position,scroll:e.scroll,shift:e.shift,originalEvent:e.originalEvent}),!1}function r(e,t){s(e,"rotate("+t+"deg)")}function s(e,t){e.style.webkitTransform=t,e.style.mozTransform=t,e.style.msTransform=t,e.style.oTransform=t,e.style.transform=t}e.Navigator=function(s){var a,l,c=s.viewer,h=this;function u(e){r(h.displayRegionContainer,e),r(h.displayRegion,-e),h.viewport.setRotation(e)}if(s.id?(this.element=document.getElementById(s.id),s.controlOptions={anchor:e.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(s.id="navigator-"+e.now(),this.element=e.makeNeutralElement("div"),s.controlOptions={anchor:e.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:s.autoFade},s.position&&("BOTTOM_RIGHT"==s.position?s.controlOptions.anchor=e.ControlAnchor.BOTTOM_RIGHT:"BOTTOM_LEFT"==s.position?s.controlOptions.anchor=e.ControlAnchor.BOTTOM_LEFT:"TOP_RIGHT"==s.position?s.controlOptions.anchor=e.ControlAnchor.TOP_RIGHT:"TOP_LEFT"==s.position?s.controlOptions.anchor=e.ControlAnchor.TOP_LEFT:"ABSOLUTE"==s.position&&(s.controlOptions.anchor=e.ControlAnchor.ABSOLUTE,s.controlOptions.top=s.top,s.controlOptions.left=s.left,s.controlOptions.height=s.height,s.controlOptions.width=s.width))),this.element.id=s.id,this.element.className+=" navigator",s=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.navigatorSizeRatio},s,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,autoResize:s.autoResize,minZoomImageRatio:1,background:s.background,opacity:s.opacity,borderColor:s.borderColor,displayRegionColor:s.displayRegionColor}),s.minPixelRatio=this.minPixelRatio=c.minPixelRatio,e.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new e.Point(1,1),this.totalBorderWidths=new e.Point(2*this.borderWidth,2*this.borderWidth).minus(this.fudge),s.controlOptions.anchor!=e.ControlAnchor.NONE&&function(e,t){e.margin="0px",e.border=t+"px solid "+s.borderColor,e.padding="0px",e.background=s.background,e.opacity=s.opacity,e.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=e.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(e,t){e.position="relative",e.top="0px",e.left="0px",e.fontSize="0px",e.overflow="hidden",e.border=t+"px solid "+s.displayRegionColor,e.margin="0px",e.padding="0px",e.background="transparent",e["float"]="left",e.cssFloat="left",e.styleFloat="left",e.zIndex=999999999,e.cursor="default"}(this.displayRegion.style,this.borderWidth),this.displayRegionContainer=e.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",c.addControl(this.element,s.controlOptions),this._resizeWithViewer=s.controlOptions.anchor!=e.ControlAnchor.ABSOLUTE&&s.controlOptions.anchor!=e.ControlAnchor.NONE,this._resizeWithViewer&&(s.width&&s.height?(this.element.style.height="number"==typeof s.height?s.height+"px":s.height,this.element.style.width="number"==typeof s.width?s.width+"px":s.width):(a=e.getElementSize(c.element),this.element.style.height=Math.round(a.y*s.sizeRatio)+"px",this.element.style.width=Math.round(a.x*s.sizeRatio)+"px",this.oldViewerSize=a),l=e.getElementSize(this.element),this.elementArea=l.x*l.y),this.oldContainerSize=new e.Point(0,0),e.Viewer.apply(this,[s]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer),s.navigatorRotate){var d=s.viewer.viewport?s.viewer.viewport.getRotation():s.viewer.degrees||0;u(d),s.viewer.addHandler("rotate",function(e){u(e.degrees)})}this.innerTracker.destroy(),this.innerTracker=new e.MouseTracker({element:this.element,dragHandler:e.delegate(this,i),clickHandler:e.delegate(this,t),releaseHandler:e.delegate(this,n),scrollHandler:e.delegate(this,o)}),this.addHandler("reset-size",function(){h.viewport&&h.viewport.goHome(!0)}),c.world.addHandler("item-index-change",function(e){window.setTimeout(function(){var t=h.world.getItemAt(e.previousIndex);h.world.setItemIndex(t,e.newIndex)},1)}),c.world.addHandler("remove-item",function(e){var t=e.item,i=h._getMatchingItem(t);i&&h.world.removeItem(i)}),this.update(c.viewport)},e.extend(e.Navigator.prototype,e.EventSource.prototype,e.Viewer.prototype,{updateSize:function(){if(this.viewport){var t=new e.Point(0===this.container.clientWidth?1:this.container.clientWidth,0===this.container.clientHeight?1:this.container.clientHeight);t.equals(this.oldContainerSize)||(this.viewport.resize(t,!0),this.viewport.goHome(!0),this.oldContainerSize=t,this.drawer.clear(),this.world.draw())}},setFlip:function(e){return this.viewport.setFlip(e),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(e){s(this.displayRegion,e),s(this.canvas,e),s(this.element,e)},update:function(t){var i,n,o,r,s,a;if(i=e.getElementSize(this.viewer.element),this._resizeWithViewer&&i.x&&i.y&&!i.equals(this.oldViewerSize)&&(this.oldViewerSize=i,this.maintainSizeRatio||!this.elementArea?(n=i.x*this.sizeRatio,o=i.y*this.sizeRatio):(n=Math.sqrt(this.elementArea*(i.x/i.y)),o=this.elementArea/n),this.element.style.width=Math.round(n)+"px",this.element.style.height=Math.round(o)+"px",this.elementArea||(this.elementArea=n*o),this.updateSize()),t&&this.viewport){r=t.getBoundsNoRotate(!0),s=this.viewport.pixelFromPointNoRotate(r.getTopLeft(),!1),a=this.viewport.pixelFromPointNoRotate(r.getBottomRight(),!1).minus(this.totalBorderWidths);var l=this.displayRegion.style;l.display=this.world.getItemCount()?"block":"none",l.top=Math.round(s.y)+"px",l.left=Math.round(s.x)+"px";var c=Math.abs(s.x-a.x),h=Math.abs(s.y-a.y);l.width=Math.round(Math.max(c,0))+"px",l.height=Math.round(Math.max(h,0))+"px"}},addTiledImage:function(t){var i=this,n=t.originalTiledImage;delete t.original;var o=e.extend({},t,{success:function(e){var t=e.item;function o(){i._matchBounds(t,n)}function r(){i._matchOpacity(t,n)}function s(){i._matchCompositeOperation(t,n)}t._originalForNavigator=n,i._matchBounds(t,n,!0),n.addHandler("bounds-change",o),n.addHandler("clip-change",o),n.addHandler("opacity-change",r),n.addHandler("composite-operation-change",s)}});return e.Viewer.prototype.addTiledImage.apply(this,[o])},_getMatchingItem:function(e){for(var t,i=this.world.getItemCount(),n=0;n<i;n++)if(t=this.world.getItemAt(n),t._originalForNavigator===e)return t;return null},_matchBounds:function(e,t,i){var n=t.getBoundsNoRotate();e.setPosition(n.getTopLeft(),i),e.setWidth(n.width,i),e.setRotation(t.getRotation(),i),e.setClip(t.getClip())},_matchOpacity:function(e,t){e.setOpacity(t.opacity)},_matchCompositeOperation:function(e,t){e.setCompositeOperation(t.compositeOperation)}})}(OpenSeadragon),function(e){var t={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};e.extend(e,{getString:function(i){var n,o=i.split("."),r=null,s=arguments,a=t;for(n=0;n<o.length-1;n++)a=a[o[n]]||{};return r=a[o[n]],"string"!=typeof r&&(e.console.log("Untranslated source string:",i),r=""),r.replace(/\{\d+\}/g,function(e){var t=parseInt(e.match(/\d+/),10)+1;return t<s.length?s[t]:""})},setString:function(e,i){var n,o=e.split("."),r=t;for(n=0;n<o.length-1;n++)r[o[n]]||(r[o[n]]={}),r=r[o[n]];r[o[n]]=i}})}(OpenSeadragon),function(e){e.Point=function(e,t){this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0},e.Point.prototype={clone:function(){return new e.Point(this.x,this.y)},plus:function(t){return new e.Point(this.x+t.x,this.y+t.y)},minus:function(t){return new e.Point(this.x-t.x,this.y-t.y)},times:function(t){return new e.Point(this.x*t,this.y*t)},divide:function(t){return new e.Point(this.x/t,this.y/t)},negate:function(){return new e.Point(-this.x,-this.y)},distanceTo:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},squaredDistanceTo:function(e){return Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2)},apply:function(t){return new e.Point(t(this.x),t(this.y))},equals:function(t){return t instanceof e.Point&&this.x===t.x&&this.y===t.y},rotate:function(t,i){var n,o;if(i=i||new e.Point(0,0),t%90===0){var r=e.positiveModulo(t,360);switch(r){case 0:n=1,o=0;break;case 90:n=0,o=1;break;case 180:n=-1,o=0;break;case 270:n=0,o=-1;break}}else{var s=t*Math.PI/180;n=Math.cos(s),o=Math.sin(s)}var a=n*(this.x-i.x)-o*(this.y-i.y)+i.x,l=o*(this.x-i.x)+n*(this.y-i.y)+i.y;return new e.Point(a,l)},toString:function(){return"("+Math.round(100*this.x)/100+","+Math.round(100*this.y)/100+")"}}}(OpenSeadragon),function(e){function t(t){var i,n,o=t.responseText,r=t.status;if(!t)throw new Error(e.getString("Errors.Security"));if(200!==t.status&&0!==t.status)throw r=t.status,i=404==r?"Not Found":t.statusText,new Error(e.getString("Errors.Status",r,i));if(o.match(/\s*<.*/))try{n=t.responseXML&&t.responseXML.documentElement?t.responseXML:e.parseXml(o)}catch(s){n=t.responseText}else if(o.match(/\s*[\{\[].*/))try{n=e.parseJSON(o)}catch(s){n=o}else n=o;return n}e.TileSource=function(t,i,n,o,r,s){var a,l,c=this,h=arguments;if(a=e.isPlainObject(t)?t:{width:h[0],height:h[1],tileSize:h[2],tileOverlap:h[3],minLevel:h[4],maxLevel:h[5]},e.EventSource.call(this),e.extend(!0,this,a),!this.success)for(l=0;l<arguments.length;l++)if(e.isFunction(arguments[l])){this.success=arguments[l];break}this.success&&this.addHandler("ready",function(e){c.success(e)}),"string"==e.type(arguments[0])&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new e.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=a.width&&a.height?a.width/a.height:1,this.dimensions=new e.Point(a.width,a.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=a.tileOverlap?a.tileOverlap:0,this.minLevel=a.minLevel?a.minLevel:0,this.maxLevel=void 0!==a.maxLevel&&null!==a.maxLevel?a.maxLevel:a.width&&a.height?Math.ceil(Math.log(Math.max(a.width,a.height))/Math.log(2)):0,this.success&&e.isFunction(this.success)&&this.success(this))},e.TileSource.prototype={getTileSize:function(t){return e.console.error("[TileSource.getTileSize] is deprecated.Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(e){return this._tileWidth?this._tileWidth:this.getTileSize(e)},getTileHeight:function(e){return this._tileHeight?this._tileHeight:this.getTileSize(e)},getLevelScale:function(e){var t,i={};for(t=0;t<=this.maxLevel;t++)i[t]=1/Math.pow(2,this.maxLevel-t);return this.getLevelScale=function(e){return i[e]},this.getLevelScale(e)},getNumTiles:function(t){var i=this.getLevelScale(t),n=Math.ceil(i*this.dimensions.x/this.getTileWidth(t)),o=Math.ceil(i*this.dimensions.y/this.getTileHeight(t));return new e.Point(n,o)},getPixelRatio:function(t){var i=this.dimensions.times(this.getLevelScale(t)),n=1/i.x,o=1/i.y;return new e.Point(n,o)},getClosestLevel:function(){var e,t;for(e=this.minLevel+1;e<=this.maxLevel;e++)if(t=this.getNumTiles(e),t.x>1||t.y>1)break;return e-1},getTileAtPoint:function(t,i){var n=i.x>=0&&i.x<=1&&i.y>=0&&i.y<=1/this.aspectRatio;e.console.assert(n,"[TileSource.getTileAtPoint] must be called with a valid point.");var o=this.dimensions.x*this.getLevelScale(t),r=i.x*o,s=i.y*o,a=Math.floor(r/this.getTileWidth(t)),l=Math.floor(s/this.getTileHeight(t));i.x>=1&&(a=this.getNumTiles(t).x-1);var c=1e-15;return i.y>=1/this.aspectRatio-c&&(l=this.getNumTiles(t).y-1),new e.Point(a,l)},getTileBounds:function(t,i,n,o){var r=this.dimensions.times(this.getLevelScale(t)),s=this.getTileWidth(t),a=this.getTileHeight(t),l=0===i?0:s*i-this.tileOverlap,c=0===n?0:a*n-this.tileOverlap,h=s+(0===i?1:2)*this.tileOverlap,u=a+(0===n?1:2)*this.tileOverlap,d=1/r.x;return h=Math.min(h,r.x-l),u=Math.min(u,r.y-c),o?new e.Rect(0,0,h,u):new e.Rect(l*d,c*d,h*d,u*d)},getImageInfo:function(i){var n,o,r,s,a,l,c,h=this;i&&(a=i.split("/"),l=a[a.length-1],c=l.lastIndexOf("."),c>-1&&(a[a.length-1]=l.slice(0,c))),o=function(t){"string"===typeof t&&(t=e.parseXml(t));var n=e.TileSource.determineType(h,t,i);n?(s=n.prototype.configure.apply(h,[t,i]),void 0===s.ajaxWithCredentials&&(s.ajaxWithCredentials=h.ajaxWithCredentials),r=new n(s),h.ready=!0,h.raiseEvent("ready",{tileSource:r})):h.raiseEvent("open-failed",{message:"Unable to load TileSource",source:i})},i.match(/\.js$/)?(n=i.split("/").pop().replace(".js",""),e.jsonp({url:i,async:!1,callbackName:n,callback:o})):e.makeAjaxRequest({url:i,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(e){var i=t(e);o(i)},error:function(e,t){var n;try{n="HTTP "+e.status+" attempting to load TileSource"}catch(r){var o;o="undefined"!=typeof t&&t.toString?t.toString():"Unknown error",n=o+" attempting to load TileSource"}h.raiseEvent("open-failed",{message:n,source:i})}})},supports:function(e,t){return!1},configure:function(e,t){throw new Error("Method not implemented.")},getTileUrl:function(e,t,i){throw new Error("Method not implemented.")},getTileAjaxHeaders:function(e,t,i){return{}},tileExists:function(e,t,i){var n=this.getNumTiles(e);return e>=this.minLevel&&e<=this.maxLevel&&t>=0&&i>=0&&t<n.x&&i<n.y}},e.extend(!0,e.TileSource.prototype,e.EventSource.prototype),e.TileSource.determineType=function(t,i,n){var o;for(o in OpenSeadragon)if(o.match(/.+TileSource$/)&&e.isFunction(OpenSeadragon[o])&&e.isFunction(OpenSeadragon[o].prototype.supports)&&OpenSeadragon[o].prototype.supports.call(t,i,n))return OpenSeadragon[o];e.console.error("No TileSource was able to open %s %s",n,i)}}(OpenSeadragon),function(e){function t(t,n){if(!n||!n.documentElement)throw new Error(e.getString("Errors.Xml"));var o,r,s,a,l,c=n.documentElement,h=c.localName||c.tagName,u=n.documentElement.namespaceURI,d=null,p=[];if("Image"==h)try{if(a=c.getElementsByTagName("Size")[0],void 0===a&&(a=c.getElementsByTagNameNS(u,"Size")[0]),d={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:c.getAttribute("Url"),Format:c.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(c.getAttribute("Overlap"),10),TileSize:parseInt(c.getAttribute("TileSize"),10),Size:{Height:parseInt(a.getAttribute("Height"),10),Width:parseInt(a.getAttribute("Width"),10)}}},!e.imageFormatSupported(d.Image.Format))throw new Error(e.getString("Errors.ImageFormat",d.Image.Format.toUpperCase()));for(o=c.getElementsByTagName("DisplayRect"),void 0===o&&(o=c.getElementsByTagNameNS(u,"DisplayRect")[0]),l=0;l<o.length;l++)r=o[l],s=r.getElementsByTagName("Rect")[0],void 0===s&&(s=r.getElementsByTagNameNS(u,"Rect")[0]),p.push({Rect:{X:parseInt(s.getAttribute("X"),10),Y:parseInt(s.getAttribute("Y"),10),Width:parseInt(s.getAttribute("Width"),10),Height:parseInt(s.getAttribute("Height"),10),MinLevel:parseInt(r.getAttribute("MinLevel"),10),MaxLevel:parseInt(r.getAttribute("MaxLevel"),10)}});return p.length&&(d.Image.DisplayRect=p),i(t,d)}catch(f){throw f instanceof Error?f:new Error(e.getString("Errors.Dzi"))}else{if("Collection"==h)throw new Error(e.getString("Errors.Dzc"));if("Error"==h){var m=c.getElementsByTagName("Message")[0],g=m.firstChild.nodeValue;throw new Error(g)}}throw new Error(e.getString("Errors.Dzi"))}function i(t,i){var n,o,r=i.Image,s=r.Url,a=r.Format,l=r.Size,c=r.DisplayRect||[],h=parseInt(l.Width,10),u=parseInt(l.Height,10),d=parseInt(r.TileSize,10),p=parseInt(r.Overlap,10),m=[];for(o=0;o<c.length;o++)n=c[o].Rect,m.push(new e.DisplayRect(parseInt(n.X,10),parseInt(n.Y,10),parseInt(n.Width,10),parseInt(n.Height,10),parseInt(n.MinLevel,10),parseInt(n.MaxLevel,10)));return e.extend(!0,{width:h,height:u,tileSize:d,tileOverlap:p,minLevel:null,maxLevel:null,tilesUrl:s,fileFormat:a,displayRects:m},i)}e.DziTileSource=function(t,i,n,o,r,s,a,l,c){var h,u,d,p;if(p=e.isPlainObject(t)?t:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=p.tilesUrl,this.fileFormat=p.fileFormat,this.displayRects=p.displayRects,this.displayRects)for(h=this.displayRects.length-1;h>=0;h--)for(u=this.displayRects[h],d=u.minLevel;d<=u.maxLevel;d++)this._levelRects[d]||(this._levelRects[d]=[]),this._levelRects[d].push(u);e.TileSource.apply(this,[p])},e.extend(e.DziTileSource.prototype,e.TileSource.prototype,{supports:function(e,t){var i;return e.Image?i=e.Image.xmlns:e.documentElement&&("Image"!=e.documentElement.localName&&"Image"!=e.documentElement.tagName||(i=e.documentElement.namespaceURI)),i=(i||"").toLowerCase(),-1!==i.indexOf("schemas.microsoft.com/deepzoom/2008")||-1!==i.indexOf("schemas.microsoft.com/deepzoom/2009")},configure:function(n,o){var r;return r=e.isPlainObject(n)?i(this,n):t(this,n),o&&!r.tilesUrl&&(r.tilesUrl=o.replace(/([^\/]+?)(\.(dzi|xml|js)?(\?[^\/]*)?)?\/?$/,"$1_files/"),-1!=o.search(/\.(dzi|xml|js)\?/)?r.queryParams=o.match(/\?.*/):r.queryParams=""),r},getTileUrl:function(e,t,i){return[this.tilesUrl,e,"/",t,"_",i,".",this.fileFormat,this.queryParams].join("")},tileExists:function(e,t,i){var n,o,r,s,a,l,c,h=this._levelRects[e];if(this.minLevel&&e<this.minLevel||this.maxLevel&&e>this.maxLevel)return!1;if(!h||!h.length)return!0;for(c=h.length-1;c>=0;c--)if(n=h[c],!(e<n.minLevel||e>n.maxLevel)&&(o=this.getLevelScale(e),r=n.x*o,s=n.y*o,a=r+n.width*o,l=s+n.height*o,r=Math.floor(r/this._tileWidth),s=Math.floor(s/this._tileWidth),a=Math.ceil(a/this._tileWidth),l=Math.ceil(l/this._tileWidth),r<=t&&t<a&&s<=i&&i<l))return!0;return!1}})}(OpenSeadragon),function(e){function t(e){var t=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json"],i=-1!=t.indexOf(e[0]);return!i||-1!=e.indexOf("sizeByW")}function i(e){for(var t=[],i=0;i<e.sizes.length;i++)t.push({url:e["@id"]+"/full/"+e.sizes[i].width+",/0/default.jpg",width:e.sizes[i].width,height:e.sizes[i].height});return t.sort(function(e,t){return e.width-t.width})}function n(t){if(!t||!t.documentElement)throw new Error(e.getString("Errors.Xml"));var i=t.documentElement,n=i.tagName,r=null;if("info"==n)try{return r={},o(i,r),r}catch(s){throw s instanceof Error?s:new Error(e.getString("Errors.IIIF"))}throw new Error(e.getString("Errors.IIIF"))}function o(t,i,n){var r,s;if(3==t.nodeType&&n)s=t.nodeValue.trim(),s.match(/^\d*$/)&&(s=Number(s)),i[n]?(e.isArray(i[n])||(i[n]=[i[n]]),i[n].push(s)):i[n]=s;else if(1==t.nodeType)for(r=0;r<t.childNodes.length;r++)o(t.childNodes[r],i,t.nodeName)}e.IIIFTileSource=function(n){if(e.extend(!0,this,n),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(n.tileSizePerScaleFactor={},this.tile_width&&this.tile_height)n.tileWidth=this.tile_width,n.tileHeight=this.tile_height;else if(this.tile_width)n.tileSize=this.tile_width;else if(this.tile_height)n.tileSize=this.tile_height;else if(this.tiles)if(1==this.tiles.length)n.tileWidth=this.tiles[0].width,n.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var o=0;o<this.tiles.length;o++)for(var r=0;r<this.tiles[o].scaleFactors.length;r++){var s=this.tiles[o].scaleFactors[r];this.scale_factors.push(s),n.tileSizePerScaleFactor[s]={width:this.tiles[o].width,height:this.tiles[o].height||this.tiles[o].width}}}else if(t(n.profile)){for(var a=Math.min(this.height,this.width),l=[256,512,1024],c=[],h=0;h<l.length;h++)l[h]<=a&&c.push(l[h]);c.length>0?n.tileSize=Math.max.apply(null,c):n.tileSize=a}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,n.levels=i(this),e.extend(!0,n,{width:n.levels[n.levels.length-1].width,height:n.levels[n.levels.length-1].height,tileSize:Math.max(n.height,n.width),tileOverlap:0,minLevel:0,maxLevel:n.levels.length-1}),this.levels=n.levels):e.console.error("Nothing in the info.json to construct image pyramids from");if(!n.maxLevel&&!this.emulateLegacyImagePyramid)if(this.scale_factors){var u=Math.max.apply(null,this.scale_factors);n.maxLevel=Math.round(Math.log(u)*Math.LOG2E)}else n.maxLevel=Number(Math.ceil(Math.log(Math.max(this.width,this.height),2)));e.TileSource.apply(this,[n])},e.extend(e.IIIFTileSource.prototype,e.TileSource.prototype,{supports:function(e,t){return!(!e.protocol||"http://iiif.io/api/image"!=e.protocol)||(!(!e["@context"]||"http://library.stanford.edu/iiif/image-api/1.1/context.json"!=e["@context"]&&"http://iiif.io/api/image/1/context.json"!=e["@context"])||(!(!e.profile||0!==e.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html"))||(!!(e.identifier&&e.width&&e.height)||!(!e.documentElement||"info"!=e.documentElement.tagName||"http://library.stanford.edu/iiif/image-api/ns/"!=e.documentElement.namespaceURI))))},configure:function(t,i){if(e.isPlainObject(t))return t["@context"]?t:(t["@context"]="http://iiif.io/api/image/1.0/context.json",t["@id"]=i.replace("/info.json",""),t);var o=n(t);return o["@context"]="http://iiif.io/api/image/1.0/context.json",o["@id"]=i.replace("/info.xml",""),o},getTileWidth:function(t){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileWidth.call(this,t);var i=Math.pow(2,this.maxLevel-t);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[i]?this.tileSizePerScaleFactor[i].width:this._tileWidth},getTileHeight:function(t){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileHeight.call(this,t);var i=Math.pow(2,this.maxLevel-t);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[i]?this.tileSizePerScaleFactor[i].height:this._tileHeight},getLevelScale:function(t){if(this.emulateLegacyImagePyramid){var i=NaN;return this.levels.length>0&&t>=this.minLevel&&t<=this.maxLevel&&(i=this.levels[t].width/this.levels[this.maxLevel].width),i}return e.TileSource.prototype.getLevelScale.call(this,t)},getNumTiles:function(t){if(this.emulateLegacyImagePyramid){var i=this.getLevelScale(t);return i?new e.Point(1,1):new e.Point(0,0)}return e.TileSource.prototype.getNumTiles.call(this,t)},getTileAtPoint:function(t,i){return this.emulateLegacyImagePyramid?new e.Point(0,0):e.TileSource.prototype.getTileAtPoint.call(this,t,i)},getTileUrl:function(e,t,i){if(this.emulateLegacyImagePyramid){var n=null;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(n=this.levels[e].url),n}var o,r,s,a,l,c,h,u,d,p,m,g,f="0",v=Math.pow(.5,this.maxLevel-e),y=Math.ceil(this.width*v),w=Math.ceil(this.height*v);return o=this.getTileWidth(e),r=this.getTileHeight(e),s=Math.ceil(o/v),a=Math.ceil(r/v),m=this["@context"].indexOf("/1.0/context.json")>-1||this["@context"].indexOf("/1.1/context.json")>-1||this["@context"].indexOf("/1/context.json")>-1?"native.jpg":"default.jpg",y<o&&w<r?(p=y+",",l="full"):(c=t*s,h=i*a,u=Math.min(s,this.width-c),d=Math.min(a,this.height-h),p=Math.ceil(u*v)+",",l=[c,h,u,d].join(",")),g=[this["@id"],l,p,f,m].join("/"),g}})}(OpenSeadragon),function(e){e.OsmTileSource=function(t,i,n,o,r){var s;s=e.isPlainObject(t)?t:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},s.width&&s.height||(s.width=65572864,s.height=65572864),s.tileSize||(s.tileSize=256,s.tileOverlap=0),s.tilesUrl||(s.tilesUrl="http://tile.openstreetmap.org/"),s.minLevel=8,e.TileSource.apply(this,[s])},e.extend(e.OsmTileSource.prototype,e.TileSource.prototype,{supports:function(e,t){return e.type&&"openstreetmaps"==e.type},configure:function(e,t){return e},getTileUrl:function(e,t,i){return this.tilesUrl+(e-8)+"/"+t+"/"+i+".png"}})}(OpenSeadragon),function(e){e.TmsTileSource=function(t,i,n,o,r){var s;s=e.isPlainObject(t)?t:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var a,l=256*Math.ceil(s.width/256),c=256*Math.ceil(s.height/256);a=l>c?l/256:c/256,s.maxLevel=Math.ceil(Math.log(a)/Math.log(2))-1,s.tileSize=256,s.width=l,s.height=c,e.TileSource.apply(this,[s])},e.extend(e.TmsTileSource.prototype,e.TileSource.prototype,{supports:function(e,t){return e.type&&"tiledmapservice"==e.type},configure:function(e,t){return e},getTileUrl:function(e,t,i){var n=this.getNumTiles(e).y-1;return this.tilesUrl+e+"/"+t+"/"+(n-i)+".png"}})}(OpenSeadragon),function(e){e.ZoomifyTileSource=function(e){e.tileSize=256;var t={x:e.width,y:e.height};e.imageSizes=[{x:e.width,y:e.height}],e.gridSize=[this._getGridSize(e.width,e.height,e.tileSize)];while(parseInt(t.x,10)>e.tileSize||parseInt(t.y,10)>e.tileSize)t.x=Math.floor(t.x/2),t.y=Math.floor(t.y/2),e.imageSizes.push({x:t.x,y:t.y}),e.gridSize.push(this._getGridSize(t.x,t.y,e.tileSize));e.imageSizes.reverse(),e.gridSize.reverse(),e.minLevel=0,e.maxLevel=e.gridSize.length-1,OpenSeadragon.TileSource.apply(this,[e])},e.extend(e.ZoomifyTileSource.prototype,e.TileSource.prototype,{_getGridSize:function(e,t,i){return{x:Math.ceil(e/i),y:Math.ceil(t/i)}},_calculateAbsoluteTileNumber:function(e,t,i){for(var n=0,o={},r=0;r<e;r++)o=this.gridSize[r],n+=o.x*o.y;return o=this.gridSize[e],n+=o.x*i+t,n},supports:function(e,t){return e.type&&"zoomifytileservice"==e.type},configure:function(e,t){return e},getTileUrl:function(e,t,i){var n=0,o=this._calculateAbsoluteTileNumber(e,t,i);return n=Math.floor(o/256),this.tilesUrl+"TileGroup"+n+"/"+e+"-"+t+"-"+i+".jpg"}})}(OpenSeadragon),function(e){function t(t){var i,n,o=[];for(n=0;n<t.length;n++)i=t[n],i.height&&i.width&&i.url?o.push({url:i.url,width:Number(i.width),height:Number(i.height)}):e.console.error("Unsupported image format: %s",i.url?i.url:"<no URL>");return o.sort(function(e,t){return e.height-t.height})}function i(t,i){if(!i||!i.documentElement)throw new Error(e.getString("Errors.Xml"));var o,r,s=i.documentElement,a=s.tagName,l=null,c=[];if("image"==a)try{for(l={type:s.getAttribute("type"),levels:[]},c=s.getElementsByTagName("level"),r=0;r<c.length;r++)o=c[r],l.levels.push({url:o.getAttribute("url"),width:parseInt(o.getAttribute("width"),10),height:parseInt(o.getAttribute("height"),10)});return n(t,l)}catch(h){throw h instanceof Error?h:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if("collection"==a)throw new Error("Legacy Image Pyramid Collections not yet supported.");if("error"==a)throw new Error("Error: "+i)}throw new Error("Unknown element "+a)}function n(e,t){return t.levels}e.LegacyTileSource=function(i){var n,o,r;e.isArray(i)&&(n={type:"legacy-image-pyramid",levels:i}),n.levels=t(n.levels),n.levels.length>0?(o=n.levels[n.levels.length-1].width,r=n.levels[n.levels.length-1].height):(o=0,r=0,e.console.error("No supported image formats found")),e.extend(!0,n,{width:o,height:r,tileSize:Math.max(r,o),tileOverlap:0,minLevel:0,maxLevel:n.levels.length>0?n.levels.length-1:0}),e.TileSource.apply(this,[n]),this.levels=n.levels},e.extend(e.LegacyTileSource.prototype,e.TileSource.prototype,{supports:function(e,t){return e.type&&"legacy-image-pyramid"==e.type||e.documentElement&&"legacy-image-pyramid"==e.documentElement.getAttribute("type")},configure:function(t,o){var r;return r=e.isPlainObject(t)?n(this,t):i(this,t),r},getLevelScale:function(e){var t=NaN;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].width/this.levels[this.maxLevel].width),t},getNumTiles:function(t){var i=this.getLevelScale(t);return i?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(e,t,i){var n=null;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(n=this.levels[e].url),n}})}(OpenSeadragon),function(e){e.ImageTileSource=function(t){t=e.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},t),e.TileSource.apply(this,[t])},e.extend(e.ImageTileSource.prototype,e.TileSource.prototype,{supports:function(e,t){return e.type&&"image"===e.type},configure:function(e,t){return e},getImageInfo:function(t){var i=this._image=new Image,n=this;this.crossOriginPolicy&&(i.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(i.useCredentials=this.ajaxWithCredentials),e.addEvent(i,"load",function(){n.width=Object.prototype.hasOwnProperty.call(i,"naturalWidth")?i.naturalWidth:i.width,n.height=Object.prototype.hasOwnProperty.call(i,"naturalHeight")?i.naturalHeight:i.height,n.aspectRatio=n.width/n.height,n.dimensions=new e.Point(n.width,n.height),n._tileWidth=n.width,n._tileHeight=n.height,n.tileOverlap=0,n.minLevel=0,n.levels=n._buildLevels(),n.maxLevel=n.levels.length-1,n.ready=!0,n.raiseEvent("ready",{tileSource:n})}),e.addEvent(i,"error",function(){n.raiseEvent("open-failed",{message:"Error loading image at "+t,source:t})}),i.src=t},getLevelScale:function(e){var t=NaN;return e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].width/this.levels[this.maxLevel].width),t},getNumTiles:function(t){var i=this.getLevelScale(t);return i?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(e,t,i){var n=null;return e>=this.minLevel&&e<=this.maxLevel&&(n=this.levels[e].url),n},getContext2D:function(e,t,i){var n=null;return e>=this.minLevel&&e<=this.maxLevel&&(n=this.levels[e].context2D),n},_buildLevels:function(){var t=[{url:this._image.src,width:Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,height:Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height}];if(!this.buildPyramid||!e.supportsCanvas||!this.useCanvas)return delete this._image,t;var i=Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,n=Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height,o=document.createElement("canvas"),r=o.getContext("2d");if(o.width=i,o.height=n,r.drawImage(this._image,0,0,i,n),t[0].context2D=r,delete this._image,e.isCanvasTainted(o))return t;while(i>=2&&n>=2){i=Math.floor(i/2),n=Math.floor(n/2);var s=document.createElement("canvas"),a=s.getContext("2d");s.width=i,s.height=n,a.drawImage(o,0,0,i,n),t.splice(0,0,{context2D:a,width:i,height:n}),o=s,r=a}return t}})}(OpenSeadragon),function(e){e.TileSourceCollection=function(t,i,n,o){e.console.error("TileSourceCollection is deprecated; use World instead")}}(OpenSeadragon),function(e){function t(t){e.requestAnimationFrame(function(){i(t)})}function i(i){var n,o,r;i.shouldFade&&(n=e.now(),o=n-i.fadeBeginTime,r=1-o/i.fadeLength,r=Math.min(1,r),r=Math.max(0,r),i.imgGroup&&e.setElementOpacity(i.imgGroup,r,!0),r>0&&t(i))}function n(i){i.shouldFade=!0,i.fadeBeginTime=e.now()+i.fadeDelay,window.setTimeout(function(){t(i)},i.fadeDelay)}function o(t){t.shouldFade=!1,t.imgGroup&&e.setElementOpacity(t.imgGroup,1,!0)}function r(t,i){t.element.disabled||(i>=e.ButtonState.GROUP&&t.currentState==e.ButtonState.REST&&(o(t),t.currentState=e.ButtonState.GROUP),i>=e.ButtonState.HOVER&&t.currentState==e.ButtonState.GROUP&&(t.imgHover&&(t.imgHover.style.visibility=""),t.currentState=e.ButtonState.HOVER),i>=e.ButtonState.DOWN&&t.currentState==e.ButtonState.HOVER&&(t.imgDown&&(t.imgDown.style.visibility=""),t.currentState=e.ButtonState.DOWN))}function s(t,i){t.element.disabled||(i<=e.ButtonState.HOVER&&t.currentState==e.ButtonState.DOWN&&(t.imgDown&&(t.imgDown.style.visibility="hidden"),t.currentState=e.ButtonState.HOVER),i<=e.ButtonState.GROUP&&t.currentState==e.ButtonState.HOVER&&(t.imgHover&&(t.imgHover.style.visibility="hidden"),t.currentState=e.ButtonState.GROUP),i<=e.ButtonState.REST&&t.currentState==e.ButtonState.GROUP&&(n(t),t.currentState=e.ButtonState.REST))}e.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},e.Button=function(t){var i=this;e.EventSource.call(this),e.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null},t),this.element=t.element||e.makeNeutralElement("div"),t.element||(this.imgRest=e.makeTransparentImage(this.srcRest),this.imgGroup=e.makeTransparentImage(this.srcGroup),this.imgHover=e.makeTransparentImage(this.srcHover),this.imgDown=e.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,this.element.style.position="relative",e.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",e.Browser.vendor==e.BROWSERS.FIREFOX&&e.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=e.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new e.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(t){t.insideElementPressed?(r(i,e.ButtonState.DOWN),i.raiseEvent("enter",{originalEvent:t.originalEvent})):t.buttonDownAny||r(i,e.ButtonState.HOVER)},focusHandler:function(e){this.enterHandler(e),i.raiseEvent("focus",{originalEvent:e.originalEvent})},exitHandler:function(t){s(i,e.ButtonState.GROUP),t.insideElementPressed&&i.raiseEvent("exit",{originalEvent:t.originalEvent})},blurHandler:function(e){this.exitHandler(e),i.raiseEvent("blur",{originalEvent:e.originalEvent})},pressHandler:function(t){r(i,e.ButtonState.DOWN),i.raiseEvent("press",{originalEvent:t.originalEvent})},releaseHandler:function(t){t.insideElementPressed&&t.insideElementReleased?(s(i,e.ButtonState.HOVER),i.raiseEvent("release",{originalEvent:t.originalEvent})):t.insideElementPressed?s(i,e.ButtonState.GROUP):r(i,e.ButtonState.HOVER)},clickHandler:function(e){e.quick&&i.raiseEvent("click",{originalEvent:e.originalEvent})},keyHandler:function(e){return 13!==e.keyCode||(i.raiseEvent("click",{originalEvent:e.originalEvent}),i.raiseEvent("release",{originalEvent:e.originalEvent}),!1)}}),s(this,e.ButtonState.REST)},e.extend(e.Button.prototype,e.EventSource.prototype,{notifyGroupEnter:function(){r(this,e.ButtonState.GROUP)},notifyGroupExit:function(){s(this,e.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,e.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,e.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()}})}(OpenSeadragon),function(e){e.ButtonGroup=function(t){e.extend(!0,this,{buttons:[],clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},t);var i,n=this.buttons.concat([]),o=this;if(this.element=t.element||e.makeNeutralElement("div"),!t.group)for(this.label=e.makeNeutralElement("label"),this.element.style.display="inline-block",this.element.appendChild(this.label),i=0;i<n.length;i++)this.element.appendChild(n[i].element);e.setElementTouchActionNone(this.element),this.tracker=new e.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(e){var t;for(t=0;t<o.buttons.length;t++)o.buttons[t].notifyGroupEnter()},exitHandler:function(e){var t;if(!e.insideElementPressed)for(t=0;t<o.buttons.length;t++)o.buttons[t].notifyGroupExit()}})},e.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateExit:function(){this.tracker.exitHandler({eventSource:this.tracker})}}}(OpenSeadragon),function(e){e.Rect=function(t,i,n,o,r){var s,a;this.x="number"===typeof t?t:0,this.y="number"===typeof i?i:0,this.width="number"===typeof n?n:0,this.height="number"===typeof o?o:0,this.degrees="number"===typeof r?r:0,this.degrees=e.positiveModulo(this.degrees,360),this.degrees>=270?(s=this.getTopRight(),this.x=s.x,this.y=s.y,a=this.height,this.height=this.width,this.width=a,this.degrees-=270):this.degrees>=180?(s=this.getBottomRight(),this.x=s.x,this.y=s.y,this.degrees-=180):this.degrees>=90&&(s=this.getBottomLeft(),this.x=s.x,this.y=s.y,a=this.height,this.height=this.width,this.width=a,this.degrees-=90)},e.Rect.fromSummits=function(t,i,n){var o=t.distanceTo(i),r=t.distanceTo(n),s=i.minus(t),a=Math.atan(s.y/s.x);return s.x<0?a+=Math.PI:s.y<0&&(a+=2*Math.PI),new e.Rect(t.x,t.y,o,r,a/Math.PI*180)},e.Rect.prototype={clone:function(){return new e.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new e.Point(this.x,this.y)},getBottomRight:function(){return new e.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new e.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new e.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new e.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new e.Point(this.width,this.height)},equals:function(t){return t instanceof e.Rect&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height&&this.degrees===t.degrees},times:function(t){return new e.Rect(this.x*t,this.y*t,this.width*t,this.height*t,this.degrees)},translate:function(t){return new e.Rect(this.x+t.x,this.y+t.y,this.width,this.height,this.degrees)},union:function(t){var i=this.getBoundingBox(),n=t.getBoundingBox(),o=Math.min(i.x,n.x),r=Math.min(i.y,n.y),s=Math.max(i.x+i.width,n.x+n.width),a=Math.max(i.y+i.height,n.y+n.height);return new e.Rect(o,r,s-o,a-r)},intersection:function(t){var i=1e-10,n=[],o=this.getTopLeft();t.containsPoint(o,i)&&n.push(o);var r=this.getTopRight();t.containsPoint(r,i)&&n.push(r);var s=this.getBottomLeft();t.containsPoint(s,i)&&n.push(s);var a=this.getBottomRight();t.containsPoint(a,i)&&n.push(a);var l=t.getTopLeft();this.containsPoint(l,i)&&n.push(l);var c=t.getTopRight();this.containsPoint(c,i)&&n.push(c);var h=t.getBottomLeft();this.containsPoint(h,i)&&n.push(h);var u=t.getBottomRight();this.containsPoint(u,i)&&n.push(u);for(var d=this._getSegments(),p=t._getSegments(),m=0;m<d.length;m++)for(var g=d[m],f=0;f<p.length;f++){var v=p[f],y=w(g[0],g[1],v[0],v[1]);y&&n.push(y)}function w(t,n,o,r){var s=n.minus(t),a=r.minus(o),l=-a.x*s.y+s.x*a.y;if(0===l)return null;var c=(s.x*(t.y-o.y)-s.y*(t.x-o.x))/l,h=(a.x*(t.y-o.y)-a.y*(t.x-o.x))/l;return-i<=c&&c<=1-i&&-i<=h&&h<=1-i?new e.Point(t.x+h*s.x,t.y+h*s.y):null}if(0===n.length)return null;for(var T=n[0].x,x=n[0].x,S=n[0].y,E=n[0].y,_=1;_<n.length;_++){var b=n[_];b.x<T&&(T=b.x),b.x>x&&(x=b.x),b.y<S&&(S=b.y),b.y>E&&(E=b.y)}return new e.Rect(T,S,x-T,E-S)},_getSegments:function(){var e=this.getTopLeft(),t=this.getTopRight(),i=this.getBottomLeft(),n=this.getBottomRight();return[[e,t],[t,n],[n,i],[i,e]]},rotate:function(t,i){if(t=e.positiveModulo(t,360),0===t)return this.clone();i=i||this.getCenter();var n=this.getTopLeft().rotate(t,i),o=this.getTopRight().rotate(t,i),r=o.minus(n);r=r.apply(function(e){var t=1e-15;return Math.abs(e)<t?0:e});var s=Math.atan(r.y/r.x);return r.x<0?s+=Math.PI:r.y<0&&(s+=2*Math.PI),new e.Rect(n.x,n.y,this.width,this.height,s/Math.PI*180)},getBoundingBox:function(){if(0===this.degrees)return this.clone();var t=this.getTopLeft(),i=this.getTopRight(),n=this.getBottomLeft(),o=this.getBottomRight(),r=Math.min(t.x,i.x,n.x,o.x),s=Math.max(t.x,i.x,n.x,o.x),a=Math.min(t.y,i.y,n.y,o.y),l=Math.max(t.y,i.y,n.y,o.y);return new e.Rect(r,a,s-r,l-a)},getIntegerBoundingBox:function(){var t=this.getBoundingBox(),i=Math.floor(t.x),n=Math.floor(t.y),o=Math.ceil(t.width+t.x-i),r=Math.ceil(t.height+t.y-n);return new e.Rect(i,n,o,r)},containsPoint:function(e,t){t=t||0;var i=this.getTopLeft(),n=this.getTopRight(),o=this.getBottomLeft(),r=n.minus(i),s=o.minus(i);return(e.x-i.x)*r.x+(e.y-i.y)*r.y>=-t&&(e.x-n.x)*r.x+(e.y-n.y)*r.y<=t&&(e.x-i.x)*s.x+(e.y-i.y)*s.y>=-t&&(e.x-o.x)*s.x+(e.y-o.y)*s.y<=t},toString:function(){return"["+Math.round(100*this.x)/100+", "+Math.round(100*this.y)/100+", "+Math.round(100*this.width)/100+"x"+Math.round(100*this.height)/100+", "+Math.round(100*this.degrees)/100+"deg]"}}}(OpenSeadragon),function(e){var t={};function i(t){var i=Number(this.element.style.marginLeft.replace("px","")),n=Number(this.element.style.marginTop.replace("px","")),r=Number(this.element.style.width.replace("px","")),s=Number(this.element.style.height.replace("px","")),a=e.getElementSize(this.viewer.canvas);return this.dragging=!0,this.element&&("horizontal"==this.scroll?-t.delta.x>0?i>-(r-a.x)&&(this.element.style.marginLeft=i+2*t.delta.x+"px",o(this,a.x,i+2*t.delta.x)):-t.delta.x<0&&i<0&&(this.element.style.marginLeft=i+2*t.delta.x+"px",o(this,a.x,i+2*t.delta.x)):-t.delta.y>0?n>-(s-a.y)&&(this.element.style.marginTop=n+2*t.delta.y+"px",o(this,a.y,n+2*t.delta.y)):-t.delta.y<0&&n<0&&(this.element.style.marginTop=n+2*t.delta.y+"px",o(this,a.y,n+2*t.delta.y))),!1}function n(t){var i=Number(this.element.style.marginLeft.replace("px","")),n=Number(this.element.style.marginTop.replace("px","")),r=Number(this.element.style.width.replace("px","")),s=Number(this.element.style.height.replace("px","")),a=e.getElementSize(this.viewer.canvas);return this.element&&("horizontal"==this.scroll?t.scroll>0?i>-(r-a.x)&&(this.element.style.marginLeft=i-60*t.scroll+"px",o(this,a.x,i-60*t.scroll)):t.scroll<0&&i<0&&(this.element.style.marginLeft=i-60*t.scroll+"px",o(this,a.x,i-60*t.scroll)):t.scroll<0?n>a.y-s&&(this.element.style.marginTop=n+60*t.scroll+"px",o(this,a.y,n+60*t.scroll)):t.scroll>0&&n<0&&(this.element.style.marginTop=n+60*t.scroll+"px",o(this,a.y,n+60*t.scroll))),!1}function o(t,i,n){var o,r,s,a,l,c,h;for(o="horizontal"==t.scroll?t.panelWidth:t.panelHeight,r=Math.ceil(i/o)+5,s=Math.ceil((Math.abs(n)+i)/o)+1,r=s-r,r=r<0?0:r,c=r;c<s&&c<t.panels.length;c++)if(h=t.panels[c],!h.activePanel){var u,d=t.viewer.tileSources[c];u=d.referenceStripThumbnailUrl?{type:"image",url:d.referenceStripThumbnailUrl}:d,a=new e.Viewer({id:h.id,tileSources:[u],element:h,navigatorSizeRatio:t.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0}),a.displayRegion=e.makeNeutralElement("div"),a.displayRegion.id=h.id+"-displayregion",a.displayRegion.className="displayregion",l=a.displayRegion.style,l.position="relative",l.top="0px",l.left="0px",l.fontSize="0px",l.overflow="hidden",l.float="left",l.cssFloat="left",l.styleFloat="left",l.zIndex=999999999,l.cursor="default",l.width=t.panelWidth-4+"px",l.height=t.panelHeight-4+"px",a.displayRegion.innerTracker=new e.MouseTracker({element:a.displayRegion,startDisabled:!0}),h.getElementsByTagName("div")[0].appendChild(a.displayRegion),t.miniViewers[h.id]=a,h.activePanel=!0}}function r(e){var t=e.eventSource.element;return"horizontal"==this.scroll?t.style.marginBottom="0px":t.style.marginLeft="0px",!1}function s(t){var i=t.eventSource.element;return"horizontal"==this.scroll?i.style.marginBottom="-"+e.getElementSize(i).y/2+"px":i.style.marginLeft="-"+e.getElementSize(i).x/2+"px",!1}function a(e){if(e.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 38:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 40:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 37:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 39:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}function l(e){if(e.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 61:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 45:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 48:case 119:case 87:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 115:case 83:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 97:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 100:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}e.ReferenceStrip=function(c){var h,u,d,p=this,m=c.viewer,g=e.getElementSize(m.element);for(c.id||(c.id="referencestrip-"+e.now(),this.element=e.makeNeutralElement("div"),this.element.id=c.id,this.element.className="referencestrip"),c=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.referenceStripSizeRatio,position:e.DEFAULT_SETTINGS.referenceStripPosition,scroll:e.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold},c,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1}),e.extend(this,c),t[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,u=this.element.style,u.marginTop="0px",u.marginRight="0px",u.marginBottom="0px",u.marginLeft="0px",u.left="0px",u.bottom="0px",u.border="0px",u.background="#000",u.position="relative",e.setElementTouchActionNone(this.element),e.setElementOpacity(this.element,.8),this.viewer=m,this.innerTracker=new e.MouseTracker({element:this.element,dragHandler:e.delegate(this,i),scrollHandler:e.delegate(this,n),enterHandler:e.delegate(this,r),exitHandler:e.delegate(this,s),keyDownHandler:e.delegate(this,a),keyHandler:e.delegate(this,l)}),c.width&&c.height?(this.element.style.width=c.width+"px",this.element.style.height=c.height+"px",m.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):"horizontal"==c.scroll?(this.element.style.width=g.x*c.sizeRatio*m.tileSources.length+12*m.tileSources.length+"px",this.element.style.height=g.y*c.sizeRatio+"px",m.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=g.y*c.sizeRatio*m.tileSources.length+12*m.tileSources.length+"px",this.element.style.width=g.x*c.sizeRatio+"px",m.addControl(this.element,{anchor:e.ControlAnchor.TOP_LEFT})),this.panelWidth=g.x*this.sizeRatio+8,this.panelHeight=g.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},d=0;d<m.tileSources.length;d++)h=e.makeNeutralElement("div"),h.id=this.element.id+"-"+d,h.style.width=p.panelWidth+"px",h.style.height=p.panelHeight+"px",h.style.display="inline",h.style.float="left",h.style.cssFloat="left",h.style.styleFloat="left",h.style.padding="2px",e.setElementTouchActionNone(h),h.innerTracker=new e.MouseTracker({element:h,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,pressHandler:function(t){t.eventSource.dragging=e.now()},releaseHandler:function(t){var i=t.eventSource,n=i.element.id,o=Number(n.split("-")[2]),r=e.now();t.insideElementPressed&&t.insideElementReleased&&i.dragging&&r-i.dragging<i.clickTimeThreshold&&(i.dragging=null,m.goToPage(o))}}),this.element.appendChild(h),h.activePanel=!1,this.panels.push(h);o(this,"vertical"==this.scroll?g.y:g.x,0),this.setFocus(0)},e.extend(e.ReferenceStrip.prototype,e.EventSource.prototype,e.Viewer.prototype,{setFocus:function(t){var i,n=e.getElement(this.element.id+"-"+t),s=e.getElementSize(this.viewer.canvas),a=Number(this.element.style.width.replace("px","")),l=Number(this.element.style.height.replace("px","")),c=-Number(this.element.style.marginLeft.replace("px","")),h=-Number(this.element.style.marginTop.replace("px",""));this.currentSelected!==n&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=n,this.currentSelected.style.background="#999","horizontal"==this.scroll?(i=Number(t)*(this.panelWidth+3),i>c+s.x-this.panelWidth?(i=Math.min(i,a-s.x),this.element.style.marginLeft=-i+"px",o(this,s.x,-i)):i<c&&(i=Math.max(0,i-s.x/2),this.element.style.marginLeft=-i+"px",o(this,s.x,-i))):(i=Number(t)*(this.panelHeight+3),i>h+s.y-this.panelHeight?(i=Math.min(i,l-s.y),this.element.style.marginTop=-i+"px",o(this,s.y,-i)):i<h&&(i=Math.max(0,i-s.y/2),this.element.style.marginTop=-i+"px",o(this,s.y,-i))),this.currentPage=t,r.call(this,{eventSource:this.innerTracker}))},update:function(){return!!t[this.id].animating&&(e.console.log("image reference strip update"),!0)},destroy:function(){if(this.miniViewers)for(var e in this.miniViewers)this.miniViewers[e].destroy();this.element&&this.element.parentNode.removeChild(this.element)}})}(OpenSeadragon),function(e){e.DisplayRect=function(t,i,n,o,r,s){e.Rect.apply(this,[t,i,n,o]),this.minLevel=r,this.maxLevel=s},e.extend(e.DisplayRect.prototype,e.Rect.prototype)}(OpenSeadragon),function(e){function t(e,t){return(1-Math.exp(e*-t))/(1-Math.exp(-e))}e.Spring=function(t){var i=arguments;"object"!=typeof t&&(t={initial:i.length&&"number"==typeof i[0]?i[0]:void 0,springStiffness:i.length>1?i[1].springStiffness:5,animationTime:i.length>1?i[1].animationTime:1.5}),e.console.assert("number"===typeof t.springStiffness&&0!==t.springStiffness,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),e.console.assert("number"===typeof t.animationTime&&t.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),t.exponential&&(this._exponential=!0,delete t.exponential),e.extend(!0,this,t),this.current={value:"number"==typeof this.initial?this.initial:this._exponential?0:1,time:e.now()},e.console.assert(!this._exponential||0!==this.current.value,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},e.Spring.prototype={resetTo:function(t){e.console.assert(!this._exponential||0!==t,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=t,this.start.time=this.target.time=this.current.time=e.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(t){e.console.assert(!this._exponential||0!==t,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=t,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(t){this.start.value+=t,this.target.value+=t,this._exponential&&(e.console.assert(0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(t){this._exponential=t,this._exponential&&(e.console.assert(0!==this.current.value&&0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){var i,n;this.current.time=e.now(),this._exponential?(i=this.start._logValue,n=this.target._logValue):(i=this.start.value,n=this.target.value);var o=this.current.time>=this.target.time?n:i+(n-i)*t(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),r=this.current.value;return this._exponential?this.current.value=Math.exp(o):this.current.value=o,r!=this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}}}(OpenSeadragon),function(e){function t(t){e.extend(!0,this,{timeout:e.DEFAULT_SETTINGS.timeout,jobId:null},t),this.image=null}function i(e,t,i){var n;e.jobsInProgress--,(!e.jobLimit||e.jobsInProgress<e.jobLimit)&&e.jobQueue.length>0&&(n=e.jobQueue.shift(),n.start(),e.jobsInProgress++),i(t.image,t.errorMsg,t.request)}t.prototype={errorMsg:null,start:function(){var t=this,i=this.abort;this.image=new Image,this.image.onload=function(){t.finish(!0)},this.image.onabort=this.image.onerror=function(){t.errorMsg="Image load aborted",t.finish(!1)},this.jobId=window.setTimeout(function(){t.errorMsg="Image load exceeded timeout",t.finish(!1)},this.timeout),this.loadWithAjax?(this.request=e.makeAjaxRequest({url:this.src,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,responseType:"arraybuffer",success:function(e){var i;try{i=new window.Blob([e.response])}catch(s){var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if("TypeError"===s.name&&n){var o=new n;o.append(e.response),i=o.getBlob()}}0===i.size&&(t.errorMsg="Empty image response.",t.finish(!1));var r=(window.URL||window.webkitURL).createObjectURL(i);t.image.src=r},error:function(e){t.errorMsg="Image load aborted - XHR error",t.finish(!1)}}),this.abort=function(){t.request.abort(),"function"===typeof i&&i()}):(!1!==this.crossOriginPolicy&&(this.image.crossOrigin=this.crossOriginPolicy),this.image.src=this.src)},finish:function(e){this.image.onload=this.image.onerror=this.image.onabort=null,e||(this.image=null),this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},e.ImageLoader=function(t){e.extend(!0,this,{jobLimit:e.DEFAULT_SETTINGS.imageLoaderLimit,timeout:e.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},t)},e.ImageLoader.prototype={addJob:function(e){var n=this,o=function(t){i(n,t,e.callback)},r={src:e.src,loadWithAjax:e.loadWithAjax,ajaxHeaders:e.loadWithAjax?e.ajaxHeaders:null,crossOriginPolicy:e.crossOriginPolicy,ajaxWithCredentials:e.ajaxWithCredentials,callback:o,abort:e.abort,timeout:this.timeout},s=new t(r);!this.jobLimit||this.jobsInProgress<this.jobLimit?(s.start(),this.jobsInProgress++):this.jobQueue.push(s)},clear:function(){for(var e=0;e<this.jobQueue.length;e++){var t=this.jobQueue[e];"function"===typeof t.abort&&t.abort()}this.jobQueue=[]}}}(OpenSeadragon),function(e){e.Tile=function(e,t,i,n,o,r,s,a,l,c){this.level=e,this.x=t,this.y=i,this.bounds=n,this.sourceBounds=c,this.exists=o,this.url=r,this.context2D=s,this.loadWithAjax=a,this.ajaxHeaders=l,this.ajaxHeaders?this.cacheKey=this.url+"+"+JSON.stringify(this.ajaxHeaders):this.cacheKey=this.url,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},e.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return!!this.context2D||this.url.match(".png")},drawHTML:function(t){this.cacheImageRecord?this.loaded?(this.element||(this.element=e.makeNeutralElement("div"),this.imgElement=this.cacheImageRecord.getImage().cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!=t&&t.appendChild(this.element),this.imgElement.parentNode!=this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",e.setElementOpacity(this.element,this.opacity)):e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString()):e.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString())},drawCanvas:function(t,i,n,o){var r,s,a,l=this.position.times(e.pixelDensityRatio),c=this.size.times(e.pixelDensityRatio);this.context2D||this.cacheImageRecord?(r=this.context2D||this.cacheImageRecord.getRenderedContext(),this.loaded&&r?(t.save(),t.globalAlpha=this.opacity,"number"===typeof n&&1!==n&&(l=l.times(n),c=c.times(n)),o instanceof e.Point&&(l=l.plus(o)),1===t.globalAlpha&&this._hasTransparencyChannel()&&t.clearRect(l.x,l.y,c.x,c.y),i({context:t,tile:this,rendered:r}),this.sourceBounds?(s=Math.min(this.sourceBounds.width,r.canvas.width),a=Math.min(this.sourceBounds.height,r.canvas.height)):(s=r.canvas.width,a=r.canvas.height),t.drawImage(r.canvas,0,0,s,a,l.x,l.y,c.x,c.y),t.restore()):e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString())):e.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString())},getScaleForEdgeSmoothing:function(){var t;if(this.cacheImageRecord)t=this.cacheImageRecord.getRenderedContext();else{if(!this.context2D)return e.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;t=this.context2D}return t.canvas.width/(this.size.x*e.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(t,i,n){var o=Math.max(1,Math.ceil((n.x-i.x)/2)),r=Math.max(1,Math.ceil((n.y-i.y)/2));return new e.Point(o,r).minus(this.position.times(e.pixelDensityRatio).times(t||1).apply(function(e){return e%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(OpenSeadragon),function(e){e.OverlayPlacement=e.Placement,e.OverlayRotationMode=e.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),e.Overlay=function(t,i,n){var o;o=e.isPlainObject(t)?t:{element:t,location:i,placement:n},this.element=o.element,this.style=o.element.style,this._init(o)},e.Overlay.prototype={_init:function(t){this.location=t.location,this.placement=void 0===t.placement?e.Placement.TOP_LEFT:t.placement,this.onDraw=t.onDraw,this.checkResize=void 0===t.checkResize||t.checkResize,this.width=void 0===t.width?null:t.width,this.height=void 0===t.height?null:t.height,this.rotationMode=t.rotationMode||e.OverlayRotationMode.EXACT,this.location instanceof e.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=e.Placement.TOP_LEFT),this.scales=null!==this.width&&null!==this.height,this.bounds=new e.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(t,i){var n=e.Placement.properties[this.placement];n&&(n.isHorizontallyCentered?t.x-=i.x/2:n.isRight&&(t.x-=i.x),n.isVerticallyCentered?t.y-=i.y/2:n.isBottom&&(t.y-=i.y))},destroy:function(){var t=this.element,i=this.style;t.parentNode&&(t.parentNode.removeChild(t),t.prevElementParent&&(i.display="none",document.body.appendChild(t))),this.onDraw=null,i.top="",i.left="",i.position="",null!==this.width&&(i.width=""),null!==this.height&&(i.height="");var n=e.getCssPropertyWithVendorPrefix("transformOrigin"),o=e.getCssPropertyWithVendorPrefix("transform");n&&o&&(i[n]="",i[o]="")},drawHTML:function(t,i){var n=this.element;n.parentNode!==t&&(n.prevElementParent=n.parentNode,n.prevNextSibling=n.nextSibling,t.appendChild(n),this.style.position="absolute",this.size=e.getElementSize(n));var o=this._getOverlayPositionAndSize(i),r=o.position,s=this.size=o.size,a=o.rotate;if(this.onDraw)this.onDraw(r,s,this.element);else{var l=this.style;l.left=r.x+"px",l.top=r.y+"px",null!==this.width&&(l.width=s.x+"px"),null!==this.height&&(l.height=s.y+"px");var c=e.getCssPropertyWithVendorPrefix("transformOrigin"),h=e.getCssPropertyWithVendorPrefix("transform");c&&h&&(a?(l[c]=this._getTransformOrigin(),l[h]="rotate("+a+"deg)"):(l[c]="",l[h]="")),"none"!==l.display&&(l.display="block")}},_getOverlayPositionAndSize:function(t){var i=t.pixelFromPoint(this.location,!0),n=this._getSizeInPixels(t);this.adjust(i,n);var o=0;if(t.degrees&&this.rotationMode!==e.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX&&null!==this.width&&null!==this.height){var r=new e.Rect(i.x,i.y,n.x,n.y),s=this._getBoundingBox(r,t.degrees);i=s.getTopLeft(),n=s.getSize()}else o=t.degrees;return{position:i,size:n,rotate:o}},_getSizeInPixels:function(t){var i=this.size.x,n=this.size.y;if(null!==this.width||null!==this.height){var o=t.deltaPixelsFromPointsNoRotate(new e.Point(this.width||0,this.height||0),!0);null!==this.width&&(i=o.x),null!==this.height&&(n=o.y)}if(this.checkResize&&(null===this.width||null===this.height)){var r=this.size=e.getElementSize(this.element);null===this.width&&(i=r.x),null===this.height&&(n=r.y)}return new e.Point(i,n)},_getBoundingBox:function(e,t){var i=this._getPlacementPoint(e);return e.rotate(t,i).getBoundingBox()},_getPlacementPoint:function(t){var i=new e.Point(t.x,t.y),n=e.Placement.properties[this.placement];return n&&(n.isHorizontallyCentered?i.x+=t.width/2:n.isRight&&(i.x+=t.width),n.isVerticallyCentered?i.y+=t.height/2:n.isBottom&&(i.y+=t.height)),i},_getTransformOrigin:function(){var t="",i=e.Placement.properties[this.placement];return i?(i.isLeft?t="left":i.isRight&&(t="right"),i.isTop?t+=" top":i.isBottom&&(t+=" bottom"),t):t},update:function(t,i){var n=e.isPlainObject(t)?t:{location:t,placement:i};this._init({location:n.location||this.location,placement:void 0!==n.placement?n.placement:this.placement,onDraw:n.onDraw||this.onDraw,checkResize:n.checkResize||this.checkResize,width:void 0!==n.width?n.width:this.width,height:void 0!==n.height?n.height:this.height,rotationMode:n.rotationMode||this.rotationMode})},getBounds:function(t){e.console.assert(t,"A viewport must now be passed to Overlay.getBounds.");var i=this.width,n=this.height;if(null===i||null===n){var o=t.deltaPointsFromPixelsNoRotate(this.size,!0);null===i&&(i=o.x),null===n&&(n=o.y)}var r=this.location.clone();return this.adjust(r,new e.Point(i,n)),this._adjustBoundsForRotation(t,new e.Rect(r.x,r.y,i,n))},_adjustBoundsForRotation:function(t,i){if(!t||0===t.degrees||this.rotationMode===e.OverlayRotationMode.EXACT)return i;if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX){if(null===this.width||null===this.height)return i;var n=this._getOverlayPositionAndSize(t);return t.viewerElementToViewportRectangle(new e.Rect(n.position.x,n.position.y,n.size.x,n.size.y))}return i.rotate(-t.degrees,this._getPlacementPoint(i))}}}(OpenSeadragon),function(e){e.Drawer=function(t){e.console.assert(t.viewer,"[Drawer] options.viewer is required");var i=arguments;if(e.isPlainObject(t)||(t={source:i[0],viewport:i[1],element:i[2]}),e.console.assert(t.viewport,"[Drawer] options.viewport is required"),e.console.assert(t.element,"[Drawer] options.element is required"),t.source&&e.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=t.viewer,this.viewport=t.viewport,this.debugGridColor="string"===typeof t.debugGridColor?[t.debugGridColor]:t.debugGridColor||e.DEFAULT_SETTINGS.debugGridColor,t.opacity&&e.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=e.supportsCanvas&&(!this.viewer||this.viewer.useCanvas),this.container=e.getElement(t.element),this.canvas=e.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var n=this._calculateCanvasSize();this.canvas.width=n.x,this.canvas.height=n.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",e.setElementOpacity(this.canvas,this.opacity,!0),this.container.style.textAlign="left",this.container.appendChild(this.canvas)},e.Drawer.prototype={addOverlay:function(t,i,n,o){return e.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(t,i,n,o),this},updateOverlay:function(t,i,n){return e.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(t,i,n),this},removeOverlay:function(t){return e.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(t),this},clearOverlays:function(){return e.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},setOpacity:function(t){e.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var i=this.viewer.world,n=0;n<i.getItemCount();n++)i.getItemAt(n).setOpacity(t);return this},getOpacity:function(){e.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var t=this.viewer.world,i=0,n=0;n<t.getItemCount();n++){var o=t.getItemAt(n).getOpacity();o>i&&(i=o)}return i},needsUpdate:function(){return e.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return e.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return e.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return e.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var e=this._calculateCanvasSize();if((this.canvas.width!=e.x||this.canvas.height!=e.y)&&(this.canvas.width=e.x,this.canvas.height=e.y,null!==this.sketchCanvas)){var t=this._calculateSketchCanvasSize();this.sketchCanvas.width=t.x,this.sketchCanvas.height=t.y}this._clear()}},_clear:function(e,t){if(this.useCanvas){var i=this._getContext(e);if(t)i.clearRect(t.x,t.y,t.width,t.height);else{var n=i.canvas;i.clearRect(0,0,n.width,n.height)}}},viewportToDrawerRectangle:function(t){var i=this.viewport.pixelFromPointNoRotate(t.getTopLeft(),!0),n=this.viewport.deltaPixelsFromPointsNoRotate(t.getSize(),!0);return new e.Rect(i.x*e.pixelDensityRatio,i.y*e.pixelDensityRatio,n.x*e.pixelDensityRatio,n.y*e.pixelDensityRatio)},drawTile:function(t,i,n,o,r){if(e.console.assert(t,"[Drawer.drawTile] tile is required"),e.console.assert(i,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var s=this._getContext(n);o=o||1,t.drawCanvas(s,i,o,r)}else t.drawHTML(this.canvas)},_getContext:function(e){var t=this.context;if(e){if(null===this.sketchCanvas){this.sketchCanvas=document.createElement("canvas");var i=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=i.x,this.sketchCanvas.height=i.y,this.sketchContext=this.sketchCanvas.getContext("2d"),0===this.viewport.getRotation()){var n=this;this.viewer.addHandler("rotate",function e(){if(0!==n.viewport.getRotation()){n.viewer.removeHandler("rotate",e);var t=n._calculateSketchCanvasSize();n.sketchCanvas.width=t.x,n.sketchCanvas.height=t.y}})}}t=this.sketchContext}return t},saveContext:function(e){this.useCanvas&&this._getContext(e).save()},restoreContext:function(e){this.useCanvas&&this._getContext(e).restore()},setClip:function(e,t){if(this.useCanvas){var i=this._getContext(t);i.beginPath(),i.rect(e.x,e.y,e.width,e.height),i.clip()}},drawRectangle:function(e,t,i){if(this.useCanvas){var n=this._getContext(i);n.save(),n.fillStyle=t,n.fillRect(e.x,e.y,e.width,e.height),n.restore()}},blendSketch:function(t,i,n,o){var r=t;if(e.isPlainObject(r)||(r={opacity:t,scale:i,translate:n,compositeOperation:o}),this.useCanvas&&this.sketchCanvas){t=r.opacity,o=r.compositeOperation;var s=r.bounds;if(this.context.save(),this.context.globalAlpha=t,o&&(this.context.globalCompositeOperation=o),s)s.x<0&&(s.width+=s.x,s.x=0),s.x+s.width>this.canvas.width&&(s.width=this.canvas.width-s.x),s.y<0&&(s.height+=s.y,s.y=0),s.y+s.height>this.canvas.height&&(s.height=this.canvas.height-s.y),this.context.drawImage(this.sketchCanvas,s.x,s.y,s.width,s.height,s.x,s.y,s.width,s.height);else{i=r.scale||1,n=r.translate;var a=n instanceof e.Point?n:new e.Point(0,0),l=0,c=0;if(n){var h=this.sketchCanvas.width-this.canvas.width,u=this.sketchCanvas.height-this.canvas.height;l=Math.round(h/2),c=Math.round(u/2)}this.context.drawImage(this.sketchCanvas,a.x-l*i,a.y-c*i,(this.canvas.width+2*l)*i,(this.canvas.height+2*c)*i,-l,-c,this.canvas.width+2*l,this.canvas.height+2*c)}this.context.restore()}},drawDebugInfo:function(t,i,n,o){if(this.useCanvas){var r=this.viewer.world.getIndexOfItem(o)%this.debugGridColor.length,s=this.context;s.save(),s.lineWidth=2*e.pixelDensityRatio,s.font="small-caps bold "+13*e.pixelDensityRatio+"px arial",s.strokeStyle=this.debugGridColor[r],s.fillStyle=this.debugGridColor[r],0!==this.viewport.degrees?this._offsetForRotation({degrees:this.viewport.degrees}):this.viewer.viewport.flipped&&this._flip(),o.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:o.getRotation(!0),point:o.viewport.pixelFromPointNoRotate(o._getRotationPoint(!0),!0)}),s.strokeRect(t.position.x*e.pixelDensityRatio,t.position.y*e.pixelDensityRatio,t.size.x*e.pixelDensityRatio,t.size.y*e.pixelDensityRatio);var a=(t.position.x+t.size.x/2)*e.pixelDensityRatio,l=(t.position.y+t.size.y/2)*e.pixelDensityRatio;s.translate(a,l),s.rotate(Math.PI/180*-this.viewport.degrees),s.translate(-a,-l),0===t.x&&0===t.y&&(s.fillText("Zoom: "+this.viewport.getZoom(),t.position.x*e.pixelDensityRatio,(t.position.y-30)*e.pixelDensityRatio),s.fillText("Pan: "+this.viewport.getBounds().toString(),t.position.x*e.pixelDensityRatio,(t.position.y-20)*e.pixelDensityRatio)),s.fillText("Level: "+t.level,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+20)*e.pixelDensityRatio),s.fillText("Column: "+t.x,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+30)*e.pixelDensityRatio),s.fillText("Row: "+t.y,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+40)*e.pixelDensityRatio),s.fillText("Order: "+n+" of "+i,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+50)*e.pixelDensityRatio),s.fillText("Size: "+t.size.toString(),(t.position.x+10)*e.pixelDensityRatio,(t.position.y+60)*e.pixelDensityRatio),s.fillText("Position: "+t.position.toString(),(t.position.x+10)*e.pixelDensityRatio,(t.position.y+70)*e.pixelDensityRatio),0!==this.viewport.degrees&&this._restoreRotationChanges(),o.getRotation(!0)%360!==0&&this._restoreRotationChanges(),s.restore()}},debugRect:function(t){if(this.useCanvas){var i=this.context;i.save(),i.lineWidth=2*e.pixelDensityRatio,i.strokeStyle=this.debugGridColor[0],i.fillStyle=this.debugGridColor[0],i.strokeRect(t.x*e.pixelDensityRatio,t.y*e.pixelDensityRatio,t.width*e.pixelDensityRatio,t.height*e.pixelDensityRatio),i.restore()}},getCanvasSize:function(t){var i=this._getContext(t).canvas;return new e.Point(i.width,i.height)},getCanvasCenter:function(){return new e.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(t){var i=t.point?t.point.times(e.pixelDensityRatio):this.getCanvasCenter(),n=this._getContext(t.useSketch);n.save(),n.translate(i.x,i.y),this.viewer.viewport.flipped?(n.rotate(Math.PI/180*-t.degrees),n.scale(-1,1)):n.rotate(Math.PI/180*t.degrees),n.translate(-i.x,-i.y)},_flip:function(t){t=t||{};var i=t.point?t.point.times(e.pixelDensityRatio):this.getCanvasCenter(),n=this._getContext(t.useSketch);n.translate(i.x,0),n.scale(-1,1),n.translate(-i.x,0)},_restoreRotationChanges:function(e){var t=this._getContext(e);t.restore()},_calculateCanvasSize:function(){var t=e.pixelDensityRatio,i=this.viewport.getContainerSize();return{x:i.x*t,y:i.y*t}},_calculateSketchCanvasSize:function(){var e=this._calculateCanvasSize();if(0===this.viewport.getRotation())return e;var t=Math.ceil(Math.sqrt(e.x*e.x+e.y*e.y));return{x:t,y:t}}}}(OpenSeadragon),function(e){e.Viewport=function(t){var i=arguments;i.length&&i[0]instanceof e.Point&&(t={containerSize:i[0],contentSize:i[1],config:i[2]}),t.config&&(e.extend(!0,t,t.config),delete t.config),this._margins=e.extend({left:0,top:0,right:0,bottom:0},t.margins||{}),delete t.margins,e.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:e.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:e.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:e.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:e.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:e.DEFAULT_SETTINGS.maxZoomLevel,degrees:e.DEFAULT_SETTINGS.degrees,flipped:e.DEFAULT_SETTINGS.flipped,homeFillsViewer:e.DEFAULT_SETTINGS.homeFillsViewer},t),this._updateContainerInnerSize(),this.centerSpringX=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new e.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._setContentBounds(new e.Rect(0,0,1,1),1),this.goHome(!0),this.update()},e.Viewport.prototype={resetContentSize:function(t){return e.console.assert(t,"[Viewport.resetContentSize] contentSize is required"),e.console.assert(t instanceof e.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),e.console.assert(t.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),e.console.assert(t.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new e.Rect(0,0,1,t.y/t.x),t.x),this},setHomeBounds:function(t,i){e.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(t,i)},_setContentBounds:function(t,i){e.console.assert(t,"[Viewport._setContentBounds] bounds is required"),e.console.assert(t instanceof e.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),e.console.assert(t.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),e.console.assert(t.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=t.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(i),this._contentBounds=t.rotate(this.degrees).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(i),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:i,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var e,t=this._contentAspectRatio/this.getAspectRatio();return e=this.homeFillsViewer?t>=1?t:1:t>=1?1:t,e/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var t=this._contentBounds.getCenter(),i=1/this.getHomeZoom(),n=i/this.getAspectRatio();return new e.Rect(t.x-i/2,t.y-n/2,i,n)},goHome:function(e){return this.viewer&&this.viewer.raiseEvent("home",{immediately:e}),this.fitBounds(this.getHomeBounds(),e)},getMinZoom:function(){var e=this.getHomeZoom(),t=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*e;return t},getMaxZoom:function(){var e=this.maxZoomLevel;return e||(e=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,e/=this._contentBounds.width),Math.max(e,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new e.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return e.extend({},this._margins)},setMargins:function(t){e.console.assert("object"===e.type(t),"[Viewport.setMargins] margins must be an object"),this._margins=e.extend({left:0,top:0,right:0,bottom:0},t),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(-this.getRotation())},getBoundsNoRotate:function(t){var i=this.getCenter(t),n=1/this.getZoom(t),o=n/this.getAspectRatio();return new e.Rect(i.x-n/2,i.y-o/2,n,o)},getBoundsWithMargins:function(e){return this.getBoundsNoRotateWithMargins(e).rotate(-this.getRotation(),this.getCenter(e))},getBoundsNoRotateWithMargins:function(e){var t=this.getBoundsNoRotate(e),i=this._containerInnerSize.x*this.getZoom(e);return t.x-=this._margins.left/i,t.y-=this._margins.top/i,t.width+=(this._margins.left+this._margins.right)/i,t.height+=(this._margins.top+this._margins.bottom)/i,t},getCenter:function(t){var i,n,o,r,s,a,l,c,h=new e.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),u=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return t?h:this.zoomPoint?(i=this.pixelFromPoint(this.zoomPoint,!0),n=this.getZoom(),o=1/n,r=o/this.getAspectRatio(),s=new e.Rect(h.x-o/2,h.y-r/2,o,r),a=this._pixelFromPoint(this.zoomPoint,s),l=a.minus(i),c=l.divide(this._containerInnerSize.x*n),u.plus(c)):u},getZoom:function(e){return e?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(e){return Math.max(Math.min(e,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(t){var i=new e.Rect(t.x,t.y,t.width,t.height);if(this.wrapHorizontal);else{var n=this.visibilityRatio*i.width,o=i.x+i.width,r=this._contentBoundsNoRotate.x+this._contentBoundsNoRotate.width,s=this._contentBoundsNoRotate.x-o+n,a=r-i.x-n;n>this._contentBoundsNoRotate.width?i.x+=(s+a)/2:a<0?i.x+=a:s>0&&(i.x+=s)}if(this.wrapVertical);else{var l=this.visibilityRatio*i.height,c=i.y+i.height,h=this._contentBoundsNoRotate.y+this._contentBoundsNoRotate.height,u=this._contentBoundsNoRotate.y-c+l,d=h-i.y-l;l>this._contentBoundsNoRotate.height?i.y+=(u+d)/2:d<0?i.y+=d:u>0&&(i.y+=u)}return i},_raiseConstraintsEvent:function(e){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:e})},applyConstraints:function(e){var t=this.getZoom(),i=this._applyZoomConstraints(t);t!==i&&this.zoomTo(i,this.zoomPoint,e);var n=this.getBoundsNoRotate(),o=this._applyBoundaryConstraints(n);return this._raiseConstraintsEvent(e),(n.x!==o.x||n.y!==o.y||e)&&this.fitBounds(o.rotate(-this.getRotation()),e),this},ensureVisible:function(e){return this.applyConstraints(e)},_fitBounds:function(t,i){i=i||{};var n=i.immediately||!1,o=i.constraints||!1,r=this.getAspectRatio(),s=t.getCenter(),a=new e.Rect(t.x,t.y,t.width,t.height,t.degrees+this.getRotation()).getBoundingBox();a.getAspectRatio()>=r?a.height=a.width/r:a.width=a.height*r,a.x=s.x-a.width/2,a.y=s.y-a.height/2;var l=1/a.width;if(o){var c=a.getAspectRatio(),h=this._applyZoomConstraints(l);l!==h&&(l=h,a.width=1/l,a.x=s.x-a.width/2,a.height=a.width/c,a.y=s.y-a.height/2),a=this._applyBoundaryConstraints(a),s=a.getCenter(),this._raiseConstraintsEvent(n)}if(n)return this.panTo(s,!0),this.zoomTo(l,null,!0);this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0);var u=this.getBounds(),d=this.getZoom();if(0===d||Math.abs(l/d-1)<1e-8)return this.zoomTo(l,!0),this.panTo(s,n);a=a.rotate(-this.getRotation());var p=a.getTopLeft().times(l).minus(u.getTopLeft().times(d)).divide(l-d);return this.zoomTo(l,p,n)},fitBounds:function(e,t){return this._fitBounds(e,{immediately:t,constraints:!1})},fitBoundsWithConstraints:function(e,t){return this._fitBounds(e,{immediately:t,constraints:!0})},fitVertically:function(t){var i=new e.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(i,t)},fitHorizontally:function(t){var i=new e.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(i,t)},getConstrainedBounds:function(e){var t,i;return t=this.getBounds(e),i=this._applyBoundaryConstraints(t),i},panBy:function(t,i){var n=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(n.plus(t),i)},panTo:function(e,t){return t?(this.centerSpringX.resetTo(e.x),this.centerSpringY.resetTo(e.y)):(this.centerSpringX.springTo(e.x),this.centerSpringY.springTo(e.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:e,immediately:t}),this},zoomBy:function(e,t,i){return this.zoomTo(this.zoomSpring.target.value*e,t,i)},zoomTo:function(t,i,n){var o=this;return this.zoomPoint=i instanceof e.Point&&!isNaN(i.x)&&!isNaN(i.y)?i:null,n?this._adjustCenterSpringsForZoomPoint(function(){o.zoomSpring.resetTo(t)}):this.zoomSpring.springTo(t),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:t,refPoint:i,immediately:n}),this},setRotation:function(t){return this.viewer&&this.viewer.drawer.canRotate()?(this.degrees=e.positiveModulo(t,360),this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:t}),this):this},getRotation:function(){return this.degrees},resize:function(e,t){var i,n=this.getBoundsNoRotate(),o=n;return this.containerSize.x=e.x,this.containerSize.y=e.y,this._updateContainerInnerSize(),t&&(i=e.x/this.containerSize.x,o.width=n.width*i,o.height=o.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:e,maintain:t}),this.fitBounds(o,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new e.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var e=this;this._adjustCenterSpringsForZoomPoint(function(){e.zoomSpring.update()}),this.centerSpringX.update(),this.centerSpringY.update();var t=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,t},_adjustCenterSpringsForZoomPoint:function(e){if(this.zoomPoint){var t=this.pixelFromPoint(this.zoomPoint,!0);e();var i=this.pixelFromPoint(this.zoomPoint,!0),n=i.minus(t),o=this.deltaPointsFromPixels(n,!0);this.centerSpringX.shiftBy(o.x),this.centerSpringY.shiftBy(o.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else e()},deltaPixelsFromPointsNoRotate:function(e,t){return e.times(this._containerInnerSize.x*this.getZoom(t))},deltaPixelsFromPoints:function(e,t){return this.deltaPixelsFromPointsNoRotate(e.rotate(this.getRotation()),t)},deltaPointsFromPixelsNoRotate:function(e,t){return e.divide(this._containerInnerSize.x*this.getZoom(t))},deltaPointsFromPixels:function(e,t){return this.deltaPointsFromPixelsNoRotate(e,t).rotate(-this.getRotation())},pixelFromPointNoRotate:function(e,t){return this._pixelFromPointNoRotate(e,this.getBoundsNoRotate(t))},pixelFromPoint:function(e,t){return this._pixelFromPoint(e,this.getBoundsNoRotate(t))},_pixelFromPointNoRotate:function(t,i){return t.minus(i.getTopLeft()).times(this._containerInnerSize.x/i.width).plus(new e.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(e,t){return this._pixelFromPointNoRotate(e.rotate(this.getRotation(),this.getCenter(!0)),t)},pointFromPixelNoRotate:function(t,i){var n=this.getBoundsNoRotate(i);return t.minus(new e.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/n.width).plus(n.getTopLeft())},pointFromPixel:function(e,t){return this.pointFromPixelNoRotate(e,t).rotate(-this.getRotation(),this.getCenter(!0))},_viewportToImageDelta:function(t,i){var n=this._contentBoundsNoRotate.width;return new e.Point(t*this._contentSizeNoRotate.x/n,i*this._contentSizeNoRotate.x/n)},viewportToImageCoordinates:function(t,i){if(t instanceof e.Point)return this.viewportToImageCoordinates(t.x,t.y);if(this.viewer){var n=this.viewer.world.getItemCount();if(n>1)e.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(1===n){var o=this.viewer.world.getItemAt(0);return o.viewportToImageCoordinates(t,i,!0)}}return this._viewportToImageDelta(t-this._contentBoundsNoRotate.x,i-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(t,i){var n=this._contentBoundsNoRotate.width;return new e.Point(t/this._contentSizeNoRotate.x*n,i/this._contentSizeNoRotate.x*n)},imageToViewportCoordinates:function(t,i){if(t instanceof e.Point)return this.imageToViewportCoordinates(t.x,t.y);if(this.viewer){var n=this.viewer.world.getItemCount();if(n>1)e.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(1===n){var o=this.viewer.world.getItemAt(0);return o.imageToViewportCoordinates(t,i,!0)}}var r=this._imageToViewportDelta(t,i);return r.x+=this._contentBoundsNoRotate.x,r.y+=this._contentBoundsNoRotate.y,r},imageToViewportRectangle:function(t,i,n,o){var r=t;if(r instanceof e.Rect||(r=new e.Rect(t,i,n,o)),this.viewer){var s=this.viewer.world.getItemCount();if(s>1)e.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(1===s){var a=this.viewer.world.getItemAt(0);return a.imageToViewportRectangle(t,i,n,o,!0)}}var l=this.imageToViewportCoordinates(r.x,r.y),c=this._imageToViewportDelta(r.width,r.height);return new e.Rect(l.x,l.y,c.x,c.y,r.degrees)},viewportToImageRectangle:function(t,i,n,o){var r=t;if(r instanceof e.Rect||(r=new e.Rect(t,i,n,o)),this.viewer){var s=this.viewer.world.getItemCount();if(s>1)e.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(1===s){var a=this.viewer.world.getItemAt(0);return a.viewportToImageRectangle(t,i,n,o,!0)}}var l=this.viewportToImageCoordinates(r.x,r.y),c=this._viewportToImageDelta(r.width,r.height);return new e.Rect(l.x,l.y,c.x,c.y,r.degrees)},viewerElementToImageCoordinates:function(e){var t=this.pointFromPixel(e,!0);return this.viewportToImageCoordinates(t)},imageToViewerElementCoordinates:function(e){var t=this.imageToViewportCoordinates(e);return this.pixelFromPoint(t,!0)},windowToImageCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var i=t.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(i)},imageToWindowCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");var i=this.imageToViewerElementCoordinates(t);return i.plus(e.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(e){return this.pointFromPixel(e,!0)},viewportToViewerElementCoordinates:function(e){return this.pixelFromPoint(e,!0)},viewerElementToViewportRectangle:function(t){return e.Rect.fromSummits(this.pointFromPixel(t.getTopLeft(),!0),this.pointFromPixel(t.getTopRight(),!0),this.pointFromPixel(t.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(t){return e.Rect.fromSummits(this.pixelFromPoint(t.getTopLeft(),!0),this.pixelFromPoint(t.getTopRight(),!0),this.pixelFromPoint(t.getBottomLeft(),!0))},windowToViewportCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var i=t.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(i)},viewportToWindowCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");var i=this.viewportToViewerElementCoordinates(t);return i.plus(e.getElementPosition(this.viewer.element))},viewportToImageZoom:function(t){if(this.viewer){var i=this.viewer.world.getItemCount();if(i>1)e.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(1===i){var n=this.viewer.world.getItemAt(0);return n.viewportToImageZoom(t)}}var o=this._contentSizeNoRotate.x,r=this._containerInnerSize.x,s=this._contentBoundsNoRotate.width,a=r/o*s;return t*a},imageToViewportZoom:function(t){if(this.viewer){var i=this.viewer.world.getItemCount();if(i>1)e.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(1===i){var n=this.viewer.world.getItemAt(0);return n.imageToViewportZoom(t)}}var o=this._contentSizeNoRotate.x,r=this._containerInnerSize.x,s=this._contentBoundsNoRotate.width,a=o/r/s;return t*a},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(e){return this.flipped===e?this:(this.flipped=e,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:e}),this)}}}(OpenSeadragon),function(e){function t(e,t,n,o,r,s,a,l,c){var h=a.getBoundingBox().getTopLeft(),u=a.getBoundingBox().getBottomRight();e.viewer&&e.viewer.raiseEvent("update-level",{tiledImage:e,havedrawn:t,level:o,opacity:r,visibility:s,drawArea:a,topleft:h,bottomright:u,currenttime:l,best:c}),d(e.coverage,o),d(e.loadingCoverage,o);for(var p=e._getCornerTiles(o,h,u),m=p.topLeft,g=p.bottomRight,f=e.source.getNumTiles(o),v=e.viewport.pixelFromPoint(e.viewport.getCenter()),y=m.x;y<=g.x;y++)for(var w=m.y;w<=g.y;w++){if(!e.wrapHorizontal&&!e.wrapVertical){var T=e.source.getTileBounds(o,y,w);if(null===a.intersection(T))continue}c=i(e,n,t,y,w,o,r,s,v,f,l,c)}return c}function i(e,t,i,o,r,c,d,m,g,f,v,y){var w=n(o,r,c,e,e.source,e.tilesMatrix,v,f,e._worldWidthCurrent,e._worldHeightCurrent),T=i;e.viewer&&e.viewer.raiseEvent("update-tile",{tiledImage:e,tile:w}),u(e.coverage,c,o,r,!1);var x=w.loaded||w.loading||h(e.loadingCoverage,c,o,r);if(u(e.loadingCoverage,c,o,r,x),!w.exists)return y;if(t&&!T&&(h(e.coverage,c,o,r)?u(e.coverage,c,o,r,!0):T=!0),!T)return y;if(a(w,e.source.tileOverlap,e.viewport,g,m,e),!w.loaded)if(w.context2D)s(e,w);else{var S=e._tileCache.getImageRecord(w.cacheKey);if(S){var E=S.getImage();s(e,w,E)}}if(w.loaded){var _=l(e,w,o,r,c,d,v);_&&(e._needsDraw=!0)}else w.loading?e._tilesLoading++:x||(y=p(y,w));return y}function n(t,i,n,o,r,s,a,l,c,h){var u,d,p,m,g,f,v,y,w;return s[n]||(s[n]={}),s[n][t]||(s[n][t]={}),s[n][t][i]||(u=(l.x+t%l.x)%l.x,d=(l.y+i%l.y)%l.y,p=r.getTileBounds(n,u,d),m=r.getTileBounds(n,u,d,!0),g=r.tileExists(n,u,d),f=r.getTileUrl(n,u,d),o.loadTilesWithAjax?(v=r.getTileAjaxHeaders(n,u,d),e.isPlainObject(o.ajaxHeaders)&&(v=e.extend({},o.ajaxHeaders,v))):v=null,y=r.getContext2D?r.getContext2D(n,u,d):void 0,p.x+=(t-u)/l.x,p.y+=h/c*((i-d)/l.y),w=new e.Tile(n,t,i,p,g,f,y,o.loadTilesWithAjax,v,m),u===l.x-1&&(w.isRightMost=!0),d===l.y-1&&(w.isBottomMost=!0),s[n][t][i]=w),w=s[n][t][i],w.lastTouchTime=a,w}function o(e,t,i){t.loading=!0,e._imageLoader.addJob({src:t.url,loadWithAjax:t.loadWithAjax,ajaxHeaders:t.ajaxHeaders,crossOriginPolicy:e.crossOriginPolicy,ajaxWithCredentials:e.ajaxWithCredentials,callback:function(n,o,s){r(e,t,i,n,o,s)},abort:function(){t.loading=!1}})}function r(t,i,n,o,r,a){if(!o)return e.console.log("Tile %s failed to load: %s - error: %s",i,i.url,r),t.viewer.raiseEvent("tile-load-failed",{tile:i,tiledImage:t,time:n,message:r,tileRequest:a}),i.loading=!1,void(i.exists=!1);if(n<t.lastResetTime)return e.console.log("Ignoring tile %s loaded before reset: %s",i,i.url),void(i.loading=!1);var l=function(){var e=t.source.getClosestLevel();s(t,i,o,e,a)};t._midDraw?window.setTimeout(l,1):l()}function s(e,t,i,n,o){var r=0;function s(){return r++,a}function a(){r--,0===r&&(t.loading=!1,t.loaded=!0,t.context2D||e._tileCache.cacheTile({image:i,tile:t,cutoff:n,tiledImage:e}),e._needsDraw=!0)}e.viewer.raiseEvent("tile-loaded",{tile:t,tiledImage:e,tileRequest:o,image:i,getCompletionCallback:s}),s()()}function a(t,i,n,o,r,s){var a=t.bounds.getTopLeft();a.x*=s._scaleSpring.current.value,a.y*=s._scaleSpring.current.value,a.x+=s._xSpring.current.value,a.y+=s._ySpring.current.value;var l=t.bounds.getSize();l.x*=s._scaleSpring.current.value,l.y*=s._scaleSpring.current.value;var c=n.pixelFromPointNoRotate(a,!0),h=n.pixelFromPointNoRotate(a,!1),u=n.deltaPixelsFromPointsNoRotate(l,!0),d=n.deltaPixelsFromPointsNoRotate(l,!1),p=h.plus(d.divide(2)),m=o.squaredDistanceTo(p);i||(u=u.plus(new e.Point(1,1))),t.isRightMost&&s.wrapHorizontal&&(u.x+=.75),t.isBottomMost&&s.wrapVertical&&(u.y+=.75),t.position=c,t.size=u,t.squaredDistance=m,t.visibility=r}function l(e,t,i,n,o,r,s){var a,l,c=1e3*e.blendTime;if(t.blendStart||(t.blendStart=s),a=s-t.blendStart,l=c?Math.min(1,a/c):1,e.alwaysBlend&&(l*=r),t.opacity=l,e.lastDrawn.push(t),1==l)u(e.coverage,o,i,n,!0),e._hasOpaqueTile=!0;else if(a<c)return!0;return!1}function c(e,t,i,n){var o,r,s,a;if(!e[t])return!1;if(void 0===i||void 0===n){for(s in o=e[t],o)if(o.hasOwnProperty(s))for(a in r=o[s],r)if(r.hasOwnProperty(a)&&!r[a])return!1;return!0}return void 0===e[t][i]||void 0===e[t][i][n]||!0===e[t][i][n]}function h(e,t,i,n){return void 0===i||void 0===n?c(e,t+1):c(e,t+1,2*i,2*n)&&c(e,t+1,2*i,2*n+1)&&c(e,t+1,2*i+1,2*n)&&c(e,t+1,2*i+1,2*n+1)}function u(t,i,n,o,r){t[i]?(t[i][n]||(t[i][n]={}),t[i][n][o]=r):e.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",i)}function d(e,t){e[t]={}}function p(e,t){return e?t.visibility>e.visibility?t:t.visibility==e.visibility&&t.squaredDistance<e.squaredDistance?t:e:t}function m(t,i){if(0!==t.opacity&&(0!==i.length||t.placeholderFillStyle)){var n,o,r,s=i[0];s&&(n=t.opacity<1||t.compositeOperation&&"source-over"!==t.compositeOperation||!t._isBottomItem()&&s._hasTransparencyChannel());var a,l=t.viewport.getZoom(!0),c=t.viewportToImageZoom(l);i.length>1&&c>t.smoothTileEdgesMinZoom&&!t.iOSDevice&&t.getRotation(!0)%360===0&&e.supportsCanvas&&(n=!0,o=s.getScaleForEdgeSmoothing(),r=s.getTranslationForEdgeSmoothing(o,t._drawer.getCanvasSize(!1),t._drawer.getCanvasSize(!0))),n&&(o||(a=t.viewport.viewportToViewerElementRectangle(t.getClippedBounds(!0)).getIntegerBoundingBox().times(e.pixelDensityRatio)),t._drawer._clear(!0,a)),o||(0!==t.viewport.degrees?t._drawer._offsetForRotation({degrees:t.viewport.degrees,useSketch:n}):t._drawer.viewer.viewport.flipped&&t._drawer._flip({}),t.getRotation(!0)%360!==0&&t._drawer._offsetForRotation({degrees:t.getRotation(!0),point:t.viewport.pixelFromPointNoRotate(t._getRotationPoint(!0),!0),useSketch:n}));var h=!1;if(t._clip){t._drawer.saveContext(n);var u=t.imageToViewportRectangle(t._clip,!0);u=u.rotate(-t.getRotation(!0),t._getRotationPoint(!0));var d=t._drawer.viewportToDrawerRectangle(u);o&&(d=d.times(o)),r&&(d=d.translate(r)),t._drawer.setClip(d,n),h=!0}if(t.placeholderFillStyle&&!1===t._hasOpaqueTile){var p=t._drawer.viewportToDrawerRectangle(t.getBounds(!0));o&&(p=p.times(o)),r&&(p=p.translate(r));var m=null;m="function"===typeof t.placeholderFillStyle?t.placeholderFillStyle(t,t._drawer.context):t.placeholderFillStyle,t._drawer.drawRectangle(p,m,n)}for(var f=i.length-1;f>=0;f--)s=i[f],t._drawer.drawTile(s,t._drawingHandler,n,o,r),s.beingDrawn=!0,t.viewer&&t.viewer.raiseEvent("tile-drawn",{tiledImage:t,tile:s});h&&t._drawer.restoreContext(n),o||(t.getRotation(!0)%360!==0&&t._drawer._restoreRotationChanges(n),0!==t.viewport.degrees?t._drawer._restoreRotationChanges(n):t._drawer.viewer.viewport.flipped&&t._drawer._flip({})),n&&(o&&(0!==t.viewport.degrees&&t._drawer._offsetForRotation({degrees:t.viewport.degrees,useSketch:!1}),t.getRotation(!0)%360!==0&&t._drawer._offsetForRotation({degrees:t.getRotation(!0),point:t.viewport.pixelFromPointNoRotate(t._getRotationPoint(!0),!0),useSketch:!1})),t._drawer.blendSketch({opacity:t.opacity,scale:o,translate:r,compositeOperation:t.compositeOperation,bounds:a}),o&&(t.getRotation(!0)%360!==0&&t._drawer._restoreRotationChanges(!1),0!==t.viewport.degrees&&t._drawer._restoreRotationChanges(!1))),g(t,i)}}function g(t,i){if(t.debugMode)for(var n=i.length-1;n>=0;n--){var o=i[n];try{t._drawer.drawDebugInfo(o,i.length,n,t)}catch(r){e.console.error(r)}}}e.TiledImage=function(t){var i=this;e.console.assert(t.tileCache,"[TiledImage] options.tileCache is required"),e.console.assert(t.drawer,"[TiledImage] options.drawer is required"),e.console.assert(t.viewer,"[TiledImage] options.viewer is required"),e.console.assert(t.imageLoader,"[TiledImage] options.imageLoader is required"),e.console.assert(t.source,"[TiledImage] options.source is required"),e.console.assert(!t.clip||t.clip instanceof e.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),e.EventSource.call(this),this._tileCache=t.tileCache,delete t.tileCache,this._drawer=t.drawer,delete t.drawer,this._imageLoader=t.imageLoader,delete t.imageLoader,t.clip instanceof e.Rect&&(this._clip=t.clip.clone()),delete t.clip;var n=t.x||0;delete t.x;var o=t.y||0;delete t.y,this.normHeight=t.source.dimensions.y/t.source.dimensions.x,this.contentAspectX=t.source.dimensions.x/t.source.dimensions.y;var r=1;t.width?(r=t.width,delete t.width,t.height&&(e.console.error("specifying both width and height to a tiledImage is not supported"),delete t.height)):t.height&&(r=t.height/this.normHeight,delete t.height);var s=t.fitBounds;delete t.fitBounds;var a=t.fitBoundsPlacement||OpenSeadragon.Placement.CENTER;delete t.fitBoundsPlacement;var l=t.degrees||0;delete t.degrees,e.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,immediateRender:e.DEFAULT_SETTINGS.immediateRender,blendTime:e.DEFAULT_SETTINGS.blendTime,alwaysBlend:e.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:e.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:e.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:e.DEFAULT_SETTINGS.iOSDevice,debugMode:e.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:e.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:e.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:e.DEFAULT_SETTINGS.placeholderFillStyle,opacity:e.DEFAULT_SETTINGS.opacity,preload:e.DEFAULT_SETTINGS.preload,compositeOperation:e.DEFAULT_SETTINGS.compositeOperation},t),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new e.Spring({initial:n,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new e.Spring({initial:o,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new e.Spring({initial:r,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new e.Spring({initial:l,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),s&&this.fitBounds(s,a,!0),this._drawingHandler=function(t){i.viewer.raiseEvent("tile-drawing",e.extend({tiledImage:i},t))}},e.extend(e.TiledImage.prototype,e.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(e){e!==this._fullyLoaded&&(this._fullyLoaded=e,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=e.now(),this._needsDraw=!0},update:function(){var e=this._xSpring.update(),t=this._ySpring.update(),i=this._scaleSpring.update(),n=this._degreesSpring.update();return!!(e||t||i||n)&&(this._updateForScale(),this._needsDraw=!0,!0)},draw:function(){0!==this.opacity||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset()},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(this.getRotation(e),this._getRotationPoint(e))},getBoundsNoRotate:function(t){return t?new e.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new e.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return e.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(t){var i=this.getBoundsNoRotate(t);if(this._clip){var n=t?this._worldWidthCurrent:this._worldWidthTarget,o=n/this.source.dimensions.x,r=this._clip.times(o);i=new e.Rect(i.x+r.x,i.y+r.y,r.width,r.height)}return i.rotate(this.getRotation(t),this._getRotationPoint(t))},getContentSize:function(){return new e.Point(this.source.dimensions.x,this.source.dimensions.y)},_viewportToImageDelta:function(t,i,n){var o=n?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(t*(this.source.dimensions.x/o),i*(this.source.dimensions.y*this.contentAspectX/o))},viewportToImageCoordinates:function(t,i,n){var o;return t instanceof e.Point?(n=i,o=t):o=new e.Point(t,i),o=o.rotate(-this.getRotation(n),this._getRotationPoint(n)),n?this._viewportToImageDelta(o.x-this._xSpring.current.value,o.y-this._ySpring.current.value):this._viewportToImageDelta(o.x-this._xSpring.target.value,o.y-this._ySpring.target.value)},_imageToViewportDelta:function(t,i,n){var o=n?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(t/this.source.dimensions.x*o,i/this.source.dimensions.y/this.contentAspectX*o)},imageToViewportCoordinates:function(t,i,n){t instanceof e.Point&&(n=i,i=t.y,t=t.x);var o=this._imageToViewportDelta(t,i);return n?(o.x+=this._xSpring.current.value,o.y+=this._ySpring.current.value):(o.x+=this._xSpring.target.value,o.y+=this._ySpring.target.value),o.rotate(this.getRotation(n),this._getRotationPoint(n))},imageToViewportRectangle:function(t,i,n,o,r){var s=t;s instanceof e.Rect?r=i:s=new e.Rect(t,i,n,o);var a=this.imageToViewportCoordinates(s.getTopLeft(),r),l=this._imageToViewportDelta(s.width,s.height,r);return new e.Rect(a.x,a.y,l.x,l.y,s.degrees+this.getRotation(r))},viewportToImageRectangle:function(t,i,n,o,r){var s=t;t instanceof e.Rect?r=i:s=new e.Rect(t,i,n,o);var a=this.viewportToImageCoordinates(s.getTopLeft(),r),l=this._viewportToImageDelta(s.width,s.height,r);return new e.Rect(a.x,a.y,l.x,l.y,s.degrees-this.getRotation(r))},viewerElementToImageCoordinates:function(e){var t=this.viewport.pointFromPixel(e,!0);return this.viewportToImageCoordinates(t)},imageToViewerElementCoordinates:function(e){var t=this.imageToViewportCoordinates(e);return this.viewport.pixelFromPoint(t,!0)},windowToImageCoordinates:function(e){var t=e.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(t)},imageToWindowCoordinates:function(e){var t=this.imageToViewerElementCoordinates(e);return t.plus(OpenSeadragon.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(t){var i=this._scaleSpring.current.value;return t=t.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new e.Rect((t.x-this._xSpring.current.value)/i,(t.y-this._ySpring.current.value)/i,t.width/i,t.height/i,t.degrees)},viewportToImageZoom:function(e){var t=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return t*e},imageToViewportZoom:function(e){var t=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return e/t},setPosition:function(e,t){var i=this._xSpring.target.value===e.x&&this._ySpring.target.value===e.y;if(t){if(i&&this._xSpring.current.value===e.x&&this._ySpring.current.value===e.y)return;this._xSpring.resetTo(e.x),this._ySpring.resetTo(e.y),this._needsDraw=!0}else{if(i)return;this._xSpring.springTo(e.x),this._ySpring.springTo(e.y),this._needsDraw=!0}i||this._raiseBoundsChange()},setWidth:function(e,t){this._setScale(e,t)},setHeight:function(e,t){this._setScale(e/this.normHeight,t)},fitBounds:function(t,i,n){i=i||e.Placement.CENTER;var o=e.Placement.properties[i],r=this.contentAspectX,s=0,a=0,l=1,c=1;if(this._clip&&(r=this._clip.getAspectRatio(),l=this._clip.width/this.source.dimensions.x,c=this._clip.height/this.source.dimensions.y,t.getAspectRatio()>r?(s=this._clip.x/this._clip.height*t.height,a=this._clip.y/this._clip.height*t.height):(s=this._clip.x/this._clip.width*t.width,a=this._clip.y/this._clip.width*t.width)),t.getAspectRatio()>r){var h=t.height/c,u=0;o.isHorizontallyCentered?u=(t.width-t.height*r)/2:o.isRight&&(u=t.width-t.height*r),this.setPosition(new e.Point(t.x-s+u,t.y-a),n),this.setHeight(h,n)}else{var d=t.width/l,p=0;o.isVerticallyCentered?p=(t.height-t.width/r)/2:o.isBottom&&(p=t.height-t.width/r),this.setPosition(new e.Point(t.x-s,t.y-a+p),n),this.setWidth(d,n)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(t){e.console.assert(!t||t instanceof e.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),t instanceof e.Rect?this._clip=t.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getOpacity:function(){return this.opacity},setOpacity:function(e){e!==this.opacity&&(this.opacity=e,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(e){this._preload=!!e,this._needsDraw=!0},getRotation:function(e){return e?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(e,t){this._degreesSpring.target.value===e&&this._degreesSpring.isAtTargetValue()||(t?this._degreesSpring.resetTo(e):this._degreesSpring.springTo(e),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(e){return this.getBoundsNoRotate(e).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(e){e!==this.compositeOperation&&(this.compositeOperation=e,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(e,t){var i=this._scaleSpring.target.value===e;if(t){if(i&&this._scaleSpring.current.value===e)return;this._scaleSpring.resetTo(e),this._updateForScale(),this._needsDraw=!0}else{if(i)return;this._scaleSpring.springTo(e),this._updateForScale(),this._needsDraw=!0}i||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var e=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),t=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,i=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(t/this.minPixelRatio)/Math.log(2))));return i=Math.max(i,this.source.minLevel||0),e=Math.min(e,i),{lowestLevel:e,highestLevel:i}},_updateViewport:function(){this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};while(this.lastDrawn.length>0){var i=this.lastDrawn.pop();i.beingDrawn=!1}var n=this.viewport,r=this._viewportToTiledImageRectangle(n.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var s=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(r=r.intersection(s),null===r)return}for(var a=this._getLevelsInterval(),l=a.lowestLevel,h=a.highestLevel,u=null,d=!1,p=e.now(),g=h;g>=l;g--){var f=!1,v=n.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(g),!0).x*this._scaleSpring.current.value;if(g===l||!d&&v>=this.minPixelRatio)f=!0,d=!0;else if(!d)continue;var y=n.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(g),!1).x*this._scaleSpring.current.value,w=n.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,T=this.immediateRender?1:w,x=Math.min(1,(v-.5)/.5),S=T/Math.abs(T-y);if(u=t(this,d,f,g,x,S,r,p,u),c(this.coverage,g))break}m(this,this.lastDrawn),u&&!u.context2D?(o(this,u,p),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(0===this._tilesLoading)},_getCornerTiles:function(t,i,n){var o,r,s,a;this.wrapHorizontal?(o=e.positiveModulo(i.x,1),r=e.positiveModulo(n.x,1)):(o=Math.max(0,i.x),r=Math.min(1,n.x));var l=1/this.source.aspectRatio;this.wrapVertical?(s=e.positiveModulo(i.y,l),a=e.positiveModulo(n.y,l)):(s=Math.max(0,i.y),a=Math.min(l,n.y));var c=this.source.getTileAtPoint(t,new e.Point(o,s)),h=this.source.getTileAtPoint(t,new e.Point(r,a)),u=this.source.getNumTiles(t);return this.wrapHorizontal&&(c.x+=u.x*Math.floor(i.x),h.x+=u.x*Math.floor(n.x)),this.wrapVertical&&(c.y+=u.y*Math.floor(i.y/l),h.y+=u.y*Math.floor(n.y/l)),{topLeft:c,bottomRight:h}}})}(OpenSeadragon),function(e){var t=function(t){e.console.assert(t,"[TileCache.cacheTile] options is required"),e.console.assert(t.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(t.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=t.tile,this.tiledImage=t.tiledImage},i=function(t){e.console.assert(t,"[ImageRecord] options is required"),e.console.assert(t.image,"[ImageRecord] options.image is required"),this._image=t.image,this._tiles=[]};i.prototype={destroy:function(){this._image=null,this._renderedContext=null,this._tiles=null},getImage:function(){return this._image},getRenderedContext:function(){if(!this._renderedContext){var e=document.createElement("canvas");e.width=this._image.width,e.height=this._image.height,this._renderedContext=e.getContext("2d"),this._renderedContext.drawImage(this._image,0,0),this._image=null}return this._renderedContext},setRenderedContext:function(t){e.console.error("ImageRecord.setRenderedContext is deprecated. The rendered context should be created by the ImageRecord itself when calling ImageRecord.getRenderedContext."),this._renderedContext=t},addTile:function(t){e.console.assert(t,"[ImageRecord.addTile] tile is required"),this._tiles.push(t)},removeTile:function(t){for(var i=0;i<this._tiles.length;i++)if(this._tiles[i]===t)return void this._tiles.splice(i,1);e.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",t)},getTileCount:function(){return this._tiles.length}},e.TileCache=function(t){t=t||{},this._maxImageCacheCount=t.maxImageCacheCount||e.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},e.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(n){e.console.assert(n,"[TileCache.cacheTile] options is required"),e.console.assert(n.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(n.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),e.console.assert(n.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var o=n.cutoff||0,r=this._tilesLoaded.length,s=this._imagesLoaded[n.tile.cacheKey];if(s||(e.console.assert(n.image,"[TileCache.cacheTile] options.image is required to create an ImageRecord"),s=this._imagesLoaded[n.tile.cacheKey]=new i({image:n.image}),this._imagesLoadedCount++),s.addTile(n.tile),n.tile.cacheImageRecord=s,this._imagesLoadedCount>this._maxImageCacheCount){for(var a,l,c,h,u,d,p=null,m=-1,g=null,f=this._tilesLoaded.length-1;f>=0;f--)d=this._tilesLoaded[f],a=d.tile,a.level<=o||a.beingDrawn||(p?(h=a.lastTouchTime,l=p.lastTouchTime,u=a.level,c=p.level,(h<l||h==l&&u>c)&&(p=a,m=f,g=d)):(p=a,m=f,g=d));p&&m>=0&&(this._unloadTile(g),r=m)}this._tilesLoaded[r]=new t({tile:n.tile,tiledImage:n.tiledImage})},clearTilesFor:function(t){var i;e.console.assert(t,"[TileCache.clearTilesFor] tiledImage is required");for(var n=0;n<this._tilesLoaded.length;++n)i=this._tilesLoaded[n],i.tiledImage===t&&(this._unloadTile(i),this._tilesLoaded.splice(n,1),n--)},getImageRecord:function(t){return e.console.assert(t,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[t]},_unloadTile:function(t){e.console.assert(t,"[TileCache._unloadTile] tileRecord is required");var i=t.tile,n=t.tiledImage;i.unload(),i.cacheImageRecord=null;var o=this._imagesLoaded[i.cacheKey];o.removeTile(i),o.getTileCount()||(o.destroy(),delete this._imagesLoaded[i.cacheKey],this._imagesLoadedCount--),n.viewer.raiseEvent("tile-unloaded",{tile:i,tiledImage:n})}}}(OpenSeadragon),function(e){e.World=function(t){var i=this;e.console.assert(t.viewer,"[World] options.viewer is required"),e.EventSource.call(this),this.viewer=t.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(e){i._autoRefigureSizes?i._figureSizes():i._needsSizesFigured=!0},this._figureSizes()},e.extend(e.World.prototype,e.EventSource.prototype,{addItem:function(t,i){if(e.console.assert(t,"[World.addItem] item is required"),e.console.assert(t instanceof e.TiledImage,"[World.addItem] only TiledImages supported at this time"),i=i||{},void 0!==i.index){var n=Math.max(0,Math.min(this._items.length,i.index));this._items.splice(n,0,t)}else this._items.push(t);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,t.addHandler("bounds-change",this._delegatedFigureSizes),t.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:t})},getItemAt:function(t){return e.console.assert(void 0!==t,"[World.getItemAt] index is required"),this._items[t]},getIndexOfItem:function(t){return e.console.assert(t,"[World.getIndexOfItem] item is required"),e.indexOf(this._items,t)},getItemCount:function(){return this._items.length},setItemIndex:function(t,i){e.console.assert(t,"[World.setItemIndex] item is required"),e.console.assert(void 0!==i,"[World.setItemIndex] index is required");var n=this.getIndexOfItem(t);if(i>=this._items.length)throw new Error("Index bigger than number of layers.");i!==n&&-1!==n&&(this._items.splice(n,1),this._items.splice(i,0,t),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:t,previousIndex:n,newIndex:i}))},removeItem:function(t){e.console.assert(t,"[World.removeItem] item is required");var i=e.indexOf(this._items,t);-1!==i&&(t.removeHandler("bounds-change",this._delegatedFigureSizes),t.removeHandler("clip-change",this._delegatedFigureSizes),t.destroy(),this._items.splice(i,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(t))},removeAll:function(){var e,t;for(this.viewer._cancelPendingImages(),t=0;t<this._items.length;t++)e=this._items[t],e.removeHandler("bounds-change",this._delegatedFigureSizes),e.removeHandler("clip-change",this._delegatedFigureSizes),e.destroy();var i=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,t=0;t<i.length;t++)e=i[t],this._raiseRemoveItem(e)},resetItems:function(){for(var e=0;e<this._items.length;e++)this._items[e].reset()},update:function(){for(var e=!1,t=0;t<this._items.length;t++)e=this._items[t].update()||e;return e},draw:function(){for(var e=0;e<this._items.length;e++)this._items[e].draw();this._needsDraw=!1},needsDraw:function(){for(var e=0;e<this._items.length;e++)if(this._items[e].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(e){this._autoRefigureSizes=e,e&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(t){t=t||{};var i,n=t.immediately||!1,o=t.layout||e.DEFAULT_SETTINGS.collectionLayout,r=t.rows||e.DEFAULT_SETTINGS.collectionRows,s=t.columns||e.DEFAULT_SETTINGS.collectionColumns,a=t.tileSize||e.DEFAULT_SETTINGS.collectionTileSize,l=t.tileMargin||e.DEFAULT_SETTINGS.collectionTileMargin,c=a+l;i=!t.rows&&s?s:Math.ceil(this._items.length/r);var h,u,d,p,m,g=0,f=0;this.setAutoRefigureSizes(!1);for(var v=0;v<this._items.length;v++)v&&v%i===0&&("horizontal"===o?(f+=c,g=0):(g+=c,f=0)),h=this._items[v],u=h.getBounds(),d=u.width>u.height?a:a*(u.width/u.height),p=d*(u.height/u.width),m=new e.Point(g+(a-d)/2,f+(a-p)/2),h.setPosition(m,n),h.setWidth(d,n),"horizontal"===o?g+=c:f+=c;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var t=this._homeBounds?this._homeBounds.clone():null,i=this._contentSize?this._contentSize.clone():null,n=this._contentFactor||0;if(this._items.length){var o=this._items[0],r=o.getBounds();this._contentFactor=o.getContentSize().x/r.width;for(var s=o.getClippedBounds().getBoundingBox(),a=s.x,l=s.y,c=s.x+s.width,h=s.y+s.height,u=1;u<this._items.length;u++)o=this._items[u],r=o.getBounds(),this._contentFactor=Math.max(this._contentFactor,o.getContentSize().x/r.width),s=o.getClippedBounds().getBoundingBox(),a=Math.min(a,s.x),l=Math.min(l,s.y),c=Math.max(c,s.x+s.width),h=Math.max(h,s.y+s.height);this._homeBounds=new e.Rect(a,l,c-a,h-l),this._contentSize=new e.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}else this._homeBounds=new e.Rect(0,0,1,1),this._contentSize=new e.Point(1,1),this._contentFactor=1;this._contentFactor===n&&this._homeBounds.equals(t)&&this._contentSize.equals(i)||this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(e){this.raiseEvent("remove-item",{item:e})}})}(OpenSeadragon)},b50d:function(e,t,i){"use strict";var n=i("c532"),o=i("467f"),r=i("30b5"),s=i("c345"),a=i("3934"),l=i("2d83"),c="undefined"!==typeof window&&window.btoa&&window.btoa.bind(window)||i("9fa6");e.exports=function(e){return new Promise(function(t,h){var u=e.data,d=e.headers;n.isFormData(u)&&delete d["Content-Type"];var p=new XMLHttpRequest,m="onreadystatechange",g=!1;if("undefined"===typeof window||!window.XDomainRequest||"withCredentials"in p||a(e.url)||(p=new window.XDomainRequest,m="onload",g=!0,p.onprogress=function(){},p.ontimeout=function(){}),e.auth){var f=e.auth.username||"",v=e.auth.password||"";d.Authorization="Basic "+c(f+":"+v)}if(p.open(e.method.toUpperCase(),r(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p[m]=function(){if(p&&(4===p.readyState||g)&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var i="getAllResponseHeaders"in p?s(p.getAllResponseHeaders()):null,n=e.responseType&&"text"!==e.responseType?p.response:p.responseText,r={data:n,status:1223===p.status?204:p.status,statusText:1223===p.status?"No Content":p.statusText,headers:i,config:e,request:p};o(t,h,r),p=null}},p.onerror=function(){h(l("Network Error",e,null,p)),p=null},p.ontimeout=function(){h(l("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},n.isStandardBrowserEnv()){var y=i("7aac"),w=(e.withCredentials||a(e.url))&&e.xsrfCookieName?y.read(e.xsrfCookieName):void 0;w&&(d[e.xsrfHeaderName]=w)}if("setRequestHeader"in p&&n.forEach(d,function(e,t){"undefined"===typeof u&&"content-type"===t.toLowerCase()?delete d[t]:p.setRequestHeader(t,e)}),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(T){if("json"!==e.responseType)throw T}"function"===typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"===typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){p&&(p.abort(),h(e),p=null)}),void 0===u&&(u=null),p.send(u)})}},bc3a:function(e,t,i){e.exports=i("cee4")},c345:function(e,t,i){"use strict";var n=i("c532"),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,i,r,s={};return e?(n.forEach(e.split("\n"),function(e){if(r=e.indexOf(":"),t=n.trim(e.substr(0,r)).toLowerCase(),i=n.trim(e.substr(r+1)),t){if(s[t]&&o.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([i]):s[t]?s[t]+", "+i:i}}),s):s}},c401:function(e,t,i){"use strict";var n=i("c532");e.exports=function(e,t,i){return n.forEach(i,function(i){e=i(e,t)}),e}},c532:function(e,t,i){"use strict";var n=i("1d2b"),o=i("044b"),r=Object.prototype.toString;function s(e){return"[object Array]"===r.call(e)}function a(e){return"[object ArrayBuffer]"===r.call(e)}function l(e){return"undefined"!==typeof FormData&&e instanceof FormData}function c(e){var t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer,t}function h(e){return"string"===typeof e}function u(e){return"number"===typeof e}function d(e){return"undefined"===typeof e}function p(e){return null!==e&&"object"===typeof e}function m(e){return"[object Date]"===r.call(e)}function g(e){return"[object File]"===r.call(e)}function f(e){return"[object Blob]"===r.call(e)}function v(e){return"[object Function]"===r.call(e)}function y(e){return p(e)&&v(e.pipe)}function w(e){return"undefined"!==typeof URLSearchParams&&e instanceof URLSearchParams}function T(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function x(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)}function S(e,t){if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),s(e))for(var i=0,n=e.length;i<n;i++)t.call(null,e[i],i,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}function E(){var e={};function t(t,i){"object"===typeof e[i]&&"object"===typeof t?e[i]=E(e[i],t):e[i]=t}for(var i=0,n=arguments.length;i<n;i++)S(arguments[i],t);return e}function _(e,t,i){return S(t,function(t,o){e[o]=i&&"function"===typeof t?n(t,i):t}),e}e.exports={isArray:s,isArrayBuffer:a,isBuffer:o,isFormData:l,isArrayBufferView:c,isString:h,isNumber:u,isObject:p,isUndefined:d,isDate:m,isFile:g,isBlob:f,isFunction:v,isStream:y,isURLSearchParams:w,isStandardBrowserEnv:x,forEach:S,merge:E,extend:_,trim:T}},c8af:function(e,t,i){"use strict";var n=i("c532");e.exports=function(e,t){n.forEach(e,function(i,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=i,delete e[n])})}},ce1e:function(e,t,i){t=e.exports=i("2350")(!1),t.push([e.i,"\n#annoimage,#fullimage{width:49%\n}\n.togglebutton{margin:0 auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;background-color:red;margin-top:.5em;margin-bottom:.5em;border:none;color:#fff;padding:6px 7px;text-decoration:none;font-size:12px;border-radius:12px;cursor:pointer\n}\n.iiifannotation{text-indent:0;margin:.5em;padding:.5em;text-align:center\n}\n.toggle{width:49%\n}\n.text{border:3px solid green;padding:10px;margin:10px\n}\n#link_to_object,figcaption{font-weight:700\n}\nfigcaption{font-size:smaller;font-style:italic\n}",""])},cee4:function(e,t,i){"use strict";var n=i("c532"),o=i("1d2b"),r=i("0a06"),s=i("2444");function a(e){var t=new r(e),i=o(r.prototype.request,t);return n.extend(i,r.prototype,t),n.extend(i,t),i}var l=a(s);l.Axios=r,l.create=function(e){return a(n.merge(s,e))},l.Cancel=i("7a77"),l.CancelToken=i("8df4"),l.isCancel=i("2e67"),l.all=function(e){return Promise.all(e)},l.spread=i("0df6"),e.exports=l,e.exports.default=l},d3a9:function(e,t,i){t=e.exports=i("2350")(!1),t.push([e.i,'\n.tag{background:#92d1e8;border-radius:3px 0 0 3px;color:#000;display:inline-block;height:26px;line-height:26px;padding:0 20px 0 23px;position:relative;margin:0 10px 10px 0;text-decoration:none;-webkit-transition:color .2s\n}\n.tag:before{background:#fff;border-radius:10px;-webkit-box-shadow:inset 0 1px rgba(0,0,0,.25);box-shadow:inset 0 1px rgba(0,0,0,.25);content:"";height:6px;left:10px;position:absolute;width:6px;top:10px\n}\n.tag:after{background:#fff;border-bottom:13px solid transparent;border-left:10px solid #92d1e8;border-top:13px solid transparent;content:"";position:absolute;right:0;top:0\n}\n.inactive{color:red;pointer-events:none\n}\n.nextButton{font-size:22px\n}\n#storyboard_viewer{padding-top:50px\n}\n.seadragonbox{width:60%;display:inline-block;height:600px\n}\n#annotation.active{width:10%;border:2px solid #000;background:#fff;position:absolute;top:60px;display:inline-block;height:250px;overflow:scroll;padding:2px\n}\n#annotation_text img{width:100%;height:100%;-o-object-fit:scale-down;object-fit:scale-down\n}\n#annotation.inactive{display:none\n}\n.fullscreen{display:block;padding-left:20px;width:87%\n}\n.window{display:none\n}\n.box{border:2px solid #add8e6\n}\n.box:hover{background:grey;opacity:.4\n}\n.close{display:none\n}\n.close_button{float:left;padding-top:5px;padding-left:5px\n}',""])},d925:function(e,t,i){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},df7c:function(e,t,i){(function(e){function i(e,t){for(var i=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),i++):i&&(e.splice(n,1),i--)}if(t)for(;i--;i)e.unshift("..");return e}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(e){return n.exec(e).slice(1)};function r(e,t){if(e.filter)return e.filter(t);for(var i=[],n=0;n<e.length;n++)t(e[n],n,e)&&i.push(e[n]);return i}t.resolve=function(){for(var t="",n=!1,o=arguments.length-1;o>=-1&&!n;o--){var s=o>=0?arguments[o]:e.cwd();if("string"!==typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(t=s+"/"+t,n="/"===s.charAt(0))}return t=i(r(t.split("/"),function(e){return!!e}),!n).join("/"),(n?"/":"")+t||"."},t.normalize=function(e){var n=t.isAbsolute(e),o="/"===s(e,-1);return e=i(r(e.split("/"),function(e){return!!e}),!n).join("/"),e||n||(e="."),e&&o&&(e+="/"),(n?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(r(e,function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,i){function n(e){for(var t=0;t<e.length;t++)if(""!==e[t])break;for(var i=e.length-1;i>=0;i--)if(""!==e[i])break;return t>i?[]:e.slice(t,i-t+1)}e=t.resolve(e).substr(1),i=t.resolve(i).substr(1);for(var o=n(e.split("/")),r=n(i.split("/")),s=Math.min(o.length,r.length),a=s,l=0;l<s;l++)if(o[l]!==r[l]){a=l;break}var c=[];for(l=a;l<o.length;l++)c.push("..");return c=c.concat(r.slice(a)),c.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=o(e),i=t[0],n=t[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},t.basename=function(e,t){var i=o(e)[2];return t&&i.substr(-1*t.length)===t&&(i=i.substr(0,i.length-t.length)),i},t.extname=function(e){return o(e)[3]};var s="b"==="ab".substr(-1)?function(e,t,i){return e.substr(t,i)}:function(e,t,i){return t<0&&(t=e.length+t),e.substr(t,i)}}).call(this,i("4362"))},e683:function(e,t,i){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},f6b4:function(e,t,i){"use strict";var n=i("c532");function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){n.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=o}});
//# sourceMappingURL=iiif-annotation.min.js.map